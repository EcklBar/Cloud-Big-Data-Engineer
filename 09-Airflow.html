<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apache Airflow - ×”××“×¨×™×š ×”××§×™×£</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Heebo:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --airflow-primary: #017CEE;
            --airflow-secondary: #00C7D4;
            --airflow-dark: #0D3D56;
            --airflow-light: #4DA3FF;
            --airflow-green: #11D58C;
            --airflow-orange: #FF6D4C;
            --airflow-purple: #8B5CF6;

            --bg-body: #f8f9fa;
            --bg-surface: #ffffff;
            --text-primary: #212529;
            --text-secondary: #495057;
            --text-tertiary: #868e96;
            --border-color: #dee2e6;

            --code-bg: #1e1e2e;
            --code-text: #cdd6f4;

            --radius-lg: 16px;
            --radius-md: 10px;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 30px rgba(0,0,0,0.12);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Heebo', 'Inter', sans-serif;
            background: var(--bg-body);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* === HEADER === */
        .header {
            background: linear-gradient(135deg, var(--airflow-primary), var(--airflow-secondary));
            padding: 0 40px;
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow-lg);
            position: relative;
            z-index: 100;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .airflow-logo {
            width: 55px;
            height: 55px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 4px 15px rgba(255,255,255,0.3);
            font-weight: 900;
            color: var(--airflow-primary);
        }

        .header-logo {
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 2px;
            color: rgba(255,255,255,0.9);
            margin-bottom: 5px;
        }

        .brand-text h1 {
            font-size: 1.6rem;
            margin: 0;
            font-weight: 800;
            color: white;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .brand-text p {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.8);
            margin: 0;
        }

        /* === TABS === */
        .nav-tabs {
            display: flex;
            gap: 8px;
            background: rgba(255,255,255,0.1);
            padding: 6px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .nav-item {
            padding: 12px 28px;
            font-size: 0.95rem;
            font-weight: 600;
            color: rgba(255,255,255,0.7);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.15);
            color: white;
        }

        .nav-item.active {
            background: white;
            color: var(--airflow-primary);
            box-shadow: 0 4px 15px rgba(255,255,255,0.3);
        }

        /* === MAIN LAYOUT === */
        .main-wrapper {
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .view-section {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            overflow-y: auto;
            display: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .view-section.active {
            display: block;
            opacity: 1;
        }

        /* === THEORY LAYOUT === */
        .theory-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            height: 100%;
            max-width: 1600px;
            margin: 0 auto;
        }

        .theory-sidebar {
            background: white;
            border-left: 1px solid var(--border-color);
            padding: 25px 0;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 8px;
        }

        .sidebar-header {
            padding: 12px 25px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--text-tertiary);
            letter-spacing: 1px;
        }

        .theory-nav-item {
            padding: 14px 25px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.92rem;
            font-weight: 500;
            border-right: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .theory-nav-item:hover {
            background: #f8f9fa;
            color: var(--text-primary);
        }

        .theory-nav-item.active {
            background: linear-gradient(to left, #e7f5ff, white);
            color: var(--airflow-primary);
            border-right-color: var(--airflow-primary);
            font-weight: 600;
        }

        .theory-content {
            padding: 50px 60px;
            overflow-y: auto;
            background: var(--bg-body);
        }

        .theory-section {
            display: none;
            animation: fadeIn 0.4s;
            max-width: 1100px;
        }

        .theory-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .theory-section h1 {
            font-size: 2.5rem;
            margin-bottom: 30px;
            color: var(--text-primary);
            font-weight: 800;
            line-height: 1.2;
        }

        .theory-section h2 {
            font-size: 1.8rem;
            margin: 40px 0 25px 0;
            color: var(--airflow-primary);
            font-weight: 700;
        }

        .theory-section h3 {
            font-size: 1.3rem;
            margin: 30px 0 18px 0;
            color: var(--airflow-secondary);
            font-weight: 600;
        }

        .theory-section p, .theory-section li {
            line-height: 1.9;
            color: var(--text-secondary);
            margin-bottom: 16px;
            font-size: 1.05rem;
        }

        .theory-section ul, .theory-section ol {
            padding-right: 30px;
            margin-bottom: 25px;
        }

        .theory-section li {
            margin-bottom: 12px;
        }

        /* === CARDS === */
        .info-card {
            background: linear-gradient(135deg, #e7f5ff, #d0ebff);
            border: 2px solid var(--airflow-primary);
            border-radius: var(--radius-lg);
            padding: 30px;
            margin: 30px 0;
            box-shadow: var(--shadow-sm);
        }

        .info-card h3, .info-card h4 {
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--airflow-dark);
        }

        .concept-card {
            background: white;
            border-right: 5px solid var(--airflow-secondary);
            border-radius: var(--radius-md);
            padding: 25px 30px;
            margin: 25px 0;
            box-shadow: var(--shadow-sm);
        }

        .concept-card h4 {
            margin: 0 0 12px 0;
            color: var(--airflow-primary);
            font-size: 1.15rem;
        }

        .warning-card {
            background: linear-gradient(135deg, #fff9db, #fff3bf);
            border: 2px solid var(--airflow-orange);
            border-radius: var(--radius-md);
            padding: 25px;
            margin: 25px 0;
        }

        .success-card {
            background: linear-gradient(135deg, #d3f9d8, #b2f2bb);
            border: 2px solid var(--airflow-green);
            border-radius: var(--radius-md);
            padding: 25px;
            margin: 25px 0;
        }

        /* === STEP CARD === */
        .step-card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 25px 30px;
            margin: 25px 0;
            box-shadow: var(--shadow-sm);
        }

        .step-card h3 {
            color: var(--airflow-primary);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .step-number {
            display: inline-block;
            background: var(--airflow-primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-left: 10px;
            font-weight: 700;
        }

        /* === COMPARISON GRID === */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .comparison-card {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 28px;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
        }

        .comparison-card:hover {
            border-color: var(--airflow-primary);
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }

        .comparison-card h4 {
            margin: 0 0 18px 0;
            color: var(--airflow-dark);
            font-size: 1.2rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comparison-card ul {
            margin: 0;
            padding-right: 20px;
        }

        .comparison-card li {
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        /* === ARCHITECTURE DIAGRAM === */
        .architecture-diagram {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 40px;
            margin: 35px 0;
            box-shadow: var(--shadow-md);
            text-align: center;
        }

        .diagram-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .diagram-box {
            background: linear-gradient(135deg, #f8f9fa, white);
            border: 3px solid var(--airflow-primary);
            border-radius: 12px;
            padding: 25px 35px;
            min-width: 150px;
            font-weight: 700;
            font-size: 1.1rem;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s;
        }

        .diagram-box:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .diagram-box.scheduler {
            border-color: var(--airflow-green);
            background: linear-gradient(135deg, #d3f9d8, white);
        }

        .diagram-box.executor {
            border-color: var(--airflow-secondary);
            background: linear-gradient(135deg, #d0ebff, white);
        }

        .diagram-box.worker {
            border-color: var(--airflow-orange);
            background: linear-gradient(135deg, #ffe8db, white);
        }

        .diagram-arrow {
            font-size: 2.5rem;
            color: var(--text-tertiary);
        }

        /* === CODE BLOCKS === */
        .code-block {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 25px 30px;
            border-radius: var(--radius-md);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.88rem;
            line-height: 1.8;
            margin: 25px 0;
            direction: ltr;
            text-align: left;
            overflow-x: auto;
            overflow-y: hidden;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            white-space: pre;
            max-width: 100%;
            position: relative;
        }

        .code-block::before {
            content: 'â† ×’×œ×•×œ ×œ×§×¨×™××ª ×”×§×•×“ ×”××œ× â†’';
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: rgba(255,255,255,0.6);
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.7rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .code-block:hover::before {
            opacity: 1;
        }

        .code-block pre {
            margin: 0;
            white-space: pre;
            overflow-x: visible;
        }

        .code-block::-webkit-scrollbar {
            height: 10px;
        }

        .code-block::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.3);
            border-radius: 5px;
        }

        .code-block::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 5px;
        }

        .code-block::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.5);
        }

        .code-comment {
            color: #6c7086;
        }

        .code-command {
            color: #89dceb;
        }

        .code-string {
            color: #a6e3a1;
        }

        .code-number {
            color: #fab387;
        }

        /* === FEATURE CARDS === */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .feature-card {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
            box-shadow: var(--shadow-sm);
        }

        .feature-card:hover {
            border-color: var(--airflow-primary);
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .feature-card h4 {
            margin: 0 0 12px 0;
            color: var(--airflow-primary);
            font-size: 1.1rem;
        }

        .feature-card p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* === TIMELINE === */
        .timeline {
            position: relative;
            padding: 30px 0;
            margin: 30px 0;
        }

        .timeline-item {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 25px;
            margin-bottom: 20px;
            border-right: 5px solid var(--airflow-primary);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s;
        }

        .timeline-item:hover {
            transform: translateX(-5px);
            box-shadow: var(--shadow-md);
        }

        .timeline-item h4 {
            margin: 0 0 10px 0;
            color: var(--airflow-primary);
            font-size: 1.1rem;
        }

        /* === UI SCREENSHOTS === */
        .ui-showcase {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 30px;
            margin: 30px 0;
            box-shadow: var(--shadow-md);
        }

        .ui-showcase h3 {
            margin-top: 0;
            margin-bottom: 20px;
            color: var(--airflow-dark);
            text-align: center;
        }

        .ui-placeholder {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-md);
            padding: 60px;
            text-align: center;
            color: var(--text-tertiary);
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* === SCROLLBAR === */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f3f5;
        }

        ::-webkit-scrollbar-thumb {
            background: #adb5bd;
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #868e96;
        }

        /* === EXERCISES === */
        .exercise-list {
            display: flex;
            flex-direction: column;
            gap: 25px;
            max-width: 1100px;
            margin: 0 auto;
        }

        .exercise-card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s;
        }

        .exercise-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .ex-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            gap: 20px;
        }

        .ex-number {
            background: linear-gradient(135deg, var(--airflow-primary), var(--airflow-secondary));
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 0.8rem;
            box-shadow: 0 2px 6px rgba(1, 124, 238, 0.3);
        }

        .ex-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--text-primary);
            flex: 1;
        }

        .ex-content {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .ex-content ul, .ex-content ol {
            padding-right: 25px;
            margin: 15px 0;
        }

        .ex-content li {
            margin-bottom: 10px;
        }

        /* === SOLUTION TOGGLE === */
        .solution-toggle {
            margin: 20px 0;
            padding: 15px;
            background: linear-gradient(135deg, var(--airflow-primary), var(--airflow-secondary));
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1rem;
            width: 100%;
            transition: all 0.3s;
            font-family: 'Heebo', sans-serif;
        }

        .solution-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(1, 124, 238, 0.4);
        }

        .solution-content {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: rgba(17, 213, 140, 0.1);
            border-right: 4px solid var(--airflow-green);
            border-radius: 8px;
        }

        .solution-content.show {
            display: block;
            animation: fadeIn 0.3s;
        }

        /* === CODE BLOCKS ENHANCED === */
        .code-block {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 25px 30px;
            border-radius: var(--radius-md);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.88rem;
            line-height: 1.8;
            margin: 25px 0;
            direction: ltr;
            text-align: left;
            overflow-x: auto;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            white-space: pre;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .code-block:hover {
            background: #252538;
            border-color: var(--airflow-primary);
        }

        .code-block::before {
            content: 'ğŸ“‹ ×œ×—×¥ ×œ×”×¢×ª×§×”';
            position: absolute;
            top: 8px;
            left: 8px;
            font-size: 0.7rem;
            background: rgba(0,0,0,0.6);
            color: #94a3b8;
            padding: 4px 10px;
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .code-block:hover::before {
            opacity: 1;
        }

        /* === TABLES === */
        .reference-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.9rem;
            box-shadow: var(--shadow-sm);
        }

        .reference-table thead {
            background: linear-gradient(to left, #e7f5ff, #d0ebff);
            border-bottom: 2px solid var(--airflow-primary);
        }

        .reference-table th {
            padding: 14px;
            text-align: right;
            border: 1px solid var(--border-color);
            font-weight: 700;
        }

        .reference-table td {
            padding: 12px;
            border: 1px solid var(--border-color);
        }

        .reference-table tr:hover {
            background: #f8f9fa;
        }

        .reference-table code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--airflow-primary);
            direction: ltr;
        }

        /* === COPY NOTIFICATION === */
        .copy-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--airflow-green);
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            transform: translateX(400px);
            transition: transform 0.3s;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            font-weight: 600;
        }

        .copy-notification.show {
            transform: translateX(0);
        }

        /* === SEARCH === */
        .search-result-item {
            padding: 12px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-right: 4px solid var(--airflow-primary);
            cursor: pointer;
            transition: all 0.3s;
        }

        .search-result-item:hover {
            background: #e9ecef;
            transform: translateX(-4px);
        }

        .search-highlight {
            background: #ffd700;
            color: #000;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }

        /* === DARK MODE === */
        body.dark-mode {
            --bg-body: #1a1c20;
            --bg-surface: #2d3748;
            --text-primary: #e2e8f0;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --border-color: #4a5568;
            background: #1a1c20;
            color: #e2e8f0;
        }

        body.dark-mode .header {
            background: linear-gradient(135deg, #0D3D56, #017CEE);
        }

        body.dark-mode .comparison-card,
        body.dark-mode .exercise-card,
        body.dark-mode .step-card {
            background: #2d3748;
            border-color: #4a5568;
        }

        body.dark-mode .info-card {
            background: rgba(1, 124, 238, 0.15);
            border-color: var(--airflow-primary);
        }

        body.dark-mode .success-card {
            background: rgba(17, 213, 140, 0.15);
            border-color: var(--airflow-green);
        }

        body.dark-mode .warning-card {
            background: rgba(255, 109, 76, 0.15);
            border-color: var(--airflow-orange);
        }

        body.dark-mode .concept-card {
            background: #374151;
            border-right-color: var(--airflow-secondary);
        }

        body.dark-mode .theory-sidebar {
            background: #2d3748;
            border-color: #4a5568;
        }

        body.dark-mode .theory-nav-item:hover {
            background: #374151;
        }

        body.dark-mode .theory-nav-item.active {
            background: rgba(1, 124, 238, 0.2);
            color: var(--airflow-primary);
        }

        body.dark-mode .ui-showcase {
            background: #2d3748;
            border-color: #4a5568;
        }

        body.dark-mode .ui-placeholder {
            background: linear-gradient(135deg, #374151, #4b5563);
            border-color: #4a5568;
        }

        body.dark-mode .reference-table {
            background: #2d3748;
        }

        body.dark-mode .reference-table thead {
            background: linear-gradient(to left, #1e3a5f, #2c4a6f);
        }

        body.dark-mode .reference-table tr:hover {
            background: #374151;
        }

        body.dark-mode .reference-table code {
            background: #1e293b;
            color: var(--airflow-light);
        }

        body.dark-mode #searchBar {
            background: #2d3748;
            border-color: #4a5568;
        }

        body.dark-mode #searchInput {
            background: #374151;
            color: #e2e8f0;
            border-color: #4a5568;
        }

        body.dark-mode .search-result-item {
            background: #374151;
        }

        body.dark-mode .search-result-item:hover {
            background: #4b5563;
        }

        body.dark-mode .architecture-diagram {
            background: #2d3748;
            border-color: #4a5568;
        }

        body.dark-mode .diagram-box {
            background: #374151;
            border-color: var(--airflow-primary);
        }

        body.dark-mode .timeline-item {
            background: #2d3748;
            border-color: #4a5568;
        }

        /* === RESPONSIVE === */
        @media (max-width: 1024px) {
            .theory-layout {
                grid-template-columns: 1fr;
            }
            .theory-sidebar {
                display: none;
            }
            .header {
                flex-direction: column;
                height: auto;
                padding: 20px;
                gap: 15px;
            }
            .nav-tabs {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>

<header class="header">
    <div class="brand">
        <div class="airflow-logo">A</div>
        <div class="brand-text">
            <div class="header-logo">DATA ENGINEERING HUB</div>
            <h1>Apache Airflow - ××“×¨×™×š ××§×™×£</h1>
            <p>×¤×œ×˜×¤×•×¨××” ×œ× ×™×”×•×œ Workflows | ××“×¨×™×š ××™× ×˜×¨××§×˜×™×‘×™</p>
        </div>
    </div>

    <div class="nav-tabs">
        <div class="nav-item active" onclick="switchView('theory', this)">ğŸ“š ×ª×™××•×¨×™×”</div>
        <div class="nav-item" onclick="switchView('installation', this)">ğŸš€ ×”×ª×§× ×”</div>
        <div class="nav-item" onclick="switchView('architecture', this)">ğŸ—ï¸ ××¨×›×™×˜×§×˜×•×¨×”</div>
        <div class="nav-item" onclick="switchView('ui', this)">ğŸ–¥ï¸ ×××©×§ ××©×ª××©</div>
        <div class="nav-item" onclick="switchView('examples', this)">ğŸ’¡ ×“×•×’×××•×ª DAG</div>
        <div class="nav-item" onclick="switchView('exercises', this)">ğŸ“ ×ª×¨×’×™×œ×™×</div>
        <div class="nav-item" onclick="switchView('cli', this)">âŒ¨ï¸ CLI</div>
        <div class="nav-item" onclick="switchView('troubleshooting', this)">ğŸ”§ ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª</div>
    </div>

    <div style="display: flex; gap: 15px; align-items: center;">
        <button id="darkModeToggle" onclick="toggleDarkMode()" style="background: rgba(255,255,255,0.2); border: none; padding: 10px 20px; border-radius: 8px; color: white; cursor: pointer; font-weight: 600; transition: all 0.3s; font-family: 'Heebo', sans-serif;">
            ğŸŒ™ ××¦×‘ ×œ×™×œ×”
        </button>
        <button onclick="toggleSearch()" style="background: rgba(255,255,255,0.2); border: none; padding: 10px 20px; border-radius: 8px; color: white; cursor: pointer; font-weight: 600; transition: all 0.3s; font-family: 'Heebo', sans-serif;">
            ğŸ” ×—×™×¤×•×©
        </button>
    </div>
</header>

<!-- Search Bar -->
<div id="searchBar" style="display: none; background: white; padding: 20px 40px; border-bottom: 2px solid var(--border-color); box-shadow: var(--shadow-md); z-index: 99;">
    <div style="max-width: 800px; margin: 0 auto; display: flex; gap: 15px; align-items: center;">
        <input type="text" id="searchInput" placeholder="×—×¤×© operators, ×¤×§×•×“×•×ª CLI, ××• × ×•×©××™×..." style="flex: 1; padding: 12px 20px; font-size: 1rem; border: 2px solid var(--border-color); border-radius: 8px; font-family: 'Heebo', sans-serif;" oninput="performSearch(this.value)">
        <button onclick="toggleSearch()" style="padding: 12px 24px; background: var(--airflow-primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-family: 'Heebo', sans-serif;">×¡×’×•×¨</button>
    </div>
    <div id="searchResults" style="max-width: 800px; margin: 15px auto 0; max-height: 400px; overflow-y: auto;"></div>
</div>

<div class="main-wrapper">

    <!-- === THEORY VIEW === -->
    <div id="view-theory" class="view-section active">
        <div class="theory-layout">
            <aside class="theory-sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-header">×™×¡×•×“×•×ª</div>
                    <div class="theory-nav-item active" onclick="showSection('intro', this)">
                        <span>ğŸ¯</span> ××‘×•× ×œ-Airflow
                    </div>
                    <div class="theory-nav-item" onclick="showSection('history', this)">
                        <span>ğŸ“œ</span> ×”×™×¡×˜×•×¨×™×”
                    </div>
                    <div class="theory-nav-item" onclick="showSection('why-airflow', this)">
                        <span>ğŸ’¡</span> ×œ××” Airflow?
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-header">×¨×›×™×‘×™×</div>
                    <div class="theory-nav-item" onclick="showSection('components', this)">
                        <span>ğŸ”§</span> ×¨×›×™×‘×™× ×¢×™×§×¨×™×™×
                    </div>
                    <div class="theory-nav-item" onclick="showSection('dag', this)">
                        <span>ğŸ”€</span> DAG
                    </div>
                    <div class="theory-nav-item" onclick="showSection('tasks', this)">
                        <span>ğŸ“‹</span> Tasks & Operators
                    </div>
                    <div class="theory-nav-item" onclick="showSection('hooks', this)">
                        <span>ğŸ”Œ</span> Hooks
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-header">××¨×›×™×˜×§×˜×•×¨×”</div>
                    <div class="theory-nav-item" onclick="showSection('sequential', this)">
                        <span>1ï¸âƒ£</span> Sequential
                    </div>
                    <div class="theory-nav-item" onclick="showSection('local', this)">
                        <span>ğŸ’»</span> Local Executor
                    </div>
                    <div class="theory-nav-item" onclick="showSection('celery', this)">
                        <span>ğŸŒ</span> Celery Executor
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-header">××ª×§×“×</div>
                    <div class="theory-nav-item" onclick="showSection('pools-queues', this)">
                        <span>ğŸŠ</span> Pools & Queues
                    </div>
                    <div class="theory-nav-item" onclick="showSection('xcoms', this)">
                        <span>ğŸ“¡</span> XComs
                    </div>
                    <div class="theory-nav-item" onclick="showSection('subdags', this)">
                        <span>ğŸ”„</span> SubDAGs
                    </div>
                    <div class="theory-nav-item" onclick="showSection('quick-reference', this)">
                        <span>ğŸ“‹</span> Quick Reference
                    </div>
                    <div class="theory-nav-item" onclick="showSection('best-practices', this)">
                        <span>âœ¨</span> Best Practices
                    </div>
                </div>
            </aside>

            <main class="theory-content">

                <!-- ××‘×•× -->
                <div id="section-intro" class="theory-section active">
                    <h1>ğŸ¯ ××‘×•× ×œ-Apache Airflow</h1>

                    <div class="info-card">
                        <h3>××”×• Apache Airflow?</h3>
                        <p><strong>Airflow</strong> ×”×•× ×¤×œ×˜×¤×•×¨××” ×œ×›×ª×™×‘×”, ×ª×–××•×Ÿ ×•× ×™×˜×•×¨ ×©×œ workflows ×‘××•×¤×Ÿ ×¤×¨×•×’×¨××˜×™.</p>
                        <p>×”×©×ª××© ×‘-Airflow ×œ×›×ª×•×‘ workflows ×›-<strong>Directed Acyclic Graphs (DAGs)</strong> ×©×œ ××©×™××•×ª.</p>
                    </div>

                    <h2>×××¤×™×™× ×™× ××¨×›×–×™×™×</h2>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ“</span>
                            <h4>Programmatic</h4>
                            <p>×›×ª×™×‘×ª workflows ×›×§×•×“ Python</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">â°</span>
                            <h4>Scheduling</h4>
                            <p>×ª×–××•×Ÿ ××•×˜×•××˜×™ ×©×œ ××©×™××•×ª</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ“Š</span>
                            <h4>Monitoring</h4>
                            <p>××¢×§×‘ ×•× ×™×˜×•×¨ ×‘×–××Ÿ ×××ª</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ”„</span>
                            <h4>Dynamic</h4>
                            <p>pipelines ×“×™× ××™×™× ×•××ª×¤×ª×—×™×</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ”Œ</span>
                            <h4>Extensible</h4>
                            <p>× ×™×ª×Ÿ ×œ×”×¨×—×‘×” ×¢× plugins</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ¨</span>
                            <h4>Rich UI</h4>
                            <p>×××©×§ ××©×ª××© ××™× ×˜×•××™×˜×™×‘×™</p>
                        </div>
                    </div>

                    <h2>×™×ª×¨×•× ×•×ª Airflow</h2>
                    <div class="success-card">
                        <h4>âœ… ×œ××” Airflow?</h4>
                        <ul>
                            <li><strong>Workflows as Code</strong> - workflows ××•×’×“×¨×™× ×›×§×•×“ Python</li>
                            <li><strong>Maintainable</strong> - ×§×œ ×œ×ª×—×–×•×§×”, versioning ×•-testing</li>
                            <li><strong>Collaborative</strong> - ×××¤×©×¨ ×©×™×ª×•×£ ×¤×¢×•×œ×” ×‘×™×Ÿ ×¦×•×•×ª×™×</li>
                            <li><strong>Rich CLI</strong> - ×¤×§×•×“×•×ª ×©×•×¨×ª ×¤×§×•×“×” ×¢×•×¦××ª×™×•×ª</li>
                            <li><strong>Scalable</strong> - ××ª××™× ×œ×›×œ ×’×•×“×œ ××¨×’×•×Ÿ</li>
                        </ul>
                    </div>

                    <div class="architecture-diagram">
                        <h3 style="margin-bottom: 30px;">×ª×”×œ×™×š ×‘×¡×™×¡×™ ×‘-Airflow</h3>
                        <div class="diagram-row" style="flex-direction: column; gap: 20px;">
                            <div class="diagram-box">×›×ª×™×‘×ª DAG ×‘Python</div>
                            <div class="diagram-arrow">â†“</div>
                            <div class="diagram-box scheduler">Scheduler ××–×”×” ×•××¤×¢×™×œ ××©×™××•×ª</div>
                            <div class="diagram-arrow">â†“</div>
                            <div class="diagram-box executor">Executor ××¨×™×¥ ××ª ×”××©×™××•×ª</div>
                            <div class="diagram-arrow">â†“</div>
                            <div class="diagram-box worker">Workers ××‘×¦×¢×™× ××ª ×”×¢×‘×•×“×”</div>
                        </div>
                    </div>
                </div>

                <!-- ×”×™×¡×˜×•×¨×™×” -->
                <div id="section-history" class="theory-section">
                    <h1>ğŸ“œ ×”×™×¡×˜×•×¨×™×” ×©×œ Airflow</h1>

                    <div class="info-card" style="background: linear-gradient(135deg, #fff9db, #fff3bf); border-color: var(--airflow-orange);">
                        <h3>ğŸ  × ×•×¦×¨ ×‘-Airbnb</h3>
                        <p><strong>Airbnb</strong> ×”×™× ×—×‘×¨×” ×©×’×“×œ×” ××”×¨ ×•××‘×•×¡×¡×ª × ×ª×•× ×™× (data-informed).</p>
                        <p>×¦×•×•×ª×™ ×”× ×ª×•× ×™× ×•×›××•×ª ×”× ×ª×•× ×™× ×’×“×œ×™× ×‘××”×™×¨×•×ª, ×•×‘×”×ª×××” ×’× ×”××•×¨×›×‘×•×ª ×©×œ ×”××ª×’×¨×™× ×©×”× ××ª××•×“×“×™× ××™×ª×.</p>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item">
                            <h4>×”×¦×•×¨×š ×‘×¤×ª×¨×•×Ÿ</h4>
                            <p>×›×•×— ×”×¢×‘×•×“×” ×”×’×“×œ ×©×œ data engineers, data scientists ×•-analysts ×‘-Airbnb ×–×§×•×§ ×œ×¤×œ×˜×¤×•×¨××” ×©×ª××¤×©×¨ ×ª× ×•×¢×” ××”×™×¨×”.</p>
                        </div>

                        <div class="timeline-item">
                            <h4>×¤×™×ª×•×— Airflow</h4>
                            <p>Airbnb ×‘× ×ª×” ××ª Airflow ×›×“×™ ×œ××¤×©×¨ ×œ××”× ×“×¡×™× ×œ×›×ª×•×‘ (author), ×œ× ×˜×¨ (monitor) ×•×œ×©×“×¨×’ (retrofit) data pipelines.</p>
                        </div>

                        <div class="timeline-item">
                            <h4>Open Source</h4>
                            <p>Airbnb ×”×—×œ×™×˜×” ×œ×©×ª×£ ××ª Airflow ×¢× ×”×§×”×™×œ×” ×•×œ×”×¤×•×š ××•×ª×• ×œ-<strong>Open Source</strong>.</p>
                        </div>

                        <div class="timeline-item">
                            <h4>Apache Incubator</h4>
                            <p>Airflow ×”×¦×˜×¨×£ ×œ-Apache Software Foundation ×•×”×¤×š ×œ×¤×¨×•×™×§×˜ Apache ××œ×.</p>
                        </div>

                        <div class="timeline-item">
                            <h4>×”×™×•×</h4>
                            <p>Airflow ×”×•× ××—×“ ×”×›×œ×™× ×”×¤×•×¤×•×œ×¨×™×™× ×‘×™×•×ª×¨ ×œ× ×™×”×•×œ data pipelines, ×¢× ×§×”×™×œ×” ×’×“×•×œ×” ×•×ª×•××›×ª.</p>
                        </div>
                    </div>

                    <div class="concept-card">
                        <h4>ğŸ’¡ ×œ××” ×–×” ×—×©×•×‘?</h4>
                        <p>Airflow × ×•×¦×¨ ××ª×•×š ×¦×•×¨×š ×××™×ª×™ ×©×œ ×—×‘×¨×” ×©××˜×¤×œ×ª ×‘×›××•×™×•×ª ×¢×¦×•××•×ª ×©×œ × ×ª×•× ×™×.</p>
                        <p>×–×” ×œ× ×¤×¨×•×™×§×˜ ××§×“××™ - ×–×” ×›×œ×™ ×©× ×‘× ×” ×œ×¤×ª×•×¨ ×‘×¢×™×•×ª ×××™×ª×™×•×ª ×‘×¤×¨×•×“×§×©×Ÿ.</p>
                    </div>
                </div>

                <!-- ×œ××” Airflow -->
                <div id="section-why-airflow" class="theory-section">
                    <h1>ğŸ’¡ ×œ××” Airflow?</h1>

                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>ğŸ“ One Place</h4>
                            <p>××§×•× ××—×“ ×¢×‘×•×¨ scheduling ×•-data pipelines - ×œ× ×¦×¨×™×š ×›×œ×™× × ×¤×¨×“×™×</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ Python Code Base</h4>
                            <p>×›×ª×™×‘×ª workflows ×‘-Python - ×©×¤×” ×©×¨×•×‘ ××”× ×“×¡×™ ×”× ×ª×•× ×™× ××›×™×¨×™×</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ“ Callable Events</h4>
                            <p>×™×›×•×œ×ª ×œ×”×¤×¢×™×œ ××©×™××•×ª ×“×¨×š events ×•triggers</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ“¡ XComs</h4>
                            <p>×× ×’× ×•×Ÿ ×œ×”×¢×‘×¨×ª ××™×“×¢ ×‘×™×Ÿ ××©×™××•×ª (cross-communication)</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ¯ Trigger Rules</h4>
                            <p>×©×œ×™×˜×” ××ª×§×“××ª ×¢×œ ××ª×™ ××©×™××•×ª ××•×¤×¢×œ×•×ª</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ¨ Simple UI</h4>
                            <p>×××©×§ ××©×ª××© ×¤×©×•×˜ ×•××™× ×˜×•××™×˜×™×‘×™</p>
                        </div>

                        <div class="comparison-card">
                            <h4>âš¡ Powerful CLI</h4>
                            <p>×¤×§×•×“×•×ª CLI ×¢×•×¦××ª×™×•×ª ×œ× ×™×”×•×œ ×•debug</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸŠ Queues & Pools</h4>
                            <p>× ×™×”×•×œ ××©××‘×™× ×•×”×’×‘×œ×ª parallelism</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ‘¥ Growing Community</h4>
                            <p>×§×”×™×œ×” ×’×“×•×œ×” ×•×ª×•××›×ª, plugins ×¨×‘×™×</p>
                        </div>
                    </div>

                    <h2>×”×©×•×•××” ×œ×›×œ×™× ××—×¨×™×</h2>
                    <div class="info-card">
                        <h4>ğŸ†š Airflow vs Cron Jobs</h4>
                        <ul>
                            <li><strong>Cron:</strong> ×¤×©×•×˜ ××‘×œ ××•×’×‘×œ - ×§×©×” ×œ× ×”×œ ×ª×œ×•×™×•×ª, ××™×Ÿ UI, ××™×Ÿ monitoring</li>
                            <li><strong>Airflow:</strong> ××ª×•×—×›× - ×× ×”×œ ×ª×œ×•×™×•×ª, UI ××œ×, monitoring, retry logic ×•×¢×•×“</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h4>ğŸ†š Airflow vs Luigi</h4>
                        <ul>
                            <li><strong>Luigi:</strong> ×¤×•×ª×— ×¢×œ ×™×“×™ Spotify, ×¤×—×•×ª ×¤×•×¤×•×œ×¨×™</li>
                            <li><strong>Airflow:</strong> ×§×”×™×œ×” ×’×“×•×œ×” ×™×•×ª×¨, UI ×˜×•×‘ ×™×•×ª×¨, ×™×•×ª×¨ plugins</li>
                        </ul>
                    </div>

                    <div class="success-card">
                        <h4>ğŸ¯ ××ª×™ ×œ×”×©×ª××© ×‘-Airflow?</h4>
                        <ul>
                            <li>×›×©×™×© ×¦×•×¨×š ×‘-<strong>scheduling ××•×¨×›×‘</strong></li>
                            <li>×›×©×™×© <strong>×ª×œ×•×™×•×ª</strong> ×‘×™×Ÿ ××©×™××•×ª</li>
                            <li>×›×©×¦×¨×™×š <strong>monitoring</strong> ×•-alerting</li>
                            <li>×›×©×¨×•×¦×™× ×œ×›×ª×•×‘ workflows <strong>×›×§×•×“</strong></li>
                            <li>×›×©×¦×¨×™×š <strong>scalability</strong></li>
                        </ul>
                    </div>
                </div>

                <!-- ×¨×›×™×‘×™× -->
                <div id="section-components" class="theory-section">
                    <h1>ğŸ”§ ×¨×›×™×‘×™× ×¢×™×§×¨×™×™× ×‘-Airflow</h1>

                    <h2>×¨×›×™×‘×™× ×‘×¡×™×¡×™×™×</h2>

                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>ğŸ“‹ Task</h4>
                            <p><strong>×™×—×™×“×ª ×¢×‘×•×“×” ××•×’×“×¨×ª</strong></p>
                            <p>×–×•×”×™ ×™×—×™×“×” ××˜×•××™×ª ×©×œ ×¢×‘×•×“×” - ×¦×¢×“ ×‘×•×“×“ ×‘-pipeline</p>
                            <p>(× ×§×¨××™× <strong>Operators</strong> ×‘-Airflow)</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ”€ DAG</h4>
                            <p><strong>Directed Acyclic Graph</strong></p>
                            <p>××•×¡×£ ×©×œ tasks ×¢× ×¡×“×¨ ×‘×™×¦×•×¢ ××¤×•×¨×©, ×”×ª×—×œ×” ×•×¡×•×£</p>
                            <p>××™×™×¦×’ workflow ×©×œ×</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ”Œ Hooks</h4>
                            <p><strong>×××©×§×™× ×œ××¢×¨×›×•×ª ×—×™×¦×•× ×™×•×ª</strong></p>
                            <p>×—×™×‘×•×¨×™× ×œ×¤×œ×˜×¤×•×¨××•×ª ×•×‘×¡×™×¡×™ × ×ª×•× ×™×:</p>
                            <ul style="font-size: 0.85rem; margin-top: 10px;">
                                <li>Hive, S3, MySQL</li>
                                <li>Postgres, HDFS, Pig</li>
                            </ul>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸŠ Pools</h4>
                            <p><strong>×”×’×‘×œ×ª parallelism</strong></p>
                            <p>×©×™××•×© ×œ×”×’×‘×œ×ª ××¡×¤×¨ ××©×™××•×ª ×©×¨×¦×•×ª ×‘××§×‘×™×œ</p>
                            <p>×©×™××•×©×™ ×œ×× ×™×¢×ª ×¢×•××¡ ×¢×œ ××©××‘×™×</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ“¦ Variables</h4>
                            <p><strong>××—×¡×•×Ÿ key-value</strong></p>
                            <p>×“×¨×š generic ×œ××—×¡×•×Ÿ ×•×”×—×–×¨×ª ×ª×•×›×Ÿ ××• ×”×’×“×¨×•×ª</p>
                            <p>×›××• ××¢×¨×›×ª config ×¤×©×•×˜×”</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ“¬ Queues</h4>
                            <p><strong>× ×™×”×•×œ ×¢×“×™×¤×•×™×•×ª</strong></p>
                            <p>×›××©×¨ ××©×ª××©×™× ×‘-CeleryExecutor</p>
                            <p>× ×™×ª×Ÿ ×œ×¦×™×™×Ÿ ×œ××™×–×” queue ×œ×©×œ×•×— ××©×™××•×ª</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ”„ SubDAGs</h4>
                            <p><strong>DAGs ××§×•× × ×™×</strong></p>
                            <p>×”×’×“×¨×ª ×¤×•× ×§×¦×™×” ×©××—×–×™×¨×” DAG object</p>
                            <p>×©×™××•×©×™ ×œ××¨×’×•×Ÿ ×§×•×“ ×•reusability</p>
                        </div>

                        <div class="comparison-card">
                            <h4>â±ï¸ SLAs</h4>
                            <p><strong>Service Level Agreements</strong></p>
                            <p>×–××Ÿ ×©×‘×• task ××• DAG ×¦×¨×™×›×™× ×œ×”×¦×œ×™×—</p>
                            <p>××•×’×“×¨ ×›timedelta ×‘×¨××ª task</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ¯ Trigger Rules</h4>
                            <p><strong>×›×œ×œ×™ ×”×¤×¢×œ×” ××ª×§×“××™×</strong></p>
                            <p>××¤×©×¨ ×œ×”×’×“×™×¨ ×ª×œ×•×™×•×ª ××•×¨×›×‘×•×ª</p>
                            <p>×œ× ×¨×§ "×›×œ ×”tasks ×”×§×•×“××™× ×”×¦×œ×™×—×•"</p>
                        </div>
                    </div>
                </div>

                <!-- DAG -->
                <div id="section-dag" class="theory-section">
                    <h1>ğŸ”€ ××”×• DAG?</h1>

                    <div class="info-card">
                        <h3>Directed Acyclic Graph</h3>
                        <p><strong>DAG</strong> ×”×•× ×’×¨×£ ××›×•×•×Ÿ ×œ×œ× ××¢×’×œ×™× (×¦×™×§×œ×™×™×).</p>
                        <p>×–×”×• ×”×œ×‘ ×©×œ Airflow - ×™×™×¦×•×’ ×©×œ workflow ×©×œ×.</p>
                    </div>

                    <h2>××¨×›×™×‘×™ DAG</h2>
                    <div class="concept-card">
                        <h4>ğŸ“Š ××‘× ×”</h4>
                        <ul>
                            <li><strong>Nodes</strong> - Tasks (×¤×¢×•×œ×•×ª)</li>
                            <li><strong>Edges</strong> - ×ª×œ×•×™×•×ª ×‘×™×Ÿ tasks</li>
                            <li><strong>Directed</strong> - ×›×œ edge ×™×© ×›×™×•×•×Ÿ (×-Task A ×œ-Task B)</li>
                            <li><strong>Acyclic</strong> - ××™×Ÿ ××¢×’×œ×™× (×œ× ×™×›×•×œ Task A ×œ×”×•×‘×™×œ ×‘×—×–×¨×” ×œ-Task A)</li>
                        </ul>
                    </div>

                    <h2>×“×•×’××ª DAG ×¤×©×•×˜×”</h2>
                    <div class="code-block">
<span class="code-comment"># Import libraries</span>
<span class="code-command">from</span> airflow <span class="code-command">import</span> DAG
<span class="code-command">from</span> airflow.operators.bash <span class="code-command">import</span> BashOperator
<span class="code-command">from</span> datetime <span class="code-command">import</span> datetime, timedelta

<span class="code-comment"># Default arguments</span>
default_args = {
    <span class="code-string">'owner'</span>: <span class="code-string">'airflow'</span>,
    <span class="code-string">'depends_on_past'</span>: False,
    <span class="code-string">'start_date'</span>: datetime(<span class="code-number">2024</span>, <span class="code-number">1</span>, <span class="code-number">1</span>),
    <span class="code-string">'retries'</span>: <span class="code-number">1</span>,
    <span class="code-string">'retry_delay'</span>: timedelta(minutes=<span class="code-number">5</span>),
}

<span class="code-comment"># Create DAG</span>
dag = DAG(
    <span class="code-string">'my_first_dag'</span>,
    default_args=default_args,
    description=<span class="code-string">'A simple tutorial DAG'</span>,
    schedule_interval=timedelta(days=<span class="code-number">1</span>),
)

<span class="code-comment"># Define tasks</span>
t1 = BashOperator(
    task_id=<span class="code-string">'print_date'</span>,
    bash_command=<span class="code-string">'date'</span>,
    dag=dag,
)

t2 = BashOperator(
    task_id=<span class="code-string">'sleep'</span>,
    bash_command=<span class="code-string">'sleep 5'</span>,
    dag=dag,
)

t3 = BashOperator(
    task_id=<span class="code-string">'print_done'</span>,
    bash_command=<span class="code-string">'echo "Done!"'</span>,
    dag=dag,
)

<span class="code-comment"># Set dependencies</span>
t1 >> t2 >> t3  <span class="code-comment"># t1 then t2 then t3</span>
                    </div>

                    <h2>×ª×›×•× ×•×ª ×—×©×•×‘×•×ª ×©×œ DAG</h2>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>ğŸ“… Schedule</h4>
                            <p>××ª×™ ×”-DAG ×¦×¨×™×š ×œ×¨×•×¥</p>
                            <p>Cron expression ××• timedelta</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ“ Start Date</h4>
                            <p>××ª×™ ×”-DAG ××ª×—×™×œ ×œ×”×™×•×ª ×¤×¢×™×œ</p>
                            <p>Backfill ××¤×©×¨×™ ×œ×ª××¨×™×›×™× ×§×•×“××™×</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ”„ Retries</h4>
                            <p>×›××” ×¤×¢××™× ×œ× ×¡×•×ª ×©×•×‘ ×‘××§×¨×” ×©×œ failure</p>
                            <p>retry_delay ×§×•×‘×¢ ×›××” ×–××Ÿ ×œ×—×›×•×ª</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ‘¤ Owner</h4>
                            <p>××™ ××—×¨××™ ×¢×œ ×”-DAG</p>
                            <p>×©×™××•×©×™ ×œorganization ×•alerts</p>
                        </div>
                    </div>

                    <div class="warning-card">
                        <h4>âš ï¸ ×›×œ×œ×™× ×—×©×•×‘×™×:</h4>
                        <ul>
                            <li>DAG ×—×™×™×‘ ×œ×”×™×•×ª <strong>Acyclic</strong> - ××™×Ÿ ×œ×•×œ××•×ª!</li>
                            <li>×›×œ task ×—×™×™×‘ ×œ×”×™×•×ª <strong>idempotent</strong> - ×”×¨×¦×” ××¡×¤×¨ ×¤×¢××™× ×ª×™×ª×Ÿ ×ª×•×¦××” ×–×”×”</li>
                            <li>×ª×œ×•×™×•×ª ×—×™×™×‘×•×ª ×œ×”×™×•×ª <strong>××¤×•×¨×©×•×ª</strong> ×•×‘×¨×•×¨×•×ª</li>
                        </ul>
                    </div>
                </div>

                <!-- Tasks & Operators -->
                <div id="section-tasks" class="theory-section">
                    <h1>ğŸ“‹ Tasks & Operators</h1>

                    <div class="info-card">
                        <h3>××”×• Task?</h3>
                        <p><strong>Task</strong> ×”×•× ×™×—×™×“×ª ×¢×‘×•×“×” ×‘×•×“×“×ª ×‘-DAG - ×¦×¢×“ ××˜×•××™ ×‘pipeline.</p>
                        <p>×‘-Airflow, tasks × ×•×¦×¨×™× ×‘×××¦×¢×•×ª <strong>Operators</strong>.</p>
                    </div>

                    <h2>×¡×•×’×™ Operators × ×¤×•×¦×™×</h2>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>ğŸš BashOperator</h4>
                            <p>××¨×™×¥ ×¤×§×•×“×•×ª bash</p>
                            <div class="code-block" style="font-size: 0.75rem; margin-top: 15px;">
task = BashOperator(
    task_id='my_task',
    bash_command='echo "Hello"',
    dag=dag
)</div>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ PythonOperator</h4>
                            <p>××¨×™×¥ ×¤×•× ×§×¦×™×™×ª Python</p>
                            <div class="code-block" style="font-size: 0.75rem; margin-top: 15px;">
task = PythonOperator(
    task_id='my_task',
    python_callable=my_function,
    dag=dag
)</div>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ“§ EmailOperator</h4>
                            <p>×©×•×œ×— ××™××™×™×œ</p>
                            <div class="code-block" style="font-size: 0.75rem; margin-top: 15px;">
task = EmailOperator(
    task_id='send_email',
    to='user@example.com',
    subject='Alert',
    dag=dag
)</div>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ—„ï¸ SqlOperator</h4>
                            <p>××¨×™×¥ SQL query</p>
                            <div class="code-block" style="font-size: 0.75rem; margin-top: 15px;">
task = PostgresOperator(
    task_id='run_query',
    sql='SELECT * FROM table',
    dag=dag
)</div>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ“ HiveOperator</h4>
                            <p>××¨×™×¥ Hive query</p>
                            <p style="font-size: 0.85rem; margin-top: 10px;">×¢×‘×•×¨ data warehousing</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ˜ SparkSubmitOperator</h4>
                            <p>×©×•×œ×— Spark job</p>
                            <p style="font-size: 0.85rem; margin-top: 10px;">×¢×‘×•×¨ big data processing</p>
                        </div>

                        <div class="comparison-card">
                            <h4>â˜ï¸ S3Operator</h4>
                            <p>×¤×¢×•×œ×•×ª ×¢×œ AWS S3</p>
                            <p style="font-size: 0.85rem; margin-top: 10px;">×”×¢×œ××”/×”×•×¨×“×” ×S3</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ¯ SimpleHttpOperator</h4>
                            <p>×§×¨×™××•×ª HTTP/API</p>
                            <p style="font-size: 0.85rem; margin-top: 10px;">××™× ×˜×’×¨×¦×™×” ×¢× APIs</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ”„ DummyOperator</h4>
                            <p>×œ× ×¢×•×©×” ×›×œ×•×</p>
                            <p style="font-size: 0.85rem; margin-top: 10px;">×©×™××•×©×™ ×œ××¨×’×•×Ÿ ×œ×•×’×™×§×”</p>
                        </div>
                    </div>

                    <h2>×”×’×“×¨×ª ×ª×œ×•×™×•×ª ×‘×™×Ÿ Tasks</h2>
                    <div class="code-block">
<span class="code-comment"># Method 1: Using >> operator</span>
task1 >> task2 >> task3  <span class="code-comment"># Linear: task1 â†’ task2 â†’ task3</span>

<span class="code-comment"># Method 2: Using set_upstream/set_downstream</span>
task2.set_upstream(task1)
task3.set_upstream(task2)

<span class="code-comment"># Method 3: Multiple dependencies</span>
task1 >> [task2, task3] >> task4  <span class="code-comment"># Fork and join</span>

<span class="code-comment"># Method 4: Chain helper</span>
<span class="code-command">from</span> airflow.models.baseoperator <span class="code-command">import</span> chain
chain(task1, task2, task3, task4)
                    </div>

                    <div class="concept-card">
                        <h4>ğŸ’¡ Idempotency - ×¢×§×¨×•×Ÿ ×—×©×•×‘</h4>
                        <p>×›×œ task ×¦×¨×™×š ×œ×”×™×•×ª <strong>idempotent</strong> - ×”×¨×¦×” ××¡×¤×¨ ×¤×¢××™× ×ª×™×ª×Ÿ ××•×ª×” ×ª×•×¦××”.</p>
                        <ul>
                            <li>×× task × ×›×©×œ ×•×¨×¥ ×©×•×‘ - ×¦×¨×™×š ×œ×”×™×•×ª ×‘×˜×•×—</li>
                            <li>××œ ×ª×¡××•×š ×¢×œ state ×—×™×¦×•× ×™ ×©××©×ª× ×”</li>
                            <li>×”×©×ª××© ×‘-execution_date ×œ× ×‘-datetime.now()</li>
                        </ul>
                    </div>
                </div>

                <!-- Hooks -->
                <div id="section-hooks" class="theory-section">
                    <h1>ğŸ”Œ Hooks - ×—×™×‘×•×¨×™× ×œ××¢×¨×›×•×ª ×—×™×¦×•× ×™×•×ª</h1>

                    <div class="info-card">
                        <h3>××”×• Hook?</h3>
                        <p><strong>Hook</strong> ×”×•× ×××©×§ ×œ×—×™×‘×•×¨ ×¢× ××¢×¨×›×•×ª ×—×™×¦×•× ×™×•×ª ×•×‘×¡×™×¡×™ × ×ª×•× ×™×.</p>
                        <p>Hooks ××›×™×œ×™× ××ª ×”×œ×•×’×™×§×” ×©×œ ×”×—×™×‘×•×¨ - authentication, connection management ×•×›×•'.</p>
                    </div>

                    <h2>Hooks × ×¤×•×¦×™×</h2>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>ğŸ—„ï¸ PostgresHook</h4>
                            <p>×—×™×‘×•×¨ ×œ-PostgreSQL</p>
                            <ul style="font-size: 0.85rem; margin-top: 10px;">
                                <li>run() - ×”×¨×¦×ª query</li>
                                <li>get_records() - ×§×‘×œ×ª ×ª×•×¦××•×ª</li>
                                <li>insert_rows() - ×”×›× ×¡×ª × ×ª×•× ×™×</li>
                            </ul>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ¬ MySqlHook</h4>
                            <p>×—×™×‘×•×¨ ×œ-MySQL</p>
                            <ul style="font-size: 0.85rem; margin-top: 10px;">
                                <li>get_conn() - connection object</li>
                                <li>get_pandas_df() - DataFrame</li>
                            </ul>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ˜ HiveHook</h4>
                            <p>×—×™×‘×•×¨ ×œ-Hive</p>
                            <ul style="font-size: 0.85rem; margin-top: 10px;">
                                <li>get_results() - ×ª×•×¦××•×ª query</li>
                                <li>load_file() - ×˜×¢×™× ×ª ×§×•×‘×¥</li>
                            </ul>
                        </div>

                        <div class="comparison-card">
                            <h4>â˜ï¸ S3Hook</h4>
                            <p>×—×™×‘×•×¨ ×œ-AWS S3</p>
                            <ul style="font-size: 0.85rem; margin-top: 10px;">
                                <li>load_file() - ×”×¢×œ××”</li>
                                <li>download_file() - ×”×•×¨×“×”</li>
                                <li>list_keys() - ×¨×©×™××ª ×§×‘×¦×™×</li>
                            </ul>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ”Œ HttpHook</h4>
                            <p>×—×™×‘×•×¨ ×œ-HTTP endpoints</p>
                            <ul style="font-size: 0.85rem; margin-top: 10px;">
                                <li>run() - ×‘×§×©×ª HTTP</li>
                                <li>check_response() - ×‘×“×™×§×ª ×ª×’×•×‘×”</li>
                            </ul>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ“ HDFSHook</h4>
                            <p>×—×™×‘×•×¨ ×œ-HDFS</p>
                            <ul style="font-size: 0.85rem; margin-top: 10px;">
                                <li>load_file() - ×”×¢×œ××” ×œ-HDFS</li>
                                <li>get_pandas_df() - ×§×¨×™××” ×œDF</li>
                            </ul>
                        </div>
                    </div>

                    <h2>×©×™××•×© ×‘-Hook</h2>
                    <div class="code-block">
<span class="code-command">from</span> airflow.providers.postgres.hooks.postgres <span class="code-command">import</span> PostgresHook

<span class="code-command">def</span> <span class="code-string">my_function</span>():
    <span class="code-comment"># Create hook instance</span>
    hook = PostgresHook(postgres_conn_id=<span class="code-string">'my_postgres'</span>)

    <span class="code-comment"># Run query</span>
    sql = <span class="code-string">"SELECT * FROM users WHERE age > 18"</span>
    records = hook.get_records(sql)

    <span class="code-comment"># Process results</span>
    <span class="code-command">for</span> record <span class="code-command">in</span> records:
        <span class="code-command">print</span>(record)
                    </div>

                    <div class="concept-card">
                        <h4>ğŸ”‘ Connections</h4>
                        <p>Hooks ××©×ª××©×™× ×‘-<strong>Connections</strong> ×©××•×’×“×¨×™× ×‘-Airflow UI:</p>
                        <ul>
                            <li>Admin â†’ Connections</li>
                            <li>×”×’×“×¨: host, schema, login, password, port</li>
                            <li>Connection ID ××©××© ×‘×§×•×“</li>
                            <li>×××¤×©×¨ ×”×¤×¨×“×” ×‘×™×Ÿ ×§×•×“ ×œ-credentials</li>
                        </ul>
                    </div>
                </div>

                <!-- Pools & Queues -->
                <div id="section-pools-queues" class="theory-section">
                    <h1>ğŸŠ Pools & Queues</h1>

                    <h2>Pools - × ×™×”×•×œ ××©××‘×™×</h2>
                    <div class="info-card">
                        <h3>××”×• Pool?</h3>
                        <p><strong>Pool</strong> ××©××© ×œ×”×’×‘×œ×ª ××¡×¤×¨ tasks ×©×¨×¦×™× ×‘××§×‘×™×œ.</p>
                        <p>×©×™××•×©×™ ×›×“×™ ×œ×× ×•×¢ ×¢×•××¡ ×™×ª×¨ ×¢×œ ××©××‘×™× ××¡×•×™××™×.</p>
                    </div>

                    <h3>×“×•×’××”: ×”×’×‘×œ×ª ×’×™×©×” ×œ××¡×“ × ×ª×•× ×™×</h3>
                    <div class="concept-card">
                        <p><strong>×ª×¨×—×™×©:</strong> ×™×© ×œ× ×• 100 tasks ×©×¦×¨×™×›×™× ×œ×’×©×ª ×œ××¡×“ × ×ª×•× ×™×, ××‘×œ ×”××¡×“ ×™×›×•×œ ×œ×˜×¤×œ ×¨×§ ×‘-10 ×—×™×‘×•×¨×™× ×‘××§×‘×™×œ.</p>

                        <h4 style="margin-top: 20px;">×¤×ª×¨×•×Ÿ ×¢× Pool:</h4>
                        <ol style="padding-right: 25px;">
                            <li>×™×•×¦×¨×™× pool ×‘×©× "database_pool" ×¢× 10 slots</li>
                            <li>×›×œ task ××•×’×“×¨ ×¢× <code>pool='database_pool'</code></li>
                            <li>×¨×§ 10 tasks ×™×¨×•×¦×• ×‘××§×‘×™×œ</li>
                            <li>×”×©××¨ ×™×—×›×• ×‘×ª×•×¨</li>
                        </ol>
                    </div>

                    <div class="code-block">
<span class="code-comment"># Define task with pool</span>
task = PythonOperator(
    task_id=<span class="code-string">'query_db'</span>,
    python_callable=my_function,
    pool=<span class="code-string">'database_pool'</span>,  <span class="code-comment"># Assign to pool</span>
    dag=dag
)
                    </div>

                    <h2>Queues - ×¢×“×™×¤×•×™×•×ª ×‘-Celery</h2>
                    <div class="info-card">
                        <h3>××”×• Queue?</h3>
                        <p>×›××©×¨ ××©×ª××©×™× ×‘-<strong>CeleryExecutor</strong>, × ×™×ª×Ÿ ×œ×©×œ×•×— tasks ×œqueues ×©×•× ×™×.</p>
                        <p>×›×œ queue ×™×›×•×œ ×œ×”×™×•×ª ××˜×•×¤×œ ×¢×œ ×™×“×™ workers ×©×•× ×™×.</p>
                    </div>

                    <h3>×ª×¨×—×™×© ×©×™××•×©</h3>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>ğŸš€ High Priority Queue</h4>
                            <p>Tasks ×§×¨×™×˜×™×™× ×©×¦×¨×™×›×™× ×œ×”×ª×‘×¦×¢ ××”×¨</p>
                            <p style="font-size: 0.85rem; margin-top: 10px;">Workers ××”×™×¨×™×, ×™×•×ª×¨ ××©××‘×™×</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ¢ Low Priority Queue</h4>
                            <p>Tasks ×©×™×›×•×œ×™× ×œ×—×›×•×ª</p>
                            <p style="font-size: 0.85rem; margin-top: 10px;">Workers ××™×˜×™×™×, ×¤×—×•×ª ××©××‘×™×</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ’¾ Heavy Processing Queue</h4>
                            <p>Tasks ×©×¦×•×¨×›×™× ×”×¨×‘×” CPU/RAM</p>
                            <p style="font-size: 0.85rem; margin-top: 10px;">Workers ×—×–×§×™× ×‘××™×•×—×“</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸŒ API Queue</h4>
                            <p>Tasks ×©×¢×•×©×™× ×§×¨×™××•×ª API</p>
                            <p style="font-size: 0.85rem; margin-top: 10px;">Workers ×¢× ×’×™×©×” ×œ××™× ×˜×¨× ×˜</p>
                        </div>
                    </div>

                    <div class="code-block">
<span class="code-comment"># Assign task to specific queue</span>
task = BashOperator(
    task_id=<span class="code-string">'heavy_processing'</span>,
    bash_command=<span class="code-string">'python heavy_script.py'</span>,
    queue=<span class="code-string">'heavy_queue'</span>,  <span class="code-comment"># Send to specific queue</span>
    dag=dag
)
                    </div>
                </div>

                <!-- XComs -->
                <div id="section-xcoms" class="theory-section">
                    <h1>ğŸ“¡ XComs - ×ª×§×©×•×¨×ª ×‘×™×Ÿ Tasks</h1>

                    <div class="info-card">
                        <h3>××”×• XCom?</h3>
                        <p><strong>XCom</strong> (Cross-Communication) ×××¤×©×¨ ×œ-tasks ×œ×©×ª×£ ××™×“×¢ ×‘×™× ×™×”×.</p>
                        <p>×–×”×• ×× ×’× ×•×Ÿ ×œ×”×¢×‘×¨×ª × ×ª×•× ×™× ×§×˜× ×™× ×‘×™×Ÿ tasks ×‘DAG.</p>
                    </div>

                    <h2>××™×š ×–×” ×¢×•×‘×“?</h2>
                    <div class="concept-card">
                        <h4>Push & Pull</h4>
                        <ul>
                            <li><strong>xcom_push()</strong> - Task ×©×•×œ×— (push) ×¢×¨×š</li>
                            <li><strong>xcom_pull()</strong> - Task ××—×¨ ××•×©×š (pull) ××ª ×”×¢×¨×š</li>
                            <li>×”× ×ª×•× ×™× × ×©××¨×™× ×‘××¡×“ ×”× ×ª×•× ×™× ×©×œ Airflow</li>
                            <li>×›×œ XCom ××–×•×”×” ×œ×¤×™: dag_id, task_id, execution_date, key</li>
                        </ul>
                    </div>

                    <h2>×“×•×’××”</h2>
                    <div class="code-block">
<span class="code-command">from</span> airflow <span class="code-command">import</span> DAG
<span class="code-command">from</span> airflow.operators.python <span class="code-command">import</span> PythonOperator
<span class="code-command">from</span> datetime <span class="code-command">import</span> datetime

<span class="code-command">def</span> <span class="code-string">push_function</span>(**context):
    <span class="code-comment"># Calculate some value</span>
    value = <span class="code-number">42</span>

    <span class="code-comment"># Push to XCom</span>
    context[<span class="code-string">'ti'</span>].xcom_push(key=<span class="code-string">'my_key'</span>, value=value)
    <span class="code-comment"># Or simply return (will be pushed automatically)</span>
    <span class="code-command">return</span> value

<span class="code-command">def</span> <span class="code-string">pull_function</span>(**context):
    <span class="code-comment"># Pull from XCom</span>
    value = context[<span class="code-string">'ti'</span>].xcom_pull(
        task_ids=<span class="code-string">'push_task'</span>,
        key=<span class="code-string">'return_value'</span>  <span class="code-comment"># default key for return values</span>
    )

    <span class="code-command">print</span>(<span class="code-string">f"Received value: {value}"</span>)

<span class="code-comment"># Create DAG</span>
dag = DAG(<span class="code-string">'xcom_example'</span>, start_date=datetime(<span class="code-number">2024, 1, 1</span>))

push_task = PythonOperator(
    task_id=<span class="code-string">'push_task'</span>,
    python_callable=push_function,
    provide_context=<span class="code-command">True</span>,
    dag=dag
)

pull_task = PythonOperator(
    task_id=<span class="code-string">'pull_task'</span>,
    python_callable=pull_function,
    provide_context=<span class="code-command">True</span>,
    dag=dag
)

push_task >> pull_task
                    </div>

                    <div class="warning-card">
                        <h4>âš ï¸ ××’×‘×œ×•×ª XCom:</h4>
                        <ul>
                            <li><strong>×’×•×“×œ ××•×’×‘×œ</strong> - ××™×•×¢×“ ×œ× ×ª×•× ×™× ×§×˜× ×™× (metadata, IDs, paths)</li>
                            <li><strong>×œ× ×œ×“××˜×” ×’×“×•×œ×”</strong> - ××œ ×ª×©×ª××© ×œDataFrames ×’×“×•×œ×™×!</li>
                            <li><strong>Performance</strong> - ×©××™×¨×” ×‘××¡×“ × ×ª×•× ×™× = overhead</li>
                            <li><strong>×—×œ×•×¤×”:</strong> ×©××•×¨ ×“××˜×” ×’×“×•×œ×” ×‘-S3/HDFS ×•×”×¢×‘×¨ ×¨×§ ××ª ×”path</li>
                        </ul>
                    </div>
                </div>

                <!-- SubDAGs -->
                <div id="section-subdags" class="theory-section">
                    <h1>ğŸ”„ SubDAGs - ××¨×’×•×Ÿ DAGs ××•×¨×›×‘×™×</h1>

                    <div class="info-card">
                        <h3>××”×• SubDAG?</h3>
                        <p><strong>SubDAG</strong> ×”×•× DAG ×‘×ª×•×š DAG - ×“×¨×š ×œ××¨×’×Ÿ ×§×•×“ ×•×œ×¢×©×•×ª reuse.</p>
                        <p>×©×™××•×©×™ ×›×©×™×© ×§×‘×•×¦×ª tasks ×©×—×•×–×¨×ª ×‘××¡×¤×¨ ××§×•××•×ª.</p>
                    </div>

                    <h2>××ª×™ ×œ×”×©×ª××©?</h2>
                    <div class="concept-card">
                        <h4>×ª×¨×—×™×©×™× × ×¤×•×¦×™×:</h4>
                        <ul>
                            <li><strong>Pattern ×—×•×–×¨</strong> - ××•×ª×” ×¡×“×¨×ª tasks ×‘××¡×¤×¨ DAGs</li>
                            <li><strong>××¨×’×•×Ÿ ×œ×•×’×™</strong> - ×§×™×‘×•×¥ tasks ×§×©×•×¨×™×</li>
                            <li><strong>Readability</strong> - ×”×¤×™×›×ª DAG ××•×¨×›×‘ ×œ×¤×©×•×˜ ×™×•×ª×¨</li>
                            <li><strong>Reusability</strong> - ×©×™××•×© ×—×•×–×¨ ×‘×§×•×“</li>
                        </ul>
                    </div>

                    <h2>×“×•×’××”</h2>
                    <div class="code-block">
<span class="code-command">from</span> airflow <span class="code-command">import</span> DAG
<span class="code-command">from</span> airflow.operators.bash <span class="code-command">import</span> BashOperator
<span class="code-command">from</span> airflow.operators.subdag <span class="code-command">import</span> SubDagOperator
<span class="code-command">from</span> datetime <span class="code-command">import</span> datetime

<span class="code-comment"># Define SubDAG function</span>
<span class="code-command">def</span> <span class="code-string">sub_dag</span>(parent_dag_name, child_dag_name, args):
    dag_subdag = DAG(
        dag_id=<span class="code-string">f'{parent_dag_name}.{child_dag_name}'</span>,
        default_args=args,
        schedule_interval=<span class="code-string">"@daily"</span>,
    )

    <span class="code-command">for</span> i <span class="code-command">in</span> <span class="code-command">range</span>(<span class="code-number">3</span>):
        BashOperator(
            task_id=<span class="code-string">f'task_{i}'</span>,
            bash_command=<span class="code-string">f'echo "Subtask {i}"'</span>,
            dag=dag_subdag,
        )

    <span class="code-command">return</span> dag_subdag

<span class="code-comment"># Main DAG</span>
dag = DAG(
    <span class="code-string">'parent_dag'</span>,
    start_date=datetime(<span class="code-number">2024, 1, 1</span>),
    schedule_interval=<span class="code-string">'@daily'</span>
)

<span class="code-comment"># Use SubDAG</span>
section_1 = SubDagOperator(
    task_id=<span class="code-string">'section_1'</span>,
    subdag=sub_dag(<span class="code-string">'parent_dag'</span>, <span class="code-string">'section_1'</span>, dag.default_args),
    dag=dag,
)
                    </div>

                    <div class="warning-card">
                        <h4>âš ï¸ ×©×™× ×œ×‘:</h4>
                        <ul>
                            <li>SubDAGs ×™×›×•×œ×™× ×œ×”×™×•×ª ××•×¨×›×‘×™× ×œdebug</li>
                            <li>×™×© ×œ×”× overhead ×©×œ resources</li>
                            <li><strong>×—×œ×•×¤×”:</strong> TaskGroups (Airflow 2.0+) - ×¤×©×•×˜ ×™×•×ª×¨!</li>
                        </ul>
                    </div>
                </div>

                <!-- Sequential Executor -->
                <div id="section-sequential" class="theory-section">
                    <h1>1ï¸âƒ£ Sequential Executor</h1>

                    <div class="info-card">
                        <p><strong>Sequential Executor</strong> ×”×•× ××¦×‘ ×”×¨×¦×” ×”×¤×©×•×˜ ×‘×™×•×ª×¨ ×©×œ Airflow.</p>
                        <p>××¨×™×¥ task ××—×“ ×‘×›×œ ×¤×¢× - ××™×Ÿ parallelism ×›×œ×œ.</p>
                    </div>

                    <h2>×××¤×™×™× ×™×</h2>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <span class="feature-icon">1ï¸âƒ£</span>
                            <h4>Task ××—×“</h4>
                            <p>××¢×‘×“ ×¨×§ task ×‘×•×“×“ ×‘×›×œ ×¨×’×¢</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ¯</span>
                            <h4>×‘×¨×™×¨×ª ××—×“×œ</h4>
                            <p>×”××¦×‘ ×”×“×™×¤×•×œ×˜×™×‘×™ ×©×œ Airflow</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ“¦</span>
                            <h4>SQLite</h4>
                            <p>×¢×•×‘×“ ×¢× SQLite - ×œ× ×¦×¨×™×š DB ×—×™×¦×•× ×™</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸš€</span>
                            <h4>Setup ××”×™×¨</h4>
                            <p>×”×ª×§× ×” ×‘-5 ×“×§×•×ª</p>
                        </div>
                    </div>

                    <div class="warning-card">
                        <h4>âš ï¸ ××’×‘×œ×•×ª:</h4>
                        <ul>
                            <li><strong>××™×Ÿ parallelism</strong> - ××™×˜×™ ×××•×“ ×œDAGs ×¢× ×”×¨×‘×” tasks</li>
                            <li><strong>SQLite ×œ× ×ª×•××š ×‘concurrency</strong> - ×¨×§ connection ××—×“</li>
                            <li><strong>×œ× scalable</strong> - ××™ ××¤×©×¨ ×œ×”×•×¡×™×£ workers</li>
                            <li><strong>×œ× ××•××œ×¥ ×œ×¤×¨×•×“×§×©×Ÿ</strong> - ×¨×§ ×œ×¤×™×ª×•×— ××§×•××™</li>
                        </ul>
                    </div>

                    <h2>××ª×™ ×œ×”×©×ª××©?</h2>
                    <div class="concept-card">
                        <h4>âœ… ×˜×•×‘ ×¢×‘×•×¨:</h4>
                        <ul>
                            <li>×¤×™×ª×•×— ××§×•××™ ×•×‘×“×™×§×•×ª</li>
                            <li>×œ××™×“×” ×•× ×™×¡×•×™×™× ×¢× Airflow</li>
                            <li>DAGs ×§×˜× ×™× ×¢× ××¢×˜ tasks</li>
                            <li>POC (Proof of Concept)</li>
                        </ul>
                    </div>

                    <div class="concept-card">
                        <h4>âŒ ×œ× ×˜×•×‘ ×¢×‘×•×¨:</h4>
                        <ul>
                            <li>×¤×¨×•×“×§×©×Ÿ - ×‘×©×•× ×¤× ×™×!</li>
                            <li>DAGs ×¢× parallelism</li>
                            <li>×›×©×¦×¨×™×š performance</li>
                            <li>×›×©×™×© ×™×•×ª×¨ ×××©×ª××© ××—×“</li>
                        </ul>
                    </div>

                    <h2>×”×’×“×¨×”</h2>
                    <div class="code-block">
<span class="code-comment"># airflow.cfg</span>
[core]
executor = SequentialExecutor

[database]
sql_alchemy_conn = sqlite:////path/to/airflow.db
                    </div>
                </div>

                <!-- Local Executor -->
                <div id="section-local" class="theory-section">
                    <h1>ğŸ’» Local Executor</h1>

                    <div class="info-card">
                        <p><strong>Local Executor</strong> ××¨×™×¥ tasks ×‘××§×‘×™×œ ×¢×œ ××•×ª×” ×”××›×•× ×”.</p>
                        <p>×–×”×• ×”×©×œ×‘ ×”×‘× ××—×¨×™ Sequential - ××ª××™× ×œ×¤×¨×•×“×§×©×Ÿ ×§×˜×Ÿ-×‘×™× ×•× ×™.</p>
                    </div>

                    <h2>××™×š ×–×” ×¢×•×‘×“?</h2>
                    <div class="architecture-diagram">
                        <div class="diagram-row" style="flex-direction: column; gap: 20px;">
                            <div class="diagram-box scheduler">Scheduler</div>
                            <div class="diagram-arrow">â†“</div>
                            <div class="diagram-box executor">Local Executor<br><small>spawns processes</small></div>
                            <div class="diagram-arrow">â†“</div>
                            <div class="diagram-row">
                                <div class="diagram-box worker">Worker 1</div>
                                <div class="diagram-box worker">Worker 2</div>
                                <div class="diagram-box worker">Worker 3</div>
                                <div class="diagram-box worker">Worker N...</div>
                            </div>
                        </div>
                    </div>

                    <h2>×××¤×™×™× ×™×</h2>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <span class="feature-icon">âš¡</span>
                            <h4>Parallelism</h4>
                            <p>××¨×™×¥ tasks ×‘××§×‘×™×œ</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">â¬†ï¸</span>
                            <h4>Vertical Scaling</h4>
                            <p>×”×•×¡×£ CPU/RAM ×œmachine</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">âœ…</span>
                            <h4>Production Grade</h4>
                            <p>××ª××™× ×œ×¤×¨×•×“×§×©×Ÿ</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ—„ï¸</span>
                            <h4>PostgreSQL/MySQL</h4>
                            <p>×“×•×¨×© DB ×××™×ª×™ (×œ× SQLite)</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ“¦</span>
                            <h4>No Broker</h4>
                            <p>×œ× ×¦×¨×™×š RabbitMQ/Redis</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ¯</span>
                            <h4>Simple</h4>
                            <p>×¤×©×•×˜ ×™×•×ª×¨ ×Celery</p>
                        </div>
                    </div>

                    <h2>×™×ª×¨×•× ×•×ª ×•×—×¡×¨×•× ×•×ª</h2>
                    <div class="comparison-grid">
                        <div class="success-card">
                            <h4>âœ… ×™×ª×¨×•× ×•×ª:</h4>
                            <ul>
                                <li>×”×’×“×¨×” ×¤×©×•×˜×” - ×œ× ×¦×¨×™×š broker</li>
                                <li>×˜×•×‘ ×œ×¤×¨×•×“×§×©×Ÿ ×§×˜×Ÿ-×‘×™× ×•× ×™</li>
                                <li>×¤×—×•×ª moving parts = ×¤×—×•×ª ×“×‘×¨×™× ×©×™×›×•×œ×™× ×œ×”×™×©×‘×¨</li>
                                <li>×¢×œ×•×ª × ××•×›×” - machine ××—×ª</li>
                            </ul>
                        </div>

                        <div class="warning-card">
                            <h4>âš ï¸ ×—×¡×¨×•× ×•×ª:</h4>
                            <ul>
                                <li>××•×’×‘×œ ×œ××›×•× ×” ××—×ª</li>
                                <li>×× ×”××›×•× ×” × ×•×¤×œ×ª - ×”×›×œ × ×•×¤×œ</li>
                                <li>×œ× × ×™×ª×Ÿ ×œhorizontal scaling</li>
                                <li>××•×’×‘×œ ×‘××¡×¤×¨ workers (×œ×¤×™ CPU cores)</li>
                            </ul>
                        </div>
                    </div>

                    <h2>×”×’×“×¨×”</h2>
                    <div class="code-block">
<span class="code-comment"># airflow.cfg</span>
[core]
executor = LocalExecutor
parallelism = <span class="code-number">32</span>  <span class="code-comment"># max tasks in parallel across all DAGs</span>

[database]
sql_alchemy_conn = postgresql+psycopg2://user:pass@localhost/airflow
                    </div>

                    <div class="concept-card">
                        <h4>ğŸ’¡ ××ª×™ ×œ×”×©×ª××©?</h4>
                        <ul>
                            <li>×¤×¨×•×“×§×©×Ÿ ×§×˜×Ÿ-×‘×™× ×•× ×™ (×¢×“ ~100 DAGs)</li>
                            <li>×›×©×™×© machine ×—×–×§×” ×¢× ×”×¨×‘×” cores</li>
                            <li>×›×©×¨×•×¦×™× ×¤×©×˜×•×ª ×•×§×œ×•×ª ×ª×—×–×•×§×”</li>
                            <li>×›×©××™×Ÿ ×ª×§×¦×™×‘ ×œcluster ××œ×</li>
                        </ul>
                    </div>
                </div>

                <!-- Celery Executor -->
                <div id="section-celery" class="theory-section">
                    <h1>ğŸŒ Celery Executor</h1>

                    <div class="info-card">
                        <p><strong>Celery Executor</strong> ×”×•× ×”××¨×›×™×˜×§×˜×•×¨×” ×”××ª×§×“××ª ×‘×™×•×ª×¨ ×©×œ Airflow.</p>
                        <p>×××¤×©×¨ ×œ×”×¨×™×¥ Airflow ×¢×œ cluster ×©×œ machines ×¢× horizontal scaling.</p>
                    </div>

                    <h2>××¨×›×™×˜×§×˜×•×¨×”</h2>
                    <div class="architecture-diagram">
                        <div class="diagram-row" style="flex-direction: column; gap: 15px;">
                            <div class="diagram-box scheduler">Scheduler</div>
                            <div class="diagram-arrow">â†“</div>
                            <div class="diagram-box executor">Celery Executor<br><small>sends tasks to broker</small></div>
                            <div class="diagram-arrow">â†“</div>
                            <div class="diagram-box" style="background: linear-gradient(135deg, #fff3bf, white); border-color: var(--airflow-orange);">
                                Message Broker<br><small>(RabbitMQ / Redis)</small>
                            </div>
                            <div class="diagram-arrow">â†“</div>
                            <div class="diagram-row">
                                <div class="diagram-box worker">Worker 1<br><small>Machine A</small></div>
                                <div class="diagram-box worker">Worker 2<br><small>Machine B</small></div>
                                <div class="diagram-box worker">Worker 3<br><small>Machine C</small></div>
                                <div class="diagram-box worker">Worker N...<br><small>Scale â¡ï¸</small></div>
                            </div>
                        </div>
                    </div>

                    <h2>×¨×›×™×‘×™×</h2>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>ğŸ“… Scheduler</h4>
                            <p>×§×•×¨× DAGs ×•×©×•×œ×— tasks ×œ-broker</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ“¬ Message Broker</h4>
                            <p>RabbitMQ ××• Redis - ×× ×”×œ queues ×©×œ tasks</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ‘· Workers</h4>
                            <p>Celery workers ×¢×œ machines ×©×•× ×™× ×©××‘×¦×¢×™× ××ª ×”×¢×‘×•×“×”</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ—„ï¸ Result Backend</h4>
                            <p>PostgreSQL/MySQL - ×©×•××¨ ×ª×•×¦××•×ª ×•××˜×-×“××˜×”</p>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸŒ¸ Flower</h4>
                            <p>×××©×§ × ×™×˜×•×¨ ×œCelery (××•×¤×¦×™×•× ×œ×™ ××‘×œ ××•××œ×¥)</p>
                        </div>
                    </div>

                    <h2>×××¤×™×™× ×™×</h2>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <span class="feature-icon">â¬†ï¸â¡ï¸</span>
                            <h4>Both Scaling</h4>
                            <p>Vertical ×•Horizontal</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ“Š</span>
                            <h4>Flower</h4>
                            <p>× ×™×˜×•×¨ ××ª×§×“×</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">âœ…</span>
                            <h4>Production</h4>
                            <p>×‘×¨××ª ××¨×’×•× ×™×ª</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸŠ</span>
                            <h4>Pools & Queues</h4>
                            <p>×ª××™×›×” ××œ××”</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ”„</span>
                            <h4>Fault Tolerant</h4>
                            <p>worker × ×•×¤×œ? ×”×©××¨ ×××©×™×›×™×</p>
                        </div>
                        <div class="feature-card">
                            <span class="feature-icon">ğŸ¯</span>
                            <h4>Targeted Workers</h4>
                            <p>×©×œ×— tasks ×œworkers ×¡×¤×¦×™×¤×™×™×</p>
                        </div>
                    </div>

                    <h2>Queues - ××§×¨×” ×©×™××•×©</h2>
                    <div class="concept-card">
                        <h4>ğŸ“‹ ×ª×¨×—×™×©: ×¡×•×’×™ ×¢×•××¡×™× ×©×•× ×™×</h4>
                        <div class="comparison-grid" style="margin-top: 20px;">
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 8px;">
                                <h5 style="margin: 0 0 10px 0;">Queue: <code>default</code></h5>
                                <p style="font-size: 0.9rem; margin: 0;">Workers: 10 machines (2 CPU, 4GB RAM)</p>
                                <p style="font-size: 0.85rem; margin: 5px 0 0 0; color: var(--text-tertiary);">Tasks ×¨×’×™×œ×™×</p>
                            </div>

                            <div style="background: #fff3bf; padding: 20px; border-radius: 8px;">
                                <h5 style="margin: 0 0 10px 0;">Queue: <code>heavy</code></h5>
                                <p style="font-size: 0.9rem; margin: 0;">Workers: 3 machines (16 CPU, 64GB RAM)</p>
                                <p style="font-size: 0.85rem; margin: 5px 0 0 0; color: var(--text-tertiary);">Spark jobs, ML training</p>
                            </div>

                            <div style="background: #d3f9d8; padding: 20px; border-radius: 8px;">
                                <h5 style="margin: 0 0 10px 0;">Queue: <code>api</code></h5>
                                <p style="font-size: 0.9rem; margin: 0;">Workers: 5 machines (4 CPU, 8GB RAM)</p>
                                <p style="font-size: 0.85rem; margin: 5px 0 0 0; color: var(--text-tertiary);">API calls, webhooks</p>
                            </div>
                        </div>
                    </div>

                    <h2>×™×ª×¨×•× ×•×ª ×•×—×¡×¨×•× ×•×ª</h2>
                    <div class="comparison-grid">
                        <div class="success-card">
                            <h4>âœ… ×™×ª×¨×•× ×•×ª:</h4>
                            <ul>
                                <li><strong>Scalability ××œ××”</strong> - vertical ×•horizontal</li>
                                <li><strong>High Availability</strong> - worker × ×•×¤×œ? ×ª×•×¨ ×××©×™×š</li>
                                <li><strong>Queues</strong> - ×”×¤×¨×“×ª workloads</li>
                                <li><strong>Monitoring</strong> - Flower ×œ× ×™×˜×•×¨ ××ª×§×“×</li>
                                <li><strong>Flexibility</strong> - workers ×©×•× ×™× ×¢× specs ×©×•× ×™×</li>
                            </ul>
                        </div>

                        <div class="warning-card">
                            <h4>âš ï¸ ×—×¡×¨×•× ×•×ª:</h4>
                            <ul>
                                <li><strong>Complexity</strong> - ×”×¨×‘×” ×¨×›×™×‘×™× ×œ× ×”×œ</li>
                                <li><strong>Setup</strong> - ××•×¨×›×‘ ×œ×”×§×™×</li>
                                <li><strong>Cost</strong> - ×™×§×¨ ×™×•×ª×¨ (broker, workers...)</li>
                                <li><strong>Debugging</strong> - ×§×©×” ×™×•×ª×¨ ×œdebug</li>
                                <li><strong>Maintenance</strong> - ×™×•×ª×¨ ×“×‘×¨×™× ×©×™×›×•×œ×™× ×œ×”×™×©×‘×¨</li>
                            </ul>
                        </div>
                    </div>

                    <h2>×”×’×“×¨×”</h2>
                    <div class="code-block">
<span class="code-comment"># airflow.cfg</span>
[core]
executor = CeleryExecutor

[celery]
broker_url = redis://localhost:<span class="code-number">6379</span>/<span class="code-number">0</span>
result_backend = db+postgresql://user:pass@localhost/airflow
worker_concurrency = <span class="code-number">16</span>

<span class="code-comment"># Start workers on different machines</span>
airflow celery worker --queue default
airflow celery worker --queue heavy
airflow celery worker --queue api

<span class="code-comment"># Start Flower for monitoring</span>
airflow celery flower
                    </div>

                    <div class="concept-card">
                        <h4>ğŸ’¡ ××ª×™ ×œ×”×©×ª××©?</h4>
                        <ul>
                            <li><strong>×¤×¨×•×“×§×©×Ÿ ×‘×§× ×” ××™×“×” ×’×“×•×œ</strong> (100+ DAGs, 1000+ tasks/day)</li>
                            <li>×›×©×¦×¨×™×š <strong>high availability</strong></li>
                            <li>×›×©×™×© <strong>workloads ×©×•× ×™×</strong> ×©×¦×¨×™×›×™× resources ×©×•× ×™×</li>
                            <li>×›×©×™×© <strong>×ª×§×¦×™×‘</strong> ×œ×ª×©×ª×™×ª ××•×¨×›×‘×ª</li>
                            <li>×›×©×¦×•×•×ª ×”-DevOps ×™×›×•×œ ×œ× ×”×œ ××ª ×”infrastructure</li>
                        </ul>
                    </div>
                </div>

                <!-- Quick Reference -->
                <div id="section-quick-reference" class="theory-section">
                    <h1>ğŸ“‹ Quick Reference</h1>

                    <h2>ğŸ¯ Operators × ×¤×•×¦×™×</h2>
                    <table class="reference-table">
                        <thead>
                            <tr>
                                <th style="text-align: left; direction: ltr;">Operator</th>
                                <th>×ª×™××•×¨</th>
                                <th>Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>BashOperator</code></td>
                                <td>×”×¨×¦×ª ×¤×§×•×“×ª bash</td>
                                <td>Scripts, commands</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>PythonOperator</code></td>
                                <td>×”×¨×¦×ª ×¤×•× ×§×¦×™×™×ª Python</td>
                                <td>Business logic</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>PostgresOperator</code></td>
                                <td>×”×¨×¦×ª SQL query</td>
                                <td>Database operations</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>EmailOperator</code></td>
                                <td>×©×œ×™×—×ª ××™××™×™×œ</td>
                                <td>Notifications</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>SimpleHttpOperator</code></td>
                                <td>×§×¨×™××ª HTTP/API</td>
                                <td>API integration</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>FileSensor</code></td>
                                <td>×”××ª× ×” ×œ×§×•×‘×¥</td>
                                <td>File dependencies</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>BranchPythonOperator</code></td>
                                <td>×”×ª× ××” ×•×”×¡×ª×¢×¤×•×ª</td>
                                <td>Conditional logic</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>DummyOperator</code></td>
                                <td>Placeholder (×œ× ×¢×•×©×” ×›×œ×•×)</td>
                                <td>Organization</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2 style="margin-top: 40px;">ğŸ”€ Trigger Rules</h2>
                    <table class="reference-table">
                        <thead>
                            <tr>
                                <th style="text-align: left; direction: ltr;">Trigger Rule</th>
                                <th>××ª×™ Task ×¨×¥?</th>
                                <th>×©×™××•×©</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>all_success</code></td>
                                <td>×›×œ ×”-upstream tasks ×”×¦×œ×™×—×• (default)</td>
                                <td>×¨×•×‘ ×”××§×¨×™×</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>all_failed</code></td>
                                <td>×›×œ ×”-upstream tasks × ×›×©×œ×•</td>
                                <td>Error handlers</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>one_failed</code></td>
                                <td>×œ×¤×—×•×ª ××—×“ × ×›×©×œ</td>
                                <td>Alert tasks</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>one_success</code></td>
                                <td>×œ×¤×—×•×ª ××—×“ ×”×¦×œ×™×—</td>
                                <td>Join patterns</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>none_failed</code></td>
                                <td>××£ ××—×“ ×œ× × ×›×©×œ (success ××• skipped)</td>
                                <td>Cleanup tasks</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>none_failed_min_one_success</code></td>
                                <td>××£ ××—×“ ×œ× × ×›×©×œ ×•×œ×¤×—×•×ª ××—×“ ×”×¦×œ×™×—</td>
                                <td>Branching joins</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>all_done</code></td>
                                <td>×›×•×œ× ×”×¡×ª×™×™××• (×œ× ××©× ×” ××™×š)</td>
                                <td>Final cleanup</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2 style="margin-top: 40px;">â° Schedule Intervals</h2>
                    <table class="reference-table">
                        <thead>
                            <tr>
                                <th style="text-align: left; direction: ltr;">Preset</th>
                                <th>×ª×™××•×¨</th>
                                <th>Cron Expression</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>@once</code></td>
                                <td>×¤×¢× ××—×ª</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>@hourly</code></td>
                                <td>×›×œ ×©×¢×”</td>
                                <td><code>0 * * * *</code></td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>@daily</code></td>
                                <td>×›×œ ×™×•× (×—×¦×•×ª)</td>
                                <td><code>0 0 * * *</code></td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>@weekly</code></td>
                                <td>×›×œ ×©×‘×•×¢ (×¨××©×•×Ÿ ×—×¦×•×ª)</td>
                                <td><code>0 0 * * 0</code></td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>@monthly</code></td>
                                <td>×›×œ ×—×•×“×© (1 ×‘×—×•×“×© ×—×¦×•×ª)</td>
                                <td><code>0 0 1 * *</code></td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>@yearly</code></td>
                                <td>×›×œ ×©× ×” (1 ×‘×™× ×•××¨ ×—×¦×•×ª)</td>
                                <td><code>0 0 1 1 *</code></td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>timedelta(hours=3)</code></td>
                                <td>×›×œ 3 ×©×¢×•×ª</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>"0 8 * * *"</code></td>
                                <td>×›×œ ×™×•× ×‘-8 ×‘×‘×•×§×¨</td>
                                <td>Custom cron</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>"0 8 * * 1-5"</code></td>
                                <td>×™××™ ×—×•×œ ×‘-8 ×‘×‘×•×§×¨</td>
                                <td>Business days</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 style="margin-top: 25px;">Cron Format:</h3>
                    <div class="info-card">
                        <div class="code-block"># Format: minute hour day month day_of_week
# Example:
#   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ minute (0-59)
#   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ hour (0-23)
#   â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ day of month (1-31)
#   â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ month (1-12)
#   â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ day of week (0-6) (Sunday=0)
#   â”‚ â”‚ â”‚ â”‚ â”‚
#   * * * * *

# Examples:
"0 8 * * *"      # Every day at 8:00 AM
"0 8 * * 1-5"    # Weekdays at 8:00 AM
"0 */2 * * *"    # Every 2 hours
"30 7 1 * *"     # 7:30 AM on 1st of every month
"0 0 * * 0"      # Every Sunday at midnight</div>
                    </div>

                    <h2 style="margin-top: 40px;">ğŸ“… Jinja Template Variables</h2>
                    <table class="reference-table">
                        <thead>
                            <tr>
                                <th style="text-align: left; direction: ltr;">Variable</th>
                                <th>×ª×™××•×¨</th>
                                <th>×“×•×’××”</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ ds }}</code></td>
                                <td>Execution date (YYYY-MM-DD)</td>
                                <td>2024-01-15</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ ds_nodash }}</code></td>
                                <td>Execution date ×œ×œ× ××§×¤×™×</td>
                                <td>20240115</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ prev_ds }}</code></td>
                                <td>Previous execution date</td>
                                <td>2024-01-14</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ next_ds }}</code></td>
                                <td>Next execution date</td>
                                <td>2024-01-16</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ dag }}</code></td>
                                <td>DAG object</td>
                                <td>{{ dag.dag_id }}</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ task }}</code></td>
                                <td>Task object</td>
                                <td>{{ task.task_id }}</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ ti }}</code></td>
                                <td>TaskInstance</td>
                                <td>{{ ti.xcom_pull(...) }}</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ execution_date }}</code></td>
                                <td>Execution datetime</td>
                                <td>datetime object</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ macros.ds_add(ds, 7) }}</code></td>
                                <td>×”×•×¡×¤×ª ×™××™×</td>
                                <td>2024-01-22</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>{{ macros.datetime }}</code></td>
                                <td>Python datetime module</td>
                                <td>datetime functions</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2 style="margin-top: 40px;">ğŸ”§ DAG Parameters ×—×©×•×‘×™×</h2>
                    <table class="reference-table">
                        <thead>
                            <tr>
                                <th style="text-align: left; direction: ltr;">Parameter</th>
                                <th>×ª×™××•×¨</th>
                                <th>×‘×¨×™×¨×ª ××—×“×œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>dag_id</code></td>
                                <td>××–×”×” ×™×™×—×•×“×™ ×©×œ DAG</td>
                                <td>required</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>schedule_interval</code></td>
                                <td>×ª×“×™×¨×•×ª ×”×¨×¦×”</td>
                                <td>None</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>start_date</code></td>
                                <td>×ª××¨×™×š ×”×ª×—×œ×”</td>
                                <td>required</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>catchup</code></td>
                                <td>×”×¨×¦×ª backfill ××•×˜×•××˜×™</td>
                                <td>True</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>max_active_runs</code></td>
                                <td>××§×¡×™××•× ×”×¨×¦×•×ª ×‘××§×‘×™×œ</td>
                                <td>16</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>concurrency</code></td>
                                <td>××§×¡×™××•× tasks ×‘××§×‘×™×œ</td>
                                <td>16</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>default_args</code></td>
                                <td>×”×’×“×¨×•×ª ×‘×¨×™×¨×ª ××—×“×œ ×œtasks</td>
                                <td>{}</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>tags</code></td>
                                <td>×ª×’×™×•×ª ×œ××¨×’×•×Ÿ</td>
                                <td>[]</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2 style="margin-top: 40px;">âš™ï¸ Task Parameters ×—×©×•×‘×™×</h2>
                    <table class="reference-table">
                        <thead>
                            <tr>
                                <th style="text-align: left; direction: ltr;">Parameter</th>
                                <th>×ª×™××•×¨</th>
                                <th>×‘×¨×™×¨×ª ××—×“×œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>task_id</code></td>
                                <td>××–×”×” ×™×™×—×•×“×™ ×©×œ Task</td>
                                <td>required</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>retries</code></td>
                                <td>××¡×¤×¨ × ×™×¡×™×•× ×•×ª ×—×•×–×¨×™×</td>
                                <td>0</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>retry_delay</code></td>
                                <td>×–××Ÿ ×”××ª× ×” ×‘×™×Ÿ retries</td>
                                <td>timedelta(minutes=5)</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>execution_timeout</code></td>
                                <td>×–××Ÿ ××§×¡×™××œ×™ ×œ×‘×™×¦×•×¢</td>
                                <td>None</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>trigger_rule</code></td>
                                <td>×ª× ××™ ×œ×”×¤×¢×œ×ª Task</td>
                                <td>all_success</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>pool</code></td>
                                <td>Pool ×œ×”×’×‘×œ×ª ××©××‘×™×</td>
                                <td>default_pool</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>queue</code></td>
                                <td>Queue ×œ-CeleryExecutor</td>
                                <td>default</td>
                            </tr>
                            <tr>
                                <td style="direction: ltr; text-align: left;"><code>depends_on_past</code></td>
                                <td>×ª×œ×•×ª ×‘×”×¨×¦×” ×§×•×“××ª</td>
                                <td>False</td>
                            </tr>
                        </tbody>
                    </table>

                    <h2 style="margin-top: 40px;">ğŸ¨ ×“×•×’×××•×ª ××”×™×¨×•×ª</h2>

                    <h3>DAG ×‘×¡×™×¡×™:</h3>
                    <div class="code-block">from airflow import DAG
from airflow.operators.bash import BashOperator
from datetime import datetime, timedelta

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
    'retries': 1,
}

dag = DAG(
    'my_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
)

task = BashOperator(
    task_id='my_task',
    bash_command='echo "Hello"',
    dag=dag,
)</div>

                    <h3>×ª×œ×•×™×•×ª:</h3>
                    <div class="code-block"># Linear
task1 >> task2 >> task3

# Parallel
task1 >> [task2, task3] >> task4

# Multiple dependencies
[task1, task2] >> task3 >> [task4, task5]

# set_upstream / set_downstream
task2.set_upstream(task1)
task3.set_downstream(task4)</div>

                    <h3>XCom:</h3>
                    <div class="code-block"># Push
context['ti'].xcom_push(key='my_key', value=42)

# ××• return
return 42  # auto-pushed as 'return_value'

# Pull
value = context['ti'].xcom_pull(
    task_ids='other_task',
    key='return_value'  # or specific key
)</div>

                    <h3>Connections:</h3>
                    <div class="code-block"># In code
from airflow.providers.postgres.hooks.postgres import PostgresHook

hook = PostgresHook(postgres_conn_id='my_postgres')

# CLI
airflow connections add 'my_postgres' \
    --conn-type 'postgres' \
    --conn-host 'localhost' \
    --conn-schema 'mydb' \
    --conn-login 'user' \
    --conn-password 'pass'</div>

                    <h3>Variables:</h3>
                    <div class="code-block"># In code
from airflow.models import Variable

api_key = Variable.get("api_key")
config = Variable.get("my_config", deserialize_json=True)

# Set variable
Variable.set("my_key", "my_value")

# CLI
airflow variables set my_key my_value
airflow variables get my_key</div>
                </div>

                <!-- Best Practices -->
                <div id="section-best-practices" class="theory-section">
                    <h1>âœ¨ Best Practices ×œ-Apache Airflow</h1>

                    <h2>ğŸ¯ ×ª×›× ×•×Ÿ DAGs</h2>
                    <div class="success-card">
                        <h4>×¢×§×¨×•× ×•×ª ×‘×¡×™×¡×™×™×:</h4>
                        <ul>
                            <li><strong>Idempotency</strong> - ×›×œ task ×¦×¨×™×š ×œ×”×™×•×ª idempotent (×”×¨×¦×” ××¡×¤×¨ ×¤×¢××™× = ×ª×•×¦××” ×–×”×”)</li>
                            <li><strong>Atomicity</strong> - ×›×œ task ×¦×¨×™×š ×œ×¢×©×•×ª ×“×‘×¨ ××—×“ ×˜×•×‘ (Single Responsibility)</li>
                            <li><strong>Deterministic</strong> - ××•×ª×” input = ××•×ª×” output ×ª××™×“</li>
                            <li><strong>Independent</strong> - tasks ×œ× ×ª×œ×•×™×™× ×‘state ×—×™×¦×•× ×™ ××©×ª× ×”</li>
                        </ul>
                    </div>

                    <h2>ğŸ“ ×›×ª×™×‘×ª ×§×•×“</h2>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>âœ… DO - ×¢×©×”</h4>
                            <ul style="font-size: 0.9rem;">
                                <li>×”×©×ª××© ×‘-Variables ×œconfig</li>
                                <li>×”×’×“×¨ timeouts ×œtasks</li>
                                <li>×”×•×¡×£ retries ×œtasks ×©×™×›×•×œ×™× ×œ×”×™×›×©×œ</li>
                                <li>×”×©×ª××© ×‘-execution_date ×œ× ×‘-datetime.now()</li>
                                <li>×©××•×¨ credentials ×‘-Connections</li>
                                <li>×ª×¢×“ ××ª ×”DAGs ×©×œ×š (docstring)</li>
                                <li>×”×©×ª××© ×‘-Tags ×œ××¨×’×•×Ÿ</li>
                                <li>×”×’×“×¨ SLAs ×œtasks ×§×¨×™×˜×™×™×</li>
                            </ul>
                        </div>

                        <div class="comparison-card">
                            <h4>âŒ DON'T - ××œ ×ª×¢×©×”</h4>
                            <ul style="font-size: 0.9rem;">
                                <li>âŒ datetime.now() - ×œ× ×“×˜×¨××™× ×™×¡×˜×™!</li>
                                <li>âŒ Credentials ×‘×§×•×“ - ×¡×›× ×ª ××‘×˜×—×”!</li>
                                <li>âŒ XCom ×œ×“××˜×” ×’×“×•×œ×” - ×™×’×¨×•× ×œ×‘×¢×™×•×ª!</li>
                                <li>âŒ Top-level code - ×¨×¥ ×‘×›×œ import!</li>
                                <li>âŒ Global variables - ×‘×¢×™×•×ª concurrency!</li>
                                <li>âŒ print() ×‘×œ×‘×“ - ×”×©×ª××© ×‘-logging!</li>
                            </ul>
                        </div>
                    </div>

                    <h2>ğŸ’¡ ×“×•×’×××•×ª ×§×•×“ ×˜×•×‘ vs ×¨×¢</h2>
                    <div class="info-card">
                        <h4>â° ×ª××¨×™×›×™× ×•×©×¢×•×ª</h4>
                        <div class="code-block"># âŒ ×’×¨×•×¢ - ×œ× ×“×˜×¨××™× ×™×¡×˜×™
from datetime import datetime
today = datetime.now()  # ×¢×¨×š ×©×•× ×” ×‘×›×œ ×”×¨×¦×”!

# âœ… ×˜×•×‘ - ×“×˜×¨××™× ×™×¡×˜×™
def my_function(**context):
    execution_date = context['execution_date']  # ×ª××™×“ ××•×ª×• ×¢×¨×š ×œ×”×¨×¦×” ×¡×¤×¦×™×¤×™×ª
    ds = context['ds']  # 'YYYY-MM-DD' string</div>

                        <h4 style="margin-top: 25px;">ğŸ”‘ Credentials</h4>
                        <div class="code-block"># âŒ ×’×¨×•×¢ - hardcoded
password = "my_secret_password"
hook = PostgresHook(password=password)

# âœ… ×˜×•×‘ - Connection
hook = PostgresHook(postgres_conn_id='my_postgres')  # credentials in Airflow UI

# âœ… ×¢×•×“ ×™×•×ª×¨ ×˜×•×‘ - Secrets Backend
# airflow.cfg:
# [secrets]
# backend = airflow.providers.amazon.aws.secrets.secrets_manager.SecretsManagerBackend</div>

                        <h4 style="margin-top: 25px;">ğŸ“Š XCom Usage</h4>
                        <div class="code-block"># âŒ ×’×¨×•×¢ - DataFrame ×’×“×•×œ ×‘-XCom
def process():
    df = pd.read_csv('large_file.csv')  # 1GB
    return df  # âŒ ×™×’×¨×•× ×œ×‘×¢×™×•×ª!

# âœ… ×˜×•×‘ - ×©××•×¨ ×§×•×‘×¥, ×”×¢×‘×¨ path
def process():
    df = pd.read_csv('large_file.csv')
    output_path = '/tmp/processed.parquet'
    df.to_parquet(output_path)
    return output_path  # âœ… ×¨×§ string ×§×˜×Ÿ!</div>

                        <h4 style="margin-top: 25px;">ğŸ”„ Top-level Code</h4>
                        <div class="code-block"># âŒ ×’×¨×•×¢ - ×¨×¥ ×‘×›×œ import (×›×œ 30 ×©× ×™×•×ª!)
import pandas as pd

# ×§×•×“ ×™×§×¨ ×©×¨×¥ ×‘×›×œ ×¤×¢×
df = pd.read_csv('/data/large.csv')  # âŒ ×¨×¥ ×›×œ 30 ×©× ×™×•×ª!
CONSTANT = df['value'].sum()

dag = DAG(...)

# âœ… ×˜×•×‘ - ×¨×§ ×‘×ª×•×š tasks
dag = DAG(...)

def process_data():
    df = pd.read_csv('/data/large.csv')  # âœ… ×¨×§ ×›×©×”task ×¨×¥!
    return df['value'].sum()</div>
                    </div>

                    <h2>ğŸ—ï¸ ××¨×›×™×˜×§×˜×•×¨×”</h2>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>ğŸ”§ Development</h4>
                            <p><strong>Executor:</strong> SequentialExecutor</p>
                            <p><strong>DB:</strong> SQLite</p>
                            <p><strong>Setup:</strong> ××”×™×¨ ×•×¤×©×•×˜</p>
                        </div>
                        <div class="comparison-card">
                            <h4>ğŸ¢ Small Production</h4>
                            <p><strong>Executor:</strong> LocalExecutor</p>
                            <p><strong>DB:</strong> PostgreSQL/MySQL</p>
                            <p><strong>Setup:</strong> Machine ××—×ª ×—×–×§×”</p>
                        </div>
                        <div class="comparison-card">
                            <h4>ğŸŒ Large Production</h4>
                            <p><strong>Executor:</strong> CeleryExecutor</p>
                            <p><strong>DB:</strong> PostgreSQL</p>
                            <p><strong>Setup:</strong> Cluster + Broker</p>
                        </div>
                    </div>

                    <h2>ğŸ“Š Monitoring & Alerting</h2>
                    <div class="success-card">
                        <h4>××” ×œ× ×˜×¨?</h4>
                        <ul>
                            <li><strong>DAG duration</strong> - ×›××” ×–××Ÿ ×œ×•×§×— ×œDAG ×œ×”×¡×ª×™×™×</li>
                            <li><strong>Task failures</strong> - ××™×œ×• tasks × ×›×©×œ×™× (trends)</li>
                            <li><strong>Queue size</strong> - ×›××” tasks ×××ª×™× ×™× (bottleneck?)</li>
                            <li><strong>Resource usage</strong> - CPU, Memory, Disk</li>
                            <li><strong>SLA misses</strong> - ×”×× ×¢×•××“×™× ×‘×–×× ×™×</li>
                            <li><strong>Scheduler health</strong> - heartbeat, parsing time</li>
                        </ul>
                    </div>

                    <h3>×“×•×’××ª SLA</h3>
                    <div class="code-block">from datetime import timedelta

def sla_miss_callback(dag, task_list, blocking_task_list, slas, blocking_tis):
    """Callback when SLA is missed"""
    print(f"SLA missed for: {task_list}")
    # Send alert to Slack/Email

default_args = {
    'sla': timedelta(hours=2),  # Task ×¦×¨×™×š ×œ×”×¡×ª×™×™× ×ª×•×š 2 ×©×¢×•×ª
    'sla_miss_callback': sla_miss_callback,
}

dag = DAG(
    'my_dag',
    default_args=default_args,
    ...
)</div>

                    <h2>ğŸ”§ ××•×¤×˜×™××™×–×¦×™×”</h2>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>âš¡ Performance</h4>
                            <ul style="font-size: 0.9rem;">
                                <li><strong>Pools:</strong> ×”×’×‘×œ ×’×™×©×” ×œ××©××‘×™×</li>
                                <li><strong>Parallelism:</strong> ×”×’×“×¨ × ×›×•×Ÿ</li>
                                <li><strong>catchup=False:</strong> ××œ ×ª×¨×™×¥ ×”×™×¡×˜×•×¨×™×”</li>
                                <li><strong>Clean old data:</strong> db clean</li>
                                <li><strong>Use Sensors wisely:</strong> poke_interval, timeout</li>
                            </ul>
                        </div>

                        <div class="comparison-card">
                            <h4>ğŸ’° Cost Optimization</h4>
                            <ul style="font-size: 0.9rem;">
                                <li>×”×¨×¥ tasks ×›×‘×“×™× off-peak</li>
                                <li>Spot instances ×œworkers</li>
                                <li>Scale down ×‘×œ×™×œ×”/×¡×•×¤"×©</li>
                                <li>Kubernetes Executor - scale to 0</li>
                                <li>Pool limits ×œ×× ×™×¢×ª over-usage</li>
                            </ul>
                        </div>
                    </div>

                    <h2>ğŸ”’ Security Best Practices</h2>
                    <div class="warning-card">
                        <h4>âš ï¸ ××‘×˜×—×” ×§×¨×™×˜×™×ª:</h4>
                        <ul>
                            <li><strong>RBAC:</strong> ×”×¤×¢×œ Role-Based Access Control</li>
                            <li><strong>Fernet Key:</strong> ×”×¦×¤×Ÿ sensitive data</li>
                            <li><strong>Secrets Backend:</strong> AWS Secrets Manager, HashiCorp Vault</li>
                            <li><strong>Network:</strong> ×”×’×‘×œ ×’×™×©×” ×œ-UI (VPN, IP whitelist)</li>
                            <li><strong>Authentication:</strong> LDAP, OAuth, Google Auth</li>
                            <li><strong>Audit Logs:</strong> ×¢×§×•×‘ ××—×¨ ××™ ×¢×©×” ××”</li>
                        </ul>
                    </div>

                    <h3>×”×’×“×¨×ª Fernet Key</h3>
                    <div class="code-block"># Generate Fernet key
from cryptography.fernet import Fernet

fernet_key = Fernet.generate_key()
print(fernet_key.decode())

# Add to airflow.cfg
# [core]
# fernet_key = YOUR_KEY_HERE</div>

                    <h2>ğŸ“ ××¨×’×•×Ÿ ×§×•×“</h2>
                    <div class="success-card">
                        <h4>âœ… ××‘× ×” ×ª×™×§×™×•×ª ××•××œ×¥:</h4>
                        <div class="code-block">airflow_project/
â”œâ”€â”€ dags/
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ utils.py         # ×¤×•× ×§×¦×™×•×ª ××©×•×ª×¤×•×ª
â”‚   â”‚   â””â”€â”€ config.py        # ×”×’×“×¨×•×ª
â”‚   â”œâ”€â”€ etl/
â”‚   â”‚   â”œâ”€â”€ daily_sales.py
â”‚   â”‚   â””â”€â”€ weekly_report.py
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ sync_users.py
â”‚   â””â”€â”€ monitoring/
â”‚       â””â”€â”€ health_checks.py
â”œâ”€â”€ plugins/
â”‚   â””â”€â”€ custom_operators/
â”‚       â””â”€â”€ my_operator.py
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ dags/
â”‚       â””â”€â”€ test_daily_sales.py
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ connections.json
â”‚   â””â”€â”€ variables.json
â””â”€â”€ requirements.txt</div>
                    </div>

                    <h2>ğŸ§ª Testing</h2>
                    <div class="info-card">
                        <h4>×¡×•×’×™ Tests:</h4>

                        <h5 style="margin-top: 20px;">1. Syntax Check</h5>
                        <div class="code-block"># ×¤×©×•×˜ ×”×¨×¥ ××ª ×”×§×•×‘×¥
python dags/my_dag.py

# ×× ×™×© ×©×’×™××”, ×”×™× ×ª×•×¤×™×¢</div>

                        <h5 style="margin-top: 20px;">2. DAG Validation</h5>
                        <div class="code-block">import pytest
from airflow.models import DagBag

def test_dag_loaded():
    """Test that DAG loads without errors"""
    dagbag = DagBag(dag_folder='dags/', include_examples=False)
    assert len(dagbag.import_errors) == 0, f"Errors: {dagbag.import_errors}"

def test_dag_has_tags():
    """Test that DAG has required tags"""
    dagbag = DagBag()
    dag = dagbag.get_dag('my_dag')
    assert 'production' in dag.tags</div>

                        <h5 style="margin-top: 20px;">3. Task Testing</h5>
                        <div class="code-block"># Test individual task
airflow tasks test my_dag my_task 2024-01-01

# Test with pytest
def test_task_logic():
    """Test task business logic"""
    result = my_task_function(test_data)
    assert result == expected_output</div>
                    </div>

                    <h2>ğŸ”§ ××•×¤×˜×™××™×–×¦×™×” ××ª×§×“××ª</h2>
                    <div class="info-card">
                        <h4>Parallelism Settings:</h4>
                        <div class="code-block"># airflow.cfg optimizations

[core]
parallelism = 32                    # max tasks across all DAGs (globally)
dag_concurrency = 16                # max tasks per DAG
max_active_runs_per_dag = 3         # max concurrent DAG runs

[scheduler]
max_threads = 4                     # scheduler threads
parsing_processes = 2               # parallel DAG file parsing

# Per-DAG level
dag = DAG(
    'my_dag',
    max_active_runs=5,              # override global setting
    concurrency=20,                 # max tasks for this DAG
    ...
)</div>

                        <h4 style="margin-top: 25px;">Pool Configuration:</h4>
                        <div class="code-block"># Create pool in UI or CLI
# Admin â†’ Pools â†’ Add

# Or via CLI:
airflow pools set database_pool 10 "Database connections"

# Use in DAG
task = PythonOperator(
    task_id='query_db',
    python_callable=my_func,
    pool='database_pool',  # Max 10 tasks can use DB
    pool_slots=1,          # This task uses 1 slot
    dag=dag,
)</div>

                        <h4 style="margin-top: 25px;">Queue Management (CeleryExecutor):</h4>
                        <div class="code-block"># Send heavy tasks to dedicated queue
heavy_task = BashOperator(
    task_id='process_big_data',
    bash_command='python heavy_job.py',
    queue='heavy_queue',  # Goes to heavy workers
    dag=dag,
)

# Start worker for specific queue
airflow celery worker -q heavy_queue</div>
                    </div>

                    <h2>ğŸ”’ Security & Compliance</h2>
                    <div class="warning-card">
                        <h4>âš ï¸ Production Security Checklist:</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li>â˜ <strong>RBAC Enabled:</strong> Role-based access control</li>
                            <li>â˜ <strong>Fernet Key:</strong> ×¡×™×¡×××•×ª ××•×¦×¤× ×•×ª ×‘-DB</li>
                            <li>â˜ <strong>Secrets Backend:</strong> AWS/GCP/Vault ×œ××™×“×¢ ×¨×’×™×©</li>
                            <li>â˜ <strong>Authentication:</strong> LDAP/OAuth/SAML</li>
                            <li>â˜ <strong>SSL/TLS:</strong> ×—×™×‘×•×¨×™× ×××•×‘×˜×—×™×</li>
                            <li>â˜ <strong>Network Security:</strong> Firewall, VPN</li>
                            <li>â˜ <strong>Audit Logs:</strong> ××¢×§×‘ ××—×¨ ×¤×¢×™×œ×•×ª</li>
                            <li>â˜ <strong>Regular Updates:</strong> ×¢×“×›×•× ×™ ××‘×˜×—×”</li>
                        </ul>
                    </div>

                    <h2>ğŸ“š ×œ××™×“×” ×•×”×ª×¤×ª×—×•×ª</h2>
                    <div class="info-card">
                        <h4>××©××‘×™× ××•××œ×¦×™×:</h4>
                        <ul>
                            <li><strong>Documentation:</strong> <a href="https://airflow.apache.org" target="_blank">airflow.apache.org</a></li>
                            <li><strong>Community:</strong> Apache Airflow Slack channel</li>
                            <li><strong>GitHub:</strong> github.com/apache/airflow - issues & discussions</li>
                            <li><strong>Astronomer:</strong> astronomer.io/blog - best practices</li>
                            <li><strong>YouTube:</strong> Airflow Summit talks</li>
                            <li><strong>Books:</strong> "Data Pipelines with Apache Airflow"</li>
                        </ul>
                    </div>

                    <h2>ğŸ¯ Production Checklist ×¡×•×¤×™</h2>
                    <div class="success-card">
                        <h4>×œ×¤× ×™ Deploy ×œ×¤×¨×•×“×§×©×Ÿ:</h4>
                        <ul style="list-style: none; padding: 0; font-size: 1.05rem;">
                            <li>â˜ <strong>Executor:</strong> LocalExecutor ××• CeleryExecutor</li>
                            <li>â˜ <strong>Database:</strong> PostgreSQL/MySQL (×œ× SQLite!)</li>
                            <li>â˜ <strong>Connections:</strong> ×›×œ ×”-Connections ××•×’×“×¨×™×</li>
                            <li>â˜ <strong>Variables:</strong> ×›×œ ×”-Variables ××•×’×“×¨×™×</li>
                            <li>â˜ <strong>Error Handling:</strong> try/except + logging</li>
                            <li>â˜ <strong>Retries:</strong> ××•×’×“×¨×™× ×œtasks ×©×™×›×•×œ×™× ×œ×”×™×›×©×œ</li>
                            <li>â˜ <strong>Email Alerts:</strong> email_on_failure=True</li>
                            <li>â˜ <strong>SLAs:</strong> ××•×’×“×¨×™× ×œtasks ×§×¨×™×˜×™×™×</li>
                            <li>â˜ <strong>Testing:</strong> ×›×œ ×”DAGs × ×‘×“×§×•</li>
                            <li>â˜ <strong>Documentation:</strong> README + ×”×¢×¨×•×ª ×‘×§×•×“</li>
                            <li>â˜ <strong>Security:</strong> RBAC, Fernet, Secrets Backend</li>
                            <li>â˜ <strong>Monitoring:</strong> ××•×’×“×¨×™× dashboards ×•-alerts</li>
                            <li>â˜ <strong>Backup:</strong> ×ª×•×›× ×™×ª backup ×œ-DB</li>
                            <li>â˜ <strong>Scaling:</strong> ×ª×•×›× ×™×ª scaling (Pools, Resources)</li>
                        </ul>
                    </div>

                    <h2>ğŸ“ Design Patterns × ×¤×•×¦×™×</h2>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>ğŸŒ³ Fan-Out Pattern</h4>
                            <p>Task ××—×“ â†’ Tasks ××¨×•×‘×™× ×‘××§×‘×™×œ</p>
                            <div class="code-block" style="font-size: 0.75rem; margin-top: 10px;">start >> [task1, task2, task3]</div>
                        </div>
                        <div class="comparison-card">
                            <h4>ğŸ”€ Fan-In Pattern</h4>
                            <p>Tasks ××¨×•×‘×™× â†’ Task ××—×“ ××¡×›×</p>
                            <div class="code-block" style="font-size: 0.75rem; margin-top: 10px;">[task1, task2, task3] >> end</div>
                        </div>
                        <div class="comparison-card">
                            <h4>ğŸ”„ Error Handling Pattern</h4>
                            <p>Task â†’ Success/Failure handlers</p>
                            <div class="code-block" style="font-size: 0.75rem; margin-top: 10px;">task >> [on_success, on_failure]
# ×¢× trigger_rules</div>
                        </div>
                        <div class="comparison-card">
                            <h4>ğŸ“¦ Staging Pattern</h4>
                            <p>Extract â†’ Transform â†’ Load</p>
                            <div class="code-block" style="font-size: 0.75rem; margin-top: 10px;">extract >> transform >> load</div>
                        </div>
                    </div>
                </div>

            </main>
        </div>
    </div>


    <!-- INSTALLATION VIEW - ×”×˜××‘ ×”×—×“×©! -->
    <div id="view-installation" class="view-section">
        <div class="theory-content" style="max-width: 1200px; margin: 0 auto;">
            <h1>ğŸš€ ×”×ª×§× ×ª Apache Airflow ×¢× Docker Compose</h1>

            <div class="info-card">
                <h3>×œ××” Docker Compose?</h3>
                <p>Docker Compose ×××¤×©×¨ ×œ×”×§×™× ××ª Airflow ×¢× ×›×œ ×”×¨×›×™×‘×™× ×”× ×“×¨×©×™× (scheduler, webserver, database, redis) ×‘×§×œ×•×ª ×•×‘××”×™×¨×•×ª.</p>
                <p>×–×”×• ×”×“×¨×š ×”××•××œ×¦×ª ×œ×”×ª×§× ×” ××§×•××™×ª ×•×œ×¤×™×ª×•×—.</p>
            </div>

            <h2 style="font-size: 1.8rem; margin: 40px 0 25px 0; color: var(--airflow-primary);">×©×™×˜×” 1: ×©×™××•×© ×‘-CDE Docker Compose (××•××œ×¥)</h2>

            <div class="step-card">
                <h3><span class="step-number">1.</span>×”×¨×¦×ª Docker Compose</h3>
                <p>×”×¨×¥ ××ª ×”×¤×§×•×“×” ×”×‘××” ×‘×ª×™×§×™×™×ª ×”×¤×¨×•×™×§×˜:</p>
                <div class="code-block">docker compose up -d</div>
                <p><strong>×”×¢×¨×”:</strong> ×× ×›×‘×¨ ×”×¨×¦×ª ××ª ×”×¤×§×•×“×” ×‘×©×™×¢×•×¨×™× ×§×•×“××™×, ××™×Ÿ ×¦×•×¨×š ×œ×”×¨×™×¥ ×©×•×‘.</p>
            </div>

            <div class="step-card">
                <h3><span class="step-number">2.</span>×‘×“×™×§×” ×©-Airflow ×¨×¥</h3>
                <p>×¤×ª×— ××ª <strong>Docker Desktop</strong> ×•×—×¤×© ××ª ×”×§×•× ×˜×™×™× ×¨×™× ×”×‘××™×:</p>
                <ul style="padding-right: 30px; margin: 15px 0;">
                    <li><code>airflow_scheduler</code> - ×”××ª×–××Ÿ ×©××¨×™×¥ tasks</li>
                    <li><code>airflow_webserver</code> - ×××©×§ ×”××©×ª××©</li>
                </ul>
                <p>×‘× ×•×¡×£, ×‘×“×•×§ ×©× ×•×¦×¨×• 2 ×ª×™×§×™×•×ª ×—×“×©×•×ª ×‘×¤×¨×•×™×§×˜:</p>
                <ul style="padding-right: 30px; margin: 15px 0;">
                    <li><code>airflow-data</code> - × ×ª×•× ×™ Airflow</li>
                    <li><code>dags</code> - ×›××Ÿ ×ª×©×™× ××ª ×§×‘×¦×™ ×”-DAG ×©×œ×š</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><span class="step-number">3.</span>×’×™×©×” ×œ×××©×§ ×”××©×ª××©</h3>
                <p>×¤×ª×— ×“×¤×“×¤×Ÿ ×•×’×© ×œ×›×ª×•×‘×ª:</p>
                <div class="code-block">http://localhost:8080</div>
                <p>×”×ª×—×‘×¨ ×¢× ×”×¤×¨×˜×™× ×”×‘××™×:</p>
                <ul style="padding-right: 30px; margin: 15px 0;">
                    <li><strong>×©× ××©×ª××©:</strong> <code>airflow</code></li>
                    <li><strong>×¡×™×¡××”:</strong> <code>airflow</code></li>
                </ul>
            </div>

            <div class="success-card">
                <h4 style="margin: 0 0 12px 0;">âœ… ×¡×™×™××ª! Airflow ×¨×¥ ×‘××¢×¨×›×ª ×©×œ×š</h4>
                <p style="margin: 0;">××ª×” ×™×›×•×œ ×¢×›×©×™×• ×œ×”×ª×—×™×œ ×œ×™×¦×•×¨ DAGs ×‘×ª×™×§×™×™×” <code>./dags</code></p>
            </div>

            <h2 style="font-size: 1.8rem; margin: 40px 0 25px 0; color: var(--airflow-primary);">×©×™×˜×” 2: ×”×ª×§× ×” ×™×“× ×™×ª ××œ××”</h2>

            <div class="step-card">
                <h3><span class="step-number">1.</span>×”×’×“×¨×ª ×ª×™×§×™×•×ª ×•×¡×‘×™×‘×”</h3>
                <p>×¦×•×¨ ××ª ×”×ª×™×§×™×•×ª ×”× ×“×¨×©×•×ª ×•×”×’×“×¨ ××ª UID:</p>
                <div class="code-block">mkdir -p ./dags ./logs ./plugins ./config
echo -e "AIRFLOW_UID=$(id -u)" > .env</div>
            </div>

            <div class="step-card">
                <h3><span class="step-number">2.</span>××ª×—×•×œ Airflow</h3>
                <p>×”×¨×¥ ××ª ×ª×”×œ×™×š ×”××ª×—×•×œ ×©×™×•×¦×¨ ××ª ×‘×¡×™×¡ ×”× ×ª×•× ×™× ×•××©×ª××© Admin:</p>
                <div class="code-block">docker compose up airflow-init</div>
                <p>×”××ª×Ÿ ×¢×“ ×©×ª×¨××” ×”×•×“×¢×” ×“×•××” ×œ:</p>
                <div class="code-block">airflow-init_1       | Upgrades done
airflow-init_1       | Admin user airflow created
airflow-init_1       | 2.9.2
start airflow-init_1 | exited with code 0</div>
            </div>

            <div class="step-card">
                <h3><span class="step-number">3.</span>×”×¤×¢×œ×ª ×›×œ ×”Services</h3>
                <p>×”×¤×¢×œ ××ª ×›×œ ×¨×›×™×‘×™ Airflow:</p>
                <div class="code-block">docker compose up -d</div>
            </div>

            <div class="step-card">
                <h3><span class="step-number">4.</span>××™××•×ª Containers ×¨×¦×™×</h3>
                <p>×‘×“×•×§ ×©×›×œ ×”×§×•× ×˜×™×™× ×¨×™× ×¨×¦×™×:</p>
                <div class="code-block">docker ps</div>
                <p>×××•×¨ ×œ×¨××•×ª:</p>
                <ul style="padding-right: 30px; margin: 15px 0;">
                    <li><code>airflow-webserver</code> - port 8080</li>
                    <li><code>airflow-scheduler</code></li>
                    <li><code>airflow-worker</code></li>
                    <li><code>postgres</code> - port 5432</li>
                    <li><code>redis</code> - port 6379</li>
                </ul>
            </div>

            <div class="step-card">
                <h3><span class="step-number">5.</span>×’×™×©×” ×œ-UI</h3>
                <p>×¤×ª×— ×“×¤×“×¤×Ÿ ×•×’×© ×œ×›×ª×•×‘×ª:</p>
                <div class="code-block">http://localhost:8080</div>
                <p>×”×ª×—×‘×¨ ×¢×: <strong>airflow / airflow</strong></p>
            </div>

            <div class="success-card">
                <h4 style="margin: 0 0 12px 0;">ğŸ‰ ×”×ª×§× ×” ×”×•×©×œ××” ×‘×”×¦×œ×—×”!</h4>
                <p style="margin: 0;">×›×œ ×”×¨×›×™×‘×™× ×©×œ Airflow ×¨×¦×™× ×‘××¢×¨×›×ª ×©×œ×š ×¢× CeleryExecutor ××œ×.</p>
            </div>

            <h2 style="font-size: 1.8rem; margin: 40px 0 25px 0; color: var(--airflow-primary);">ğŸ› ï¸ ×¤×§×•×“×•×ª ×©×™××•×©×™×•×ª</h2>
            <div class="code-block"># ×¢×¦×•×¨ ××ª Airflow
docker compose down

# ×¢×¦×•×¨ ×•××—×§ volumes (× ×ª×•× ×™×)
docker compose down --volumes

# ×”×¦×’ ×œ×•×’×™× ×©×œ service ××¡×•×™×
docker compose logs webserver
docker compose logs scheduler

# ×”×¨×¥ ×¤×§×•×“×ª Airflow CLI
docker compose run airflow-worker airflow dags list

# ×›× ×™×¡×” ×œ×§×•× ×˜×™×™× ×¨
docker exec -it &lt;container-id&gt; bash</div>

            <div class="warning-card">
                <h4 style="margin: 0 0 12px 0;">âš ï¸ ×©×™× ×œ×‘:</h4>
                <ul style="padding-right: 30px; margin: 15px 0;">
                    <li>×”-setup ×”×–×” ××©×ª××© ×‘-<strong>CeleryExecutor</strong> - ××ª××™× ×œ×¤×¨×•×“×§×©×Ÿ</li>
                    <li>×“×•×¨×© ×œ×¤×—×•×ª <strong>4GB RAM</strong> ×¤× ×•×™×™×</li>
                    <li>×•×•×“× ×©-Docker Desktop ×¨×¥ ×œ×¤× ×™ ×”×”×ª×§× ×”</li>
                    <li>×‘×¤×¢× ×”×¨××©×•× ×” ×”init ×™×›×•×œ ×œ×§×—×ª ××¡×¤×¨ ×“×§×•×ª</li>
                </ul>
            </div>

            <h2 style="font-size: 1.8rem; margin: 40px 0 25px 0; color: var(--airflow-primary);">ğŸ” ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª × ×¤×•×¦×•×ª</h2>

            <h3 style="font-size: 1.3rem; margin: 30px 0 18px 0; color: var(--airflow-secondary);">Port 8080 ×ª×¤×•×¡</h3>
            <p>×× ×”-port ×ª×¤×•×¡, ×©× ×” ×‘-<code>docker-compose.yaml</code>:</p>
            <div class="code-block">ports:
  - "8081:8080"  # ×©× ×” ×œ-8081 ××• ×›×œ port ×¤× ×•×™ ××—×¨</div>

            <h3 style="font-size: 1.3rem; margin: 30px 0 18px 0; color: var(--airflow-secondary);">Containers ×œ× ×¢×•×œ×™×</h3>
            <p>×‘×“×•×§ ×œ×•×’×™×:</p>
            <div class="code-block">docker compose logs</div>

            <h3 style="font-size: 1.3rem; margin: 30px 0 18px 0; color: var(--airflow-secondary);">××™×Ÿ ×”×¨×©××•×ª ×œ×ª×™×§×™×•×ª</h3>
            <p>×”×¨×¥:</p>
            <div class="code-block">sudo chown -R $(id -u):$(id -g) ./dags ./logs ./plugins</div>

            <div class="info-card">
                <h4 style="margin: 0 0 12px 0;">ğŸ“š ×¦×¢×“ ×”×‘×</h4>
                <p style="margin: 0;">×¢×›×©×™×• ×©Airflow ××•×ª×§×Ÿ, ×¢×‘×•×¨ ×œ×˜××‘ <strong>×ª×™××•×¨×™×”</strong> ×›×“×™ ×œ×œ××•×“ ××™×š ×œ×™×¦×•×¨ DAGs!</p>
            </div>
        </div>
    </div>

    <!-- === ARCHITECTURE VIEW === -->
    <div id="view-architecture" class="view-section">
        <div style="padding: 60px; max-width: 1400px; margin: 0 auto;">
            <h1 style="font-size: 2.5rem; margin-bottom: 40px; text-align: center;">ğŸ—ï¸ ××¨×›×™×˜×§×˜×•×¨×ª Airflow</h1>

            <p style="text-align: center; font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 50px;">
                Airflow ×ª×•××š ×‘-3 ××¦×‘×™ ××¨×›×™×˜×§×˜×•×¨×” ×©×•× ×™×, ×›×œ ××—×“ ×¢× ×™×ª×¨×•× ×•×ª ×•×—×¡×¨×•× ×•×ª
            </p>

            <div class="comparison-grid">
                <div class="comparison-card" style="border-top: 5px solid var(--text-tertiary);">
                    <h2 style="margin-top: 0;">1ï¸âƒ£ Sequential Executor</h2>
                    <p style="font-size: 0.95rem; color: var(--text-secondary); margin-bottom: 20px;">
                        ×”××¨×›×™×˜×§×˜×•×¨×” ×”×¤×©×•×˜×” ×‘×™×•×ª×¨ - ××¢×‘×“ ××©×™××” ××—×ª ×‘×›×œ ×¤×¢×
                    </p>

                    <h4 style="margin-top: 25px;">×××¤×™×™× ×™×:</h4>
                    <ul>
                        <li>××¨×™×¥ task ××—×“ ×‘×›×œ ×¤×¢× (××™×Ÿ parallelism)</li>
                        <li><strong>××¦×‘ ×‘×¨×™×¨×ª ××—×“×œ</strong></li>
                        <li>setup ××™× ×™××œ×™ - ×¢×•×‘×“ ×¢× SQLite</li>
                        <li><strong>×œ× ××•××œ×¥ ×œ×¤×¨×•×“×§×©×Ÿ</strong></li>
                    </ul>

                    <div class="warning-card" style="margin-top: 20px;">
                        <p><strong>âš ï¸ ×©×™××•×©:</strong> ×¨×§ ×œ×¤×™×ª×•×— ×•×‘×“×™×§×•×ª - ×œ× ×œ×¤×¨×•×“×§×©×Ÿ!</p>
                    </div>
                </div>

                <div class="comparison-card" style="border-top: 5px solid var(--airflow-secondary);">
                    <h2 style="margin-top: 0;">2ï¸âƒ£ Local Executor</h2>
                    <p style="font-size: 0.95rem; color: var(--text-secondary); margin-bottom: 20px;">
                        ××¨×™×¥ tasks ×‘××§×‘×™×œ ×¢×œ ××•×ª×” ×”××›×•× ×”
                    </p>

                    <h4 style="margin-top: 25px;">×××¤×™×™× ×™×:</h4>
                    <ul>
                        <li>Processes × ×•×¦×¨×™× ×¢×œ ×™×“×™ scheduler</li>
                        <li><strong>Scales vertically</strong> (×”×•×¡×¤×ª CPU/RAM)</li>
                        <li>×‘×¨××ª production</li>
                        <li>×œ× ×¦×¨×™×š broker (×›××• RabbitMQ)</li>
                        <li>××ª××™× ×œ×¤×¨×•×“×§×©×Ÿ ×›×©××™×Ÿ ×”×¨×‘×” DAGs</li>
                    </ul>

                    <div class="success-card" style="margin-top: 20px;">
                        <p><strong>âœ… ×©×™××•×©:</strong> ×¤×¨×•×“×§×©×Ÿ ×§×˜×Ÿ-×‘×™× ×•× ×™, machine ××—×ª</p>
                    </div>
                </div>

                <div class="comparison-card" style="border-top: 5px solid var(--airflow-green);">
                    <h2 style="margin-top: 0;">3ï¸âƒ£ Celery Executor</h2>
                    <p style="font-size: 0.95rem; color: var(--text-secondary); margin-bottom: 20px;">
                        ××¨×›×™×˜×§×˜×•×¨×” ××‘×•×–×¨×ª ×¢× workers ××¨×•×‘×™×
                    </p>

                    <h4 style="margin-top: 25px;">×××¤×™×™× ×™×:</h4>
                    <ul>
                        <li><strong>Vertical ×•Horizontal scalable</strong></li>
                        <li>× ×™×ª×Ÿ ×œ× ×™×˜×•×¨ (×“×¨×š Flower)</li>
                        <li>×‘×¨××ª production</li>
                        <li>×ª×•××š ×‘-Pools ×•-Queues</li>
                        <li>×“×•×¨×© broker (RabbitMQ/Redis)</li>
                        <li>×××¤×©×¨ ×œ×”×¤×¨×™×“ ×¡×•×’×™ workloads ×©×•× ×™×</li>
                    </ul>

                    <div class="success-card" style="margin-top: 20px;">
                        <p><strong>âœ… ×©×™××•×©:</strong> ×¤×¨×•×“×§×©×Ÿ ×‘×§× ×” ××™×“×” ×’×“×•×œ, clusters</p>
                    </div>
                </div>
            </div>

            <div style="margin-top: 60px;">
                <h2 style="text-align: center; margin-bottom: 40px;">×”×©×•×•××” ××”×™×¨×”</h2>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; background: white; border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-md);">
                        <thead style="background: linear-gradient(135deg, var(--airflow-primary), var(--airflow-secondary)); color: white;">
                            <tr>
                                <th style="padding: 20px; text-align: right; font-size: 1.05rem;">×ª×›×•× ×”</th>
                                <th style="padding: 20px; text-align: center; font-size: 1.05rem;">Sequential</th>
                                <th style="padding: 20px; text-align: center; font-size: 1.05rem;">Local</th>
                                <th style="padding: 20px; text-align: center; font-size: 1.05rem;">Celery</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: 18px; font-weight: 600;">Parallelism</td>
                                <td style="padding: 18px; text-align: center;">âŒ ×œ×</td>
                                <td style="padding: 18px; text-align: center;">âœ… ×›×Ÿ</td>
                                <td style="padding: 18px; text-align: center;">âœ… ×›×Ÿ</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border-color); background: #f8f9fa;">
                                <td style="padding: 18px; font-weight: 600;">Scalability</td>
                                <td style="padding: 18px; text-align: center;">âŒ ××™×Ÿ</td>
                                <td style="padding: 18px; text-align: center;">â¬†ï¸ Vertical</td>
                                <td style="padding: 18px; text-align: center;">â¬†ï¸â¡ï¸ Both</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: 18px; font-weight: 600;">Production Ready</td>
                                <td style="padding: 18px; text-align: center;">âŒ ×œ×</td>
                                <td style="padding: 18px; text-align: center;">âœ… ×›×Ÿ</td>
                                <td style="padding: 18px; text-align: center;">âœ… ×›×Ÿ</td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border-color); background: #f8f9fa;">
                                <td style="padding: 18px; font-weight: 600;">Setup</td>
                                <td style="padding: 18px; text-align: center;">ğŸŸ¢ ×¤×©×•×˜</td>
                                <td style="padding: 18px; text-align: center;">ğŸŸ¡ ×‘×™× ×•× ×™</td>
                                <td style="padding: 18px; text-align: center;">ğŸ”´ ××•×¨×›×‘</td>
                            </tr>
                            <tr>
                                <td style="padding: 18px; font-weight: 600;">Monitoring</td>
                                <td style="padding: 18px; text-align: center;">×‘×¡×™×¡×™</td>
                                <td style="padding: 18px; text-align: center;">×‘×¡×™×¡×™</td>
                                <td style="padding: 18px; text-align: center;">âœ… Flower</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- === UI VIEW === -->
    <div id="view-ui" class="view-section">
        <div style="padding: 60px; max-width: 1400px; margin: 0 auto;">
            <h1 style="font-size: 2.5rem; margin-bottom: 20px; text-align: center;">ğŸ–¥ï¸ ×××©×§ ×”××©×ª××© ×©×œ Airflow</h1>
            <p style="text-align: center; font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 50px;">
                Airflow ××¡×¤×§ ×××©×§ ××©×ª××© ×¢×©×™×¨ ×•××™× ×˜×•××™×˜×™×‘×™ ×œ× ×™×”×•×œ ×•× ×™×˜×•×¨ workflows
            </p>

            <div class="comparison-grid">
                <div class="ui-showcase">
                    <h3>ğŸ“‹ DAGs List View</h3>
                    <div class="ui-placeholder">
                        ×¨×©×™××ª ×›×œ ×”-DAGs ×‘××¢×¨×›×ª<br>
                        ×›×•×œ×œ ×¡×˜×˜×•×¡, ×œ×•×—×•×ª ×–×× ×™×, ×‘×¢×œ×™× ×•×¤×¢×•×œ×•×ª
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <h4 style="color: var(--airflow-primary); margin-bottom: 10px;">××” ×¨×•××™×?</h4>
                        <ul style="padding-right: 25px;">
                            <li>×©××•×ª DAGs ×•×¡×˜×˜×•×¡ (active/paused)</li>
                            <li>×”×¨×¦×•×ª ××—×¨×•× ×•×ª (success/failed)</li>
                            <li>Schedule interval</li>
                            <li>×‘×¢×œ×™× (owner)</li>
                            <li>×¤×¢×•×œ×•×ª: trigger, refresh, delete</li>
                        </ul>
                    </div>
                </div>

                <div class="ui-showcase">
                    <h3>ğŸŒ³ Graph View</h3>
                    <div class="ui-placeholder">
                        ×ª×¦×•×’×” ×’×¨×¤×™×ª ×©×œ ×”××‘× ×” ×©×œ DAG<br>
                        ××¦×™×’×” tasks ×•××ª ×”×ª×œ×•×™×•×ª ×‘×™× ×™×”×
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <h4 style="color: var(--airflow-primary); margin-bottom: 10px;">××” ×¨×•××™×?</h4>
                        <ul style="padding-right: 25px;">
                            <li>×›×œ ×”-tasks ×›nodes</li>
                            <li>×—×¦×™× ××¦×™×’×™× ×ª×œ×•×™×•×ª</li>
                            <li>×¦×‘×¢×™× ××¦×™×’×™× ×¡×˜×˜×•×¡ (green=success, red=failed)</li>
                            <li>×œ×—×™×¦×” ×¢×œ task ××¦×™×’×” ×¤×¨×˜×™×</li>
                        </ul>
                    </div>
                </div>

                <div class="ui-showcase">
                    <h3>ğŸŒ² Tree View</h3>
                    <div class="ui-placeholder">
                        ×ª×¦×•×’×ª ×¢×¥ ×©×œ ×”×¨×¦×•×ª DAG ×œ××•×¨×š ×–××Ÿ<br>
                        ××¦×™×’×” ×”×™×¡×˜×•×¨×™×” ×©×œ ×‘×™×¦×•×¢×™×
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <h4 style="color: var(--airflow-primary); margin-bottom: 10px;">××” ×¨×•××™×?</h4>
                        <ul style="padding-right: 25px;">
                            <li>×›×œ task ×‘×©×•×¨×” × ×¤×¨×“×ª</li>
                            <li>×¢××•×“×•×ª ××™×™×¦×’×•×ª ×”×¨×¦×•×ª ×©×•× ×•×ª</li>
                            <li>×¦×‘×¢×™× ××¦×™×’×™× ×¡×˜×˜×•×¡ ×œ××•×¨×š ×–××Ÿ</li>
                            <li>×××¤×©×¨ ×œ×–×”×•×ª patterns ×©×œ failures</li>
                        </ul>
                    </div>
                </div>

                <div class="ui-showcase">
                    <h3>ğŸ“Š Gantt Chart</h3>
                    <div class="ui-placeholder">
                        ×ª×¨×©×™× Gantt ×©×œ ×–×× ×™ ×¨×™×¦×”<br>
                        ××¦×™×’ overlap ×•-bottlenecks
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <h4 style="color: var(--airflow-primary); margin-bottom: 10px;">××” ×¨×•××™×?</h4>
                        <ul style="padding-right: 25px;">
                            <li>timeline ×©×œ ×›×œ task</li>
                            <li>××©×š ×–××Ÿ ×‘×™×¦×•×¢ (duration)</li>
                            <li>overlap ×‘×™×Ÿ tasks</li>
                            <li>bottlenecks ×‘××¢×¨×›×ª</li>
                            <li>×©×™××•×©×™ ×œ××•×¤×˜×™××™×–×¦×™×”</li>
                        </ul>
                    </div>
                </div>

                <div class="ui-showcase">
                    <h3>â±ï¸ Task Duration</h3>
                    <div class="ui-placeholder">
                        ×•×™×–×•××œ×™×–×¦×™×” ×©×œ ××©×š ×–××Ÿ tasks<br>
                        ×œ××•×¨×š ××¡×¤×¨ ×”×¨×¦×•×ª
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <h4 style="color: var(--airflow-primary); margin-bottom: 10px;">××” ×¨×•××™×?</h4>
                        <ul style="padding-right: 25px;">
                            <li>×’×¨×£ ×©×œ duration ×œ×›×œ task</li>
                            <li>××’××•×ª ×œ××•×¨×š ×–××Ÿ</li>
                            <li>×–×™×”×•×™ tasks ×©×××˜×™×</li>
                            <li>×”×©×•×•××” ×‘×™×Ÿ ×”×¨×¦×•×ª</li>
                        </ul>
                    </div>
                </div>

                <div class="ui-showcase">
                    <h3>ğŸ“ Code View</h3>
                    <div class="ui-placeholder">
                        ×”×¦×’×ª ×”×§×•×“ Python ×©×œ DAG<br>
                        ×™×©×™×¨×•×ª ×‘×××©×§
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <h4 style="color: var(--airflow-primary); margin-bottom: 10px;">××” ×¨×•××™×?</h4>
                        <ul style="padding-right: 25px;">
                            <li>×§×•×“ Python ×”××œ× ×©×œ DAG</li>
                            <li>syntax highlighting</li>
                            <li>×©×™××•×©×™ ×œdebug ××”×™×¨</li>
                            <li>×”×‘× ×ª ×œ×•×’×™×§×” ××‘×œ×™ ×œ×¦××ª ××”×××©×§</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="comparison-card" style="margin-top: 40px;">
                <h2 style="margin-top: 0;">ğŸ›ï¸ ×¤×¢×•×œ×•×ª × ×¤×•×¦×•×ª ×‘-UI</h2>

                <h3>×¢×œ DAG:</h3>
                <ul style="padding-right: 25px;">
                    <li><strong>Trigger DAG:</strong> â–¶ï¸ ×›×¤×ª×•×¨ Play - ×”×¤×¢×œ×” ×™×“× ×™×ª</li>
                    <li><strong>Pause/Unpause:</strong> â¸ï¸ Toggle switch - ×¢×¦×™×¨×”/×”×¤×¢×œ×” ×©×œ scheduling</li>
                    <li><strong>Delete:</strong> ğŸ—‘ï¸ ××—×™×§×ª DAG + history</li>
                    <li><strong>Refresh:</strong> ğŸ”„ ×¨×¢× ×•×Ÿ ××˜×-×“××˜×”</li>
                </ul>

                <h3>×¢×œ Task:</h3>
                <ul style="padding-right: 25px;">
                    <li><strong>View Log:</strong> ×¦×¤×™×™×” ×‘-logs ×©×œ ×”×¨×¦×”</li>
                    <li><strong>Mark Success/Failed:</strong> ×©×™× ×•×™ ×¡×˜×˜×•×¡ ×™×“× ×™</li>
                    <li><strong>Clear:</strong> × ×™×§×•×™ ×¡×˜×˜×•×¡ (×œ×”×¨×¦×” ××—×“×©)</li>
                    <li><strong>Run:</strong> ×”×¨×¦×” ×™×“× ×™×ª ×©×œ task ×‘×•×“×“</li>
                    <li><strong>Task Instance Details:</strong> ××™×“×¢ ××¤×•×¨×˜</li>
                    <li><strong>XCom:</strong> ×¦×¤×™×™×” ×‘-XCom values</li>
                    <li><strong>Rendered Template:</strong> ×¢×¨×›×™× ××—×¨×™ Jinja rendering</li>
                </ul>

                <h3>Navigation Shortcuts:</h3>
                <div class="code-block"># Keyboard shortcuts in UI:
?           # Show help
/           # Search DAGs
Shift + /   # Open command palette

# URL patterns:
/home                                    # Main page
/dags/{dag_id}/graph                    # Graph view
/dags/{dag_id}/tree                     # Tree view
/dags/{dag_id}/gantt                    # Gantt chart
/admin/connection                       # Connections
/admin/variable                         # Variables</div>
            </div>

            <div class="success-card" style="margin-top: 40px;">
                <h3 style="margin-top: 0;">ğŸ’¡ ×˜×™×¤×™× ×œ×©×™××•×© ×‘UI:</h3>
                <ul>
                    <li><strong>Graph View</strong> - ×”×›×™ ×˜×•×‘ ×œ×”×‘× ×ª ××‘× ×” ×”-DAG ×•×ª×œ×•×™×•×ª</li>
                    <li><strong>Tree View</strong> - ×”×›×™ ×˜×•×‘ ×œ×–×™×”×•×™ patterns ×©×œ failures ×œ××•×¨×š ×–××Ÿ</li>
                    <li><strong>Gantt Chart</strong> - ×”×›×™ ×˜×•×‘ ×œ××•×¤×˜×™××™×–×¦×™×” ×©×œ ×‘×™×¦×•×¢×™× ×•×–×™×”×•×™ bottlenecks</li>
                    <li><strong>Task Duration</strong> - ×”×›×™ ×˜×•×‘ ×œ×–×™×”×•×™ tasks ××™×˜×™×™× ×•-trends</li>
                    <li><strong>Code View</strong> - ××”×™×¨ ×œ×‘×“×™×§×ª ×§×•×“ ×œ×œ× ×¤×ª×™×—×ª ×§×•×‘×¥</li>
                    <li>×œ×—×¥ ×¢×œ task ×œ×¨××•×ª logs, retry, mark success/failed, XCom</li>
                    <li>×œ×—×¥ ×¢×œ connection ×‘×™×Ÿ tasks ×œ×¨××•×ª Relationship</li>
                    <li>×”×©×ª××© ×‘-Refresh ×›×“×™ ×œ×˜×¢×•×Ÿ ×©×™× ×•×™×™× ×‘×§×•×“</li>
                    <li>×¡× ×Ÿ DAGs ×œ×¤×™ Tags ×‘×¢××•×“×” ×”×©×××œ×™×ª</li>
                </ul>
            </div>

            <div class="warning-card" style="margin-top: 30px;">
                <h3 style="margin-top: 0;">âš ï¸ ×©×’×™××•×ª × ×¤×•×¦×•×ª ×‘-UI</h3>
                <ul>
                    <li><strong>DAG ×œ× ××•×¤×™×¢:</strong> ×‘×“×•×§ ×©×”×§×•×‘×¥ ×‘-<code>dags/</code> ×•××™×Ÿ ×©×’×™××•×ª syntax</li>
                    <li><strong>"Broken DAG":</strong> ×™×© ×©×’×™××” ×‘×§×•×“ - ×‘×“×•×§ ××ª ×”-Import Errors</li>
                    <li><strong>Tasks ×œ× ×¨×¦×™×:</strong> ×‘×“×•×§ ×©×”-DAG ×œ× ×‘-Pause (toggle switch)</li>
                    <li><strong>"Queued" ×œ× ×¦×—:</strong> Scheduler ×œ× ×¨×¥ ××• ××™×Ÿ workers ×–××™× ×™×</li>
                    <li><strong>"Up for retry":</strong> Task × ×›×©×œ ×•××—×›×” ×œ-retry_delay</li>
                </ul>
            </div>

            <div class="info-card" style="margin-top: 30px;">
                <h3 style="margin-top: 0;">ğŸ” ×›×™×¦×“ ×œ× ×¤×•×ª ×‘××’×™× ×“×¨×š UI</h3>
                <ol style="padding-right: 25px; font-size: 1.05rem; line-height: 2;">
                    <li>×œ×—×¥ ×¢×œ ×”-DAG â†’ Graph View</li>
                    <li>×–×”×” tasks ×¢× ×¦×‘×¢ ××“×•×/×›×ª×•× (failed/retry)</li>
                    <li>×œ×—×¥ ×¢×œ Task â†’ View Log</li>
                    <li>×§×¨× ××ª ×”×”×•×“×¢×ª ×©×’×™××” ×‘×¡×•×£ ×”-log</li>
                    <li>×œ×—×¥ ×¢×œ Task â†’ Rendered Template ×œ×¨××•×ª ×¢×¨×›×™× ×××™×ª×™×™×</li>
                    <li>×œ×—×¥ ×¢×œ Task â†’ XCom ×œ×¨××•×ª data ×©×”×•×¢×‘×¨</li>
                    <li>×œ××—×¨ ×ª×™×§×•×Ÿ ×‘×§×•×“: ×œ×—×¥ Clear ×¢×œ Task â†’ ×”×¨×¦×” ××—×“×©</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- === EXAMPLES VIEW === -->
    <div id="view-examples" class="view-section">
        <div style="padding: 60px; max-width: 1400px; margin: 0 auto;">
            <h1 style="font-size: 2.5rem; margin-bottom: 20px; text-align: center;">ğŸ’¡ ×“×•×’×××•×ª DAG ××¢×©×™×•×ª</h1>
            <p style="text-align: center; font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 50px;">
                8 ×“×•×’×××•×ª ××•×›× ×•×ª ×œ×©×™××•×© - ×”×¢×ª×§ ×•×”×ª×—×œ ×œ×¢×‘×•×“!
            </p>

            <!-- Example 1: Hello World -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 1: Hello World - DAG ×¨××©×•×Ÿ</h2>
                <p style="margin-bottom: 20px;">DAG ×¤×©×•×˜ ×¢× BashOperator ×•-PythonOperator ×‘×¡×™×¡×™</p>
                <div class="code-block">from airflow import DAG
from airflow.operators.bash import BashOperator
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta

# Default arguments
default_args = {
    'owner': 'airflow',
    'depends_on_past': False,
    'start_date': datetime(2024, 1, 1),
    'email_on_failure': False,
    'email_on_retry': False,
    'retries': 1,
    'retry_delay': timedelta(minutes=5),
}

# Create DAG
dag = DAG(
    'hello_world_dag',
    default_args=default_args,
    description='My first Airflow DAG',
    schedule_interval=timedelta(days=1),
    catchup=False,
    tags=['example', 'tutorial'],
)

# Python function
def print_hello():
    print("Hello from Airflow!")
    return "Success"

# Task 1: Print date
print_date = BashOperator(
    task_id='print_date',
    bash_command='date',
    dag=dag,
)

# Task 2: Print hello
print_hello_task = PythonOperator(
    task_id='print_hello',
    python_callable=print_hello,
    dag=dag,
)

# Task 3: Print done
print_done = BashOperator(
    task_id='print_done',
    bash_command='echo "Pipeline completed!"',
    dag=dag,
)

# Set dependencies
print_date >> print_hello_task >> print_done</div>
            </div>

            <!-- Example 2: Database ETL -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 2: Database ETL Pipeline</h2>
                <p style="margin-bottom: 20px;">×§×¨×™××” ×××¡×“ × ×ª×•× ×™×, ×¢×™×‘×•×“, ×•×›×ª×™×‘×” ×œ××¡×“ ××—×¨</p>
                <div class="code-block">from airflow import DAG
from airflow.providers.postgres.operators.postgres import PostgresOperator
from airflow.providers.postgres.hooks.postgres import PostgresHook
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta
import pandas as pd

default_args = {
    'owner': 'data_team',
    'retries': 2,
    'retry_delay': timedelta(minutes=5),
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'postgres_etl_pipeline',
    default_args=default_args,
    description='ETL from source to target database',
    schedule_interval='@daily',
    catchup=False,
    tags=['etl', 'database'],
)

# Task 1: Extract data from source
def extract_data(**context):
    """Extract data from source database"""
    hook = PostgresHook(postgres_conn_id='source_db')
    sql = """
        SELECT
            user_id,
            username,
            email,
            created_at
        FROM users
        WHERE DATE(created_at) = '{{ ds }}'
    """
    df = hook.get_pandas_df(sql)

    # Push to XCom
    context['ti'].xcom_push(key='user_count', value=len(df))

    # Save to temp location
    df.to_csv('/tmp/users_{{ ds }}.csv', index=False)
    print(f"Extracted {len(df)} users")

# Task 2: Transform data
def transform_data(**context):
    """Transform the data"""
    df = pd.read_csv('/tmp/users_{{ ds }}.csv')

    # Transformations
    df['username'] = df['username'].str.upper()
    df['email_domain'] = df['email'].str.split('@').str[1]
    df['load_date'] = datetime.now()

    # Save transformed data
    df.to_csv('/tmp/users_transformed_{{ ds }}.csv', index=False)
    print(f"Transformed {len(df)} records")

# Task 3: Load to target database
def load_data(**context):
    """Load data to target database"""
    hook = PostgresHook(postgres_conn_id='target_db')
    df = pd.read_csv('/tmp/users_transformed_{{ ds }}.csv')

    # Insert into target table
    hook.insert_rows(
        table='users_staging',
        rows=df.values.tolist(),
        target_fields=df.columns.tolist()
    )
    print(f"Loaded {len(df)} records to target")

extract_task = PythonOperator(
    task_id='extract_data',
    python_callable=extract_data,
    provide_context=True,
    dag=dag,
)

transform_task = PythonOperator(
    task_id='transform_data',
    python_callable=transform_data,
    provide_context=True,
    dag=dag,
)

load_task = PythonOperator(
    task_id='load_data',
    python_callable=load_data,
    provide_context=True,
    dag=dag,
)

# Dependencies: Extract â†’ Transform â†’ Load
extract_task >> transform_task >> load_task</div>
            </div>

            <!-- Example 3: API Integration -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 3: REST API Integration</h2>
                <p style="margin-bottom: 20px;">×§×¨×™××” ×œ-API ×—×™×¦×•× ×™ ×•×¢×™×‘×•×“ ×”×ª×•×¦××•×ª</p>
                <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.providers.http.operators.http import SimpleHttpOperator
from airflow.providers.http.sensors.http import HttpSensor
from datetime import datetime, timedelta
import json

default_args = {
    'owner': 'api_team',
    'retries': 3,
    'retry_delay': timedelta(minutes=2),
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'api_integration_dag',
    default_args=default_args,
    description='Fetch data from REST API',
    schedule_interval='@hourly',
    catchup=False,
    tags=['api', 'integration'],
)

# Task 1: Check if API is available
check_api = HttpSensor(
    task_id='check_api_available',
    http_conn_id='api_connection',
    endpoint='health',
    request_params={},
    response_check=lambda response: response.status_code == 200,
    poke_interval=30,
    timeout=300,
    dag=dag,
)

# Task 2: Fetch data from API
fetch_api_data = SimpleHttpOperator(
    task_id='fetch_users',
    http_conn_id='api_connection',
    endpoint='api/users',
    method='GET',
    headers={"Content-Type": "application/json"},
    response_filter=lambda response: json.loads(response.text),
    log_response=True,
    dag=dag,
)

# Task 3: Process API response
def process_api_response(**context):
    """Process the API response"""
    ti = context['ti']
    data = ti.xcom_pull(task_ids='fetch_users')

    print(f"Received {len(data)} records from API")

    # Process data
    processed_count = 0
    for record in data:
        # Your processing logic here
        if record.get('status') == 'active':
            processed_count += 1

    print(f"Processed {processed_count} active users")

    # Push to next task
    ti.xcom_push(key='processed_count', value=processed_count)

process_task = PythonOperator(
    task_id='process_response',
    python_callable=process_api_response,
    provide_context=True,
    dag=dag,
)

# Task 4: Send notification
def send_notification(**context):
    """Send summary notification"""
    ti = context['ti']
    count = ti.xcom_pull(task_ids='process_response', key='processed_count')
    print(f"Pipeline completed! Processed {count} users")

notify_task = PythonOperator(
    task_id='send_notification',
    python_callable=send_notification,
    provide_context=True,
    dag=dag,
)

# Dependencies
check_api >> fetch_api_data >> process_task >> notify_task</div>
            </div>

            <!-- Example 4: XCom -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 4: XCom - ×ª×§×©×•×¨×ª ×‘×™×Ÿ Tasks</h2>
                <p style="margin-bottom: 20px;">×©×™××•×© ×‘-XCom ×œ×”×¢×‘×¨×ª ××™×“×¢ ×‘×™×Ÿ tasks</p>
                <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
    'retries': 1,
}

dag = DAG(
    'xcom_example_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
    tags=['example', 'xcom'],
)

def calculate_metrics(**context):
    """Calculate some metrics"""
    # Simulate calculation
    total_sales = 150000
    total_orders = 1250
    average_order_value = total_sales / total_orders

    # Push multiple values to XCom
    context['ti'].xcom_push(key='total_sales', value=total_sales)
    context['ti'].xcom_push(key='total_orders', value=total_orders)
    context['ti'].xcom_push(key='avg_order_value', value=average_order_value)

    # Return value is automatically pushed with key='return_value'
    return {
        'status': 'success',
        'records_processed': 1250
    }

def generate_report(**context):
    """Generate report using XCom data"""
    ti = context['ti']

    # Pull specific keys
    sales = ti.xcom_pull(task_ids='calculate', key='total_sales')
    orders = ti.xcom_pull(task_ids='calculate', key='total_orders')
    avg = ti.xcom_pull(task_ids='calculate', key='avg_order_value')

    # Pull return value
    result = ti.xcom_pull(task_ids='calculate')

    print(f"""
    Daily Report:
    =============
    Total Sales: ${sales:,.2f}
    Total Orders: {orders:,}
    Average Order Value: ${avg:.2f}
    Status: {result['status']}
    """)

def send_alert(**context):
    """Send alert if threshold exceeded"""
    ti = context['ti']
    sales = ti.xcom_pull(task_ids='calculate', key='total_sales')

    if sales > 100000:
        print(f"ğŸ‰ Great day! Sales: ${sales:,.2f}")
    else:
        print(f"âš ï¸ Low sales day: ${sales:,.2f}")

calculate_task = PythonOperator(
    task_id='calculate',
    python_callable=calculate_metrics,
    provide_context=True,
    dag=dag,
)

report_task = PythonOperator(
    task_id='generate_report',
    python_callable=generate_report,
    provide_context=True,
    dag=dag,
)

alert_task = PythonOperator(
    task_id='send_alert',
    python_callable=send_alert,
    provide_context=True,
    dag=dag,
)

# calculate runs first, then both report and alert run in parallel
calculate_task >> [report_task, alert_task]</div>
            </div>

            <!-- Example 5: Branching -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 5: Branching - ×ª× ××™× ×•×”×¡×ª×¢×¤×•×™×•×ª</h2>
                <p style="margin-bottom: 20px;">×©×™××•×© ×‘-BranchPythonOperator ×œ×”×¡×ª×¢×¤×•×ª ×œ×¤×™ ×ª× ××™×</p>
                <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator, BranchPythonOperator
from airflow.operators.bash import BashOperator
from datetime import datetime, timedelta

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'branching_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
    tags=['example', 'branching'],
)

def check_data_quality(**context):
    """Check if data quality is good"""
    # Simulate quality check
    quality_score = 85  # In real scenario, calculate from data

    context['ti'].xcom_push(key='quality_score', value=quality_score)

    # Branch based on quality
    if quality_score >= 80:
        return 'process_high_quality'
    else:
        return 'send_alert_low_quality'

def process_high_quality():
    """Process high quality data"""
    print("âœ… Data quality is good - processing normally")

def send_alert_low_quality():
    """Send alert for low quality data"""
    print("âš ï¸ Data quality is low - sending alert")

def final_step():
    """Final step - always runs"""
    print("ğŸ Pipeline completed")

# Tasks
check_quality = BranchPythonOperator(
    task_id='check_quality',
    python_callable=check_data_quality,
    provide_context=True,
    dag=dag,
)

high_quality_task = PythonOperator(
    task_id='process_high_quality',
    python_callable=process_high_quality,
    dag=dag,
)

low_quality_task = PythonOperator(
    task_id='send_alert_low_quality',
    python_callable=send_alert_low_quality,
    dag=dag,
)

final_task = BashOperator(
    task_id='final_step',
    bash_command='echo "Done"',
    trigger_rule='none_failed_min_one_success',  # Important!
    dag=dag,
)

# Dependencies
check_quality >> [high_quality_task, low_quality_task] >> final_task</div>
            </div>

            <!-- Example 6: Multiple Dependencies -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 6: ×ª×œ×•×™×•×ª ××•×¨×›×‘×•×ª</h2>
                <p style="margin-bottom: 20px;">DAG ×¢× ×ª×œ×•×™×•×ª ××¨×•×‘×•×ª ×•-parallel execution</p>
                <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.operators.bash import BashOperator
from datetime import datetime, timedelta

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'complex_dependencies_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
    tags=['example', 'dependencies'],
)

# Python functions
def fetch_source_a():
    print("ğŸ“¥ Fetching from Source A")

def fetch_source_b():
    print("ğŸ“¥ Fetching from Source B")

def fetch_source_c():
    print("ğŸ“¥ Fetching from Source C")

def combine_data(**context):
    print("ğŸ”„ Combining all sources")

def validate_data():
    print("âœ… Validating combined data")

def save_to_warehouse():
    print("ğŸ’¾ Saving to Data Warehouse")

# Create tasks
start = BashOperator(
    task_id='start',
    bash_command='echo "Starting ETL pipeline"',
    dag=dag,
)

# Parallel data fetching
fetch_a = PythonOperator(
    task_id='fetch_source_a',
    python_callable=fetch_source_a,
    dag=dag,
)

fetch_b = PythonOperator(
    task_id='fetch_source_b',
    python_callable=fetch_source_b,
    dag=dag,
)

fetch_c = PythonOperator(
    task_id='fetch_source_c',
    python_callable=fetch_source_c,
    dag=dag,
)

# Combine after all fetches complete
combine = PythonOperator(
    task_id='combine_data',
    python_callable=combine_data,
    provide_context=True,
    dag=dag,
)

# Validate
validate = PythonOperator(
    task_id='validate_data',
    python_callable=validate_data,
    dag=dag,
)

# Save
save = PythonOperator(
    task_id='save_to_warehouse',
    python_callable=save_to_warehouse,
    dag=dag,
)

end = BashOperator(
    task_id='end',
    bash_command='echo "Pipeline completed successfully"',
    dag=dag,
)

# Complex dependencies:
# Start â†’ [fetch_a, fetch_b, fetch_c] â†’ combine â†’ validate â†’ save â†’ end
start >> [fetch_a, fetch_b, fetch_c] >> combine >> validate >> save >> end</div>
            </div>

            <!-- Example 7: File Processing -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 7: File Processing Pipeline</h2>
                <p style="margin-bottom: 20px;">×¢×™×‘×•×“ ×§×‘×¦×™× ××ª×™×§×™×™×” + ××¨×›×•×‘</p>
                <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.operators.bash import BashOperator
from datetime import datetime, timedelta
import os
import shutil
import pandas as pd

default_args = {
    'owner': 'data_team',
    'start_date': datetime(2024, 1, 1),
    'retries': 1,
}

dag = DAG(
    'file_processing_pipeline',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
    tags=['files', 'etl'],
)

def list_files(**context):
    """List all files in input directory"""
    input_dir = '/data/input'
    files = [f for f in os.listdir(input_dir) if f.endswith('.csv')]

    context['ti'].xcom_push(key='file_list', value=files)
    print(f"Found {len(files)} CSV files")
    return len(files)

def process_files(**context):
    """Process all CSV files"""
    ti = context['ti']
    files = ti.xcom_pull(task_ids='list_files', key='file_list')

    processed_count = 0
    for filename in files:
        input_path = f'/data/input/{filename}'
        output_path = f'/data/output/processed_{filename}'

        # Read, process, and save
        df = pd.read_csv(input_path)

        # Add processing timestamp
        df['processed_at'] = datetime.now()
        df['processed_by'] = 'airflow'

        # Save processed file
        df.to_csv(output_path, index=False)
        processed_count += 1

    print(f"Processed {processed_count} files")
    ti.xcom_push(key='processed_count', value=processed_count)

def archive_files(**context):
    """Move processed files to archive"""
    ti = context['ti']
    files = ti.xcom_pull(task_ids='list_files', key='file_list')

    archive_dir = f'/data/archive/{{ ds }}'
    os.makedirs(archive_dir, exist_ok=True)

    for filename in files:
        source = f'/data/input/{filename}'
        destination = f'{archive_dir}/{filename}'
        shutil.move(source, destination)

    print(f"Archived {len(files)} files")

# Tasks
list_task = PythonOperator(
    task_id='list_files',
    python_callable=list_files,
    provide_context=True,
    dag=dag,
)

process_task = PythonOperator(
    task_id='process_files',
    python_callable=process_files,
    provide_context=True,
    dag=dag,
)

archive_task = PythonOperator(
    task_id='archive_files',
    python_callable=archive_files,
    provide_context=True,
    dag=dag,
)

cleanup_task = BashOperator(
    task_id='cleanup_temp',
    bash_command='rm -rf /tmp/airflow_temp_*',
    dag=dag,
)

# Dependencies
list_task >> process_task >> [archive_task, cleanup_task]</div>
            </div>

            <!-- Example 8: Monitoring & Alerts -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 8: Monitoring & Email Alerts</h2>
                <p style="margin-bottom: 20px;">×©×œ×™×—×ª ××™××™×™×œ×™× ×¢×œ ×”×¦×œ×—×”/×›×©×œ×•×Ÿ</p>
                <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.operators.email import EmailOperator
from airflow.utils.trigger_rule import TriggerRule
from datetime import datetime, timedelta

default_args = {
    'owner': 'data_team',
    'start_date': datetime(2024, 1, 1),
    'email': ['team@example.com'],
    'email_on_failure': True,
    'email_on_retry': False,
    'retries': 2,
    'retry_delay': timedelta(minutes=5),
}

dag = DAG(
    'monitoring_with_alerts_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
    tags=['monitoring', 'alerts'],
)

def critical_process(**context):
    """Critical business process"""
    import random

    # Simulate processing
    success_rate = random.random()

    if success_rate > 0.3:  # 70% success rate
        print("âœ… Process completed successfully")
        context['ti'].xcom_push(key='records_processed', value=1500)
    else:
        raise Exception("âŒ Process failed - quality check did not pass")

def generate_summary(**context):
    """Generate success summary"""
    ti = context['ti']
    records = ti.xcom_pull(task_ids='critical_process', key='records_processed')

    return f"""
    <html>
    <body>
        <h2>âœ… Daily Process Completed Successfully</h2>
        <p><strong>Date:</strong> {{ ds }}</p>
        <p><strong>Records Processed:</strong> {records:,}</p>
        <p><strong>Status:</strong> âœ… Success</p>
    </body>
    </html>
    """

critical_task = PythonOperator(
    task_id='critical_process',
    python_callable=critical_process,
    provide_context=True,
    dag=dag,
)

# Success email
success_email = EmailOperator(
    task_id='send_success_email',
    to='team@example.com',
    subject='âœ… Airflow DAG Success: {{ dag.dag_id }}',
    html_content="""
    <h3>Pipeline Completed Successfully</h3>
    <p><b>DAG:</b> {{ dag.dag_id }}</p>
    <p><b>Execution Date:</b> {{ ds }}</p>
    <p><b>Task:</b> {{ task.task_id }}</p>
    """,
    dag=dag,
)

# Failure email (runs only on failure)
failure_email = EmailOperator(
    task_id='send_failure_email',
    to='alerts@example.com',
    subject='âŒ Airflow DAG Failed: {{ dag.dag_id }}',
    html_content="""
    <h3 style="color: red;">Pipeline Failed</h3>
    <p><b>DAG:</b> {{ dag.dag_id }}</p>
    <p><b>Execution Date:</b> {{ ds }}</p>
    <p><b>Failed Task:</b> {{ task.task_id }}</p>
    <p>Please investigate immediately!</p>
    """,
    trigger_rule=TriggerRule.ONE_FAILED,  # Run if any upstream fails
    dag=dag,
)

# Dependencies
critical_task >> success_email
critical_task >> failure_email</div>
            </div>

            <!-- Example 9: TaskGroup -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 9: TaskGroups - ××¨×’×•×Ÿ Tasks</h2>
                <p style="margin-bottom: 20px;">×©×™××•×© ×‘-TaskGroups ×œ××¨×’×•×Ÿ tasks (Airflow 2.0+)</p>
                <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.operators.bash import BashOperator
from airflow.utils.task_group import TaskGroup
from datetime import datetime

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'taskgroup_example_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
    tags=['example', 'taskgroup'],
)

def extract_from_api():
    print("ğŸ“¥ Extracting from API")

def extract_from_db():
    print("ğŸ“¥ Extracting from Database")

def extract_from_file():
    print("ğŸ“¥ Extracting from File")

def transform_api_data():
    print("ğŸ”„ Transforming API data")

def transform_db_data():
    print("ğŸ”„ Transforming DB data")

def transform_file_data():
    print("ğŸ”„ Transforming File data")

start = BashOperator(
    task_id='start',
    bash_command='echo "Starting ETL"',
    dag=dag,
)

# TaskGroup for extraction
with TaskGroup('extract_group', dag=dag) as extract_group:
    extract_api = PythonOperator(
        task_id='extract_api',
        python_callable=extract_from_api,
    )

    extract_db = PythonOperator(
        task_id='extract_db',
        python_callable=extract_from_db,
    )

    extract_file = PythonOperator(
        task_id='extract_file',
        python_callable=extract_from_file,
    )

# TaskGroup for transformation
with TaskGroup('transform_group', dag=dag) as transform_group:
    transform_api = PythonOperator(
        task_id='transform_api',
        python_callable=transform_api_data,
    )

    transform_db = PythonOperator(
        task_id='transform_db',
        python_callable=transform_db_data,
    )

    transform_file = PythonOperator(
        task_id='transform_file',
        python_callable=transform_file_data,
    )

end = BashOperator(
    task_id='end',
    bash_command='echo "ETL Completed"',
    dag=dag,
)

# Dependencies: start â†’ extract_group â†’ transform_group â†’ end
start >> extract_group >> transform_group >> end</div>
            </div>

            <!-- Example 10: Sensors -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-primary);">×“×•×’××” 10: Sensors - ×”××ª× ×” ×œ××™×¨×•×¢×™×</h2>
                <p style="margin-bottom: 20px;">×©×™××•×© ×‘-Sensors ×œ×”××ª× ×” ×œ×§×•×‘×¥, API ××• ×ª× ××™</p>
                <div class="code-block">from airflow import DAG
from airflow.sensors.filesystem import FileSensor
from airflow.providers.http.sensors.http import HttpSensor
from airflow.sensors.python import PythonSensor
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta
import os

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'sensors_example_dag',
    default_args=default_args,
    schedule_interval='@hourly',
    catchup=False,
    tags=['example', 'sensors'],
)

# Sensor 1: Wait for file
wait_for_file = FileSensor(
    task_id='wait_for_input_file',
    filepath='/data/input/data_{{ ds }}.csv',
    poke_interval=30,  # Check every 30 seconds
    timeout=600,  # Give up after 10 minutes
    mode='poke',  # 'poke' or 'reschedule'
    dag=dag,
)

# Sensor 2: Wait for API
def check_api_response(response):
    """Check if API response is valid"""
    return response.status_code == 200

wait_for_api = HttpSensor(
    task_id='wait_for_api',
    http_conn_id='api_connection',
    endpoint='api/status',
    response_check=check_api_response,
    poke_interval=60,
    timeout=600,
    dag=dag,
)

# Sensor 3: Custom condition
def check_custom_condition():
    """Custom check - example: check if it's business hours"""
    from datetime import datetime
    now = datetime.now()
    # Business hours: 8:00 - 18:00
    return 8 <= now.hour < 18

wait_for_business_hours = PythonSensor(
    task_id='wait_for_business_hours',
    python_callable=check_custom_condition,
    poke_interval=300,  # Check every 5 minutes
    timeout=3600,  # Wait up to 1 hour
    mode='reschedule',  # Free up worker slot while waiting
    dag=dag,
)

def process_data():
    """Process the data"""
    print("âœ… All conditions met - processing data")

process_task = PythonOperator(
    task_id='process_data',
    python_callable=process_data,
    dag=dag,
)

# All sensors must complete before processing
[wait_for_file, wait_for_api, wait_for_business_hours] >> process_task</div>
            </div>

            <div class="success-card" style="margin-top: 40px;">
                <h3 style="margin-top: 0;">ğŸ’¡ ×˜×™×¤×™× ×œ×©×™××•×© ×‘×“×•×’×××•×ª</h3>
                <ul>
                    <li>×”×¢×ª×§ ××ª ×”×§×•×“ ×œ×ª×™×§×™×™×ª <code>dags/</code> ×©×œ Airflow</li>
                    <li>×”×ª×× ××ª ×”-Connections ×‘-Airflow UI (Admin â†’ Connections)</li>
                    <li>×©× ×” ××ª ×”-start_date ×œ×ª××¨×™×š ×¨×œ×•×•× ×˜×™</li>
                    <li>×”×ª×× ××ª ×”-schedule_interval ×œ×¦×¨×›×™× ×©×œ×š</li>
                    <li>×”×•×¡×£ error handling ××ª××™× ×œ×¡×‘×™×‘×ª ×”×¤×¨×•×“×§×©×Ÿ</li>
                    <li>×‘×“×•×§ ××ª ×”×§×•×“ ×¢× <code>python my_dag.py</code> ×œ×¤× ×™ deploy</li>
                    <li>×”×©×ª××© ×‘-<code>airflow dags test</code> ×œ×‘×“×™×§×” ××§×•××™×ª</li>
                </ul>
            </div>

            <div class="info-card" style="margin-top: 30px;">
                <h3 style="margin-top: 0;">ğŸ“‹ Quick Reference - Jinja Templates</h3>
                <p>××©×ª× ×™× ×–××™× ×™× ×‘×›×œ task:</p>
                <table class="reference-table" style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th style="text-align: left; direction: ltr;">Template Variable</th>
                            <th>×ª×™××•×¨</th>
                            <th>×“×•×’××”</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>{{ ds }}</code></td>
                            <td>Execution date (YYYY-MM-DD)</td>
                            <td>2024-01-15</td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>{{ ds_nodash }}</code></td>
                            <td>Execution date ×œ×œ× ××§×¤×™×</td>
                            <td>20240115</td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>{{ dag }}</code></td>
                            <td>DAG object</td>
                            <td>{{ dag.dag_id }}</td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>{{ task }}</code></td>
                            <td>Task object</td>
                            <td>{{ task.task_id }}</td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>{{ ti }}</code></td>
                            <td>TaskInstance object</td>
                            <td>{{ ti.xcom_pull(...) }}</td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>{{ execution_date }}</code></td>
                            <td>Execution datetime object</td>
                            <td>datetime object</td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>{{ prev_ds }}</code></td>
                            <td>Previous execution date</td>
                            <td>2024-01-14</td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>{{ next_ds }}</code></td>
                            <td>Next execution date</td>
                            <td>2024-01-16</td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>{{ macros.ds_add(ds, 7) }}</code></td>
                            <td>×”×•×¡×¤×ª ×™××™× ×œ×ª××¨×™×š</td>
                            <td>2024-01-22 (+ 7 days)</td>
                        </tr>
                    </tbody>
                </table>

                <h4 style="margin-top: 25px;">×“×•×’×××•×ª ×©×™××•×©:</h4>
                <div class="code-block"># BashOperator ×¢× templates
process_file = BashOperator(
    task_id='process',
    bash_command='python process.py --date {{ ds }} --output /data/{{ ds_nodash }}/',
)

# PythonOperator ×¢× templates
def my_function(ds, **context):
    print(f"Processing date: {ds}")
    # ds is automatically passed!

task = PythonOperator(
    task_id='my_task',
    python_callable=my_function,
    provide_context=True,
)

# SQL ×¢× templates
sql_task = PostgresOperator(
    task_id='insert_data',
    sql="""
        INSERT INTO daily_stats (date, value)
        VALUES ('{{ ds }}', {{ ti.xcom_pull(task_ids='calc') }});
    """,
)</div>
            </div>
        </div>
    </div>

    <!-- === EXERCISES VIEW === -->
    <div id="view-exercises" class="view-section">
        <div class="exercise-list" style="padding: 40px;">
            <div style="text-align: center; margin-bottom: 50px;">
                <h1 style="font-size: 2.5rem; margin-bottom: 12px; font-weight: 800; color: var(--text-primary);">ğŸ“ ×ª×¨×’×™×œ×™× ××¢×©×™×™×</h1>
                <p style="color: var(--text-secondary); font-size: 1.1rem;">×ª×¨×’×œ×• ××ª ×”× ×•×©××™× ×©×œ××“×ª×</p>
            </div>

            <!-- Exercise 1 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 1</span>
                        <span class="ex-title">×™×¦×™×¨×ª DAG ×¨××©×•×Ÿ</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×¦×•×¨ DAG ×¤×©×•×˜ ×¢× 3 tasks ×©×¨×¦×™× ×‘×¨×¦×£.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>Task 1: ×”×“×¤×¡ ××ª ×”×ª××¨×™×š ×”× ×•×›×—×™ (BashOperator)</li>
                        <li>Task 2: ×¦×•×¨ ×¨×©×™××” ×©×œ 5 ××¡×¤×¨×™× ××§×¨××™×™× (PythonOperator)</li>
                        <li>Task 3: ×”×“×¤×¡ "Pipeline completed!" (BashOperator)</li>
                        <li>schedule_interval: ×¨×™×¦×” ×™×•××™×ª</li>
                        <li>start_date: 1 ×‘×™× ×•××¨ 2024</li>
                    </ul>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.operators.bash import BashOperator
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta
import random

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
    'retries': 1,
}

dag = DAG(
    'my_first_dag',
    default_args=default_args,
    description='My first practice DAG',
    schedule_interval='@daily',
    catchup=False,
)

def generate_random_numbers():
    """Generate 5 random numbers"""
    numbers = [random.randint(1, 100) for _ in range(5)]
    print(f"Random numbers: {numbers}")
    return numbers

# Task 1
print_date = BashOperator(
    task_id='print_date',
    bash_command='date',
    dag=dag,
)

# Task 2
generate_numbers = PythonOperator(
    task_id='generate_numbers',
    python_callable=generate_random_numbers,
    dag=dag,
)

# Task 3
print_done = BashOperator(
    task_id='print_done',
    bash_command='echo "Pipeline completed!"',
    dag=dag,
)

# Dependencies
print_date >> generate_numbers >> print_done</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 2 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 2</span>
                        <span class="ex-title">×¢×‘×•×“×” ×¢× XCom</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×¦×•×¨ DAG ×©××©×ª××© ×‘-XCom ×œ×”×¢×‘×¨×ª ××™×“×¢ ×‘×™×Ÿ tasks.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>Task 1: ×—×©×‘ ×¡×›×•× ×©×œ ××¡×¤×¨×™× 1-100 ×•×”×¢×‘×¨ ×“×¨×š XCom</li>
                        <li>Task 2: ×§×‘×œ ××ª ×”×¡×›×•× ×•×—×©×‘ ×××•×¦×¢</li>
                        <li>Task 3: ×”×“×¤×¡ ××ª ×”×ª×•×¦××•×ª</li>
                        <li>×”×©×ª××© ×‘-xcom_push ×•-xcom_pull</li>
                    </ul>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from datetime import datetime

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'xcom_practice_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
)

def calculate_sum(**context):
    """Calculate sum of 1-100"""
    total = sum(range(1, 101))

    # Method 1: Explicit push
    context['ti'].xcom_push(key='total_sum', value=total)

    # Method 2: Return value (auto-pushed as 'return_value')
    return total

def calculate_average(**context):
    """Calculate average"""
    ti = context['ti']

    # Pull from XCom
    total = ti.xcom_pull(task_ids='calc_sum', key='total_sum')
    average = total / 100

    print(f"Total: {total}, Average: {average}")

    return average

def print_results(**context):
    """Print final results"""
    ti = context['ti']

    total = ti.xcom_pull(task_ids='calc_sum')  # Gets return_value
    avg = ti.xcom_pull(task_ids='calc_average')

    print(f"""
    Results:
    ========
    Sum (1-100): {total}
    Average: {avg}
    """)

calc_sum_task = PythonOperator(
    task_id='calc_sum',
    python_callable=calculate_sum,
    provide_context=True,
    dag=dag,
)

calc_avg_task = PythonOperator(
    task_id='calc_average',
    python_callable=calculate_average,
    provide_context=True,
    dag=dag,
)

print_task = PythonOperator(
    task_id='print_results',
    python_callable=print_results,
    provide_context=True,
    dag=dag,
)

calc_sum_task >> calc_avg_task >> print_task</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 3 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 3</span>
                        <span class="ex-title">Branching Logic</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×¦×•×¨ DAG ×¢× ×œ×•×’×™×§×ª branching - ×ª× ××™ ×©×§×•×‘×¢ ××™×–×” task ×™×¨×•×¥.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>Task ×¨××©×•×Ÿ: ×‘×“×•×§ ×× ×”×™×•× ×”×•× ×™×•× ×—×•×œ (1-5) ××• ×¡×•×£ ×©×‘×•×¢ (6-7)</li>
                        <li>×× ×™×•× ×—×•×œ: ×”×¨×¥ task "process_weekday"</li>
                        <li>×× ×¡×•×£ ×©×‘×•×¢: ×”×¨×¥ task "process_weekend"</li>
                        <li>Task ××—×¨×•×Ÿ ×©×ª××™×“ ×¨×¥: "final_step"</li>
                        <li>×”×©×ª××© ×‘-BranchPythonOperator</li>
                    </ul>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator, BranchPythonOperator
from airflow.operators.bash import BashOperator
from datetime import datetime
from airflow.utils.trigger_rule import TriggerRule

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'branching_practice_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
)

def check_day_of_week(**context):
    """Check if weekday or weekend"""
    execution_date = context['execution_date']
    day_of_week = execution_date.weekday()  # Monday=0, Sunday=6

    print(f"Day of week: {day_of_week}")

    if day_of_week < 5:  # Monday-Friday
        return 'process_weekday'
    else:
        return 'process_weekend'

def process_weekday():
    print("ğŸ“… Processing weekday data")

def process_weekend():
    print("ğŸ–ï¸ Processing weekend data")

# Tasks
check_day = BranchPythonOperator(
    task_id='check_day',
    python_callable=check_day_of_week,
    provide_context=True,
    dag=dag,
)

weekday_task = PythonOperator(
    task_id='process_weekday',
    python_callable=process_weekday,
    dag=dag,
)

weekend_task = PythonOperator(
    task_id='process_weekend',
    python_callable=process_weekend,
    dag=dag,
)

final_task = BashOperator(
    task_id='final_step',
    bash_command='echo "Pipeline done"',
    trigger_rule=TriggerRule.NONE_FAILED_MIN_ONE_SUCCESS,
    dag=dag,
)

# Dependencies
check_day >> [weekday_task, weekend_task] >> final_task</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 4 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 4</span>
                        <span class="ex-title">Database Operations</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×¦×•×¨ DAG ×©×¢×•×‘×“ ×¢× PostgreSQL.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>×¦×•×¨ ×˜×‘×œ×” ×‘×©× "daily_stats"</li>
                        <li>×”×›× ×¡ × ×ª×•× ×™× ×¡×˜×˜×™×¡×˜×™×™× (×ª××¨×™×š, ×¡×¤×™×¨×”, ×¡×›×•×)</li>
                        <li>×§×¨× ××ª ×”× ×ª×•× ×™× ×•×”×“×¤×¡ ××•×ª×</li>
                        <li>×”×©×ª××© ×‘-PostgresOperator ×•-PostgresHook</li>
                    </ul>

                    <div class="warning-card" style="margin: 15px 0;">
                        <p><strong>×”×¢×¨×”:</strong> ×ª×¦×˜×¨×š ×œ×”×’×“×™×¨ Connection ×‘-Airflow UI:</p>
                        <code style="background: white; padding: 8px; display: block; border-radius: 4px; margin-top: 10px;">
                        Admin â†’ Connections â†’ Add<br>
                        Connection Id: postgres_default<br>
                        Connection Type: Postgres<br>
                        Host: localhost<br>
                        Schema: airflow<br>
                        Login: airflow<br>
                        Password: airflow<br>
                        Port: 5432
                        </code>
                    </div>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.providers.postgres.operators.postgres import PostgresOperator
from airflow.providers.postgres.hooks.postgres import PostgresHook
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta

default_args = {
    'owner': 'data_team',
    'start_date': datetime(2024, 1, 1),
    'retries': 1,
}

dag = DAG(
    'postgres_practice_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
)

# Task 1: Create table
create_table = PostgresOperator(
    task_id='create_table',
    postgres_conn_id='postgres_default',
    sql="""
        CREATE TABLE IF NOT EXISTS daily_stats (
            id SERIAL PRIMARY KEY,
            date DATE NOT NULL,
            record_count INTEGER,
            total_amount DECIMAL(10,2),
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        );
    """,
    dag=dag,
)

# Task 2: Insert data
insert_data = PostgresOperator(
    task_id='insert_data',
    postgres_conn_id='postgres_default',
    sql="""
        INSERT INTO daily_stats (date, record_count, total_amount)
        VALUES (
            '{{ ds }}',
            {{ params.count }},
            {{ params.amount }}
        );
    """,
    params={'count': 1500, 'amount': 45000.50},
    dag=dag,
)

# Task 3: Read and print data
def read_stats(**context):
    """Read data from database"""
    hook = PostgresHook(postgres_conn_id='postgres_default')

    sql = """
        SELECT date, record_count, total_amount
        FROM daily_stats
        ORDER BY date DESC
        LIMIT 5
    """

    df = hook.get_pandas_df(sql)
    print("Recent Stats:")
    print(df.to_string())

read_task = PythonOperator(
    task_id='read_stats',
    python_callable=read_stats,
    provide_context=True,
    dag=dag,
)

# Dependencies
create_table >> insert_data >> read_task</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 5 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 5</span>
                        <span class="ex-title">Dynamic Task Generation</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×¦×•×¨ DAG ×©×™×•×¦×¨ tasks ×‘××•×¤×Ÿ ×“×™× ××™.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>×¦×•×¨ 5 tasks ×‘××§×‘×™×œ ×©××¢×‘×“×™× ×§×‘×¦×™× ×©×•× ×™×</li>
                        <li>×›×œ task ××¢×‘×“ ×§×•×‘×¥ ×¢× ×©× ×©×•× ×” (file_1.csv, file_2.csv, ...)</li>
                        <li>×œ××—×¨ ×©×›×œ ×”-tasks ××¡×™×™××™×, ×”×¨×¥ task ××¡×›×</li>
                        <li>×”×©×ª××© ×‘-loop ×œ×™×¦×™×¨×ª tasks ×“×™× ××™×ª</li>
                    </ul>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.operators.bash import BashOperator
from datetime import datetime

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'dynamic_tasks_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
)

def process_file(file_name):
    """Process a specific file"""
    print(f"Processing {file_name}")
    # Simulate processing
    import time
    time.sleep(2)
    print(f"Completed processing {file_name}")

def summarize_results(**context):
    """Summarize all processing results"""
    print("All files processed successfully!")

# Start task
start = BashOperator(
    task_id='start',
    bash_command='echo "Starting file processing"',
    dag=dag,
)

# Dynamically create tasks
process_tasks = []
for i in range(1, 6):
    task = PythonOperator(
        task_id=f'process_file_{i}',
        python_callable=process_file,
        op_kwargs={'file_name': f'file_{i}.csv'},
        dag=dag,
    )
    process_tasks.append(task)

# Summary task
summary = PythonOperator(
    task_id='summarize',
    python_callable=summarize_results,
    provide_context=True,
    dag=dag,
)

# Dependencies: start â†’ [all process tasks] â†’ summary
start >> process_tasks >> summary</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 6 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 6</span>
                        <span class="ex-title">Error Handling & Retries</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×¦×•×¨ DAG ×¢× ×˜×™×¤×•×œ ×‘×©×’×™××•×ª ×•-retry logic.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>Task ×©×™×›×•×œ ×œ×”×™×›×©×œ (50% ×¡×™×›×•×™)</li>
                        <li>×”×’×“×¨ 3 retries ×¢× delay ×©×œ 2 ×“×§×•×ª</li>
                        <li>Task ×©×¨×¥ ×¨×§ ×¢×œ ×”×¦×œ×—×”</li>
                        <li>Task ×©×¨×¥ ×¨×§ ×¢×œ ×›×©×œ×•×Ÿ</li>
                        <li>×”×©×ª××© ×‘-trigger_rule</li>
                    </ul>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.utils.trigger_rule import TriggerRule
from datetime import datetime, timedelta
import random

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
    'retries': 3,  # Will retry 3 times
    'retry_delay': timedelta(minutes=2),
}

dag = DAG(
    'error_handling_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
)

def risky_operation(**context):
    """Operation that might fail"""
    # Simulate 50% failure rate
    if random.random() < 0.5:
        raise Exception("âŒ Operation failed - retrying...")

    print("âœ… Operation succeeded!")
    return "success"

def on_success(**context):
    """Runs only on success"""
    print("ğŸ‰ Task succeeded - sending success notification")

def on_failure(**context):
    """Runs only on failure (after all retries)"""
    print("âš ï¸ Task failed after retries - sending alert")

# Risky task
risky_task = PythonOperator(
    task_id='risky_operation',
    python_callable=risky_operation,
    provide_context=True,
    dag=dag,
)

# Success handler
success_task = PythonOperator(
    task_id='on_success',
    python_callable=on_success,
    provide_context=True,
    trigger_rule=TriggerRule.ALL_SUCCESS,
    dag=dag,
)

# Failure handler
failure_task = PythonOperator(
    task_id='on_failure',
    python_callable=on_failure,
    provide_context=True,
    trigger_rule=TriggerRule.ALL_FAILED,
    dag=dag,
)

# Dependencies
risky_task >> [success_task, failure_task]</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 7 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 7</span>
                        <span class="ex-title">TaskGroups - ××¨×’×•×Ÿ ××©×™××•×ª</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×¦×•×¨ DAG ×¢× TaskGroups ×œ××¨×’×•×Ÿ tasks ×‘×¦×•×¨×” ×”×™×¨××¨×›×™×ª.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>TaskGroup "data_ingestion" ×¢× 3 tasks (API, DB, Files)</li>
                        <li>TaskGroup "processing" ×¢× 2 tasks (validate, transform)</li>
                        <li>Task ××¡×›× ×‘×¡×•×£</li>
                        <li>×”×©×ª××© ×‘-<code>with TaskGroup(...)</code> syntax</li>
                    </ul>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.operators.bash import BashOperator
from airflow.utils.task_group import TaskGroup
from datetime import datetime

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'taskgroup_practice_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
)

# Start
start = BashOperator(
    task_id='start',
    bash_command='echo "Pipeline started"',
    dag=dag,
)

# TaskGroup 1: Data Ingestion
with TaskGroup('data_ingestion', dag=dag) as ingestion:
    ingest_api = PythonOperator(
        task_id='ingest_from_api',
        python_callable=lambda: print("ğŸ“¥ Ingesting from API"),
    )

    ingest_db = PythonOperator(
        task_id='ingest_from_db',
        python_callable=lambda: print("ğŸ“¥ Ingesting from Database"),
    )

    ingest_files = PythonOperator(
        task_id='ingest_from_files',
        python_callable=lambda: print("ğŸ“¥ Ingesting from Files"),
    )

# TaskGroup 2: Processing
with TaskGroup('processing', dag=dag) as processing:
    validate = PythonOperator(
        task_id='validate_data',
        python_callable=lambda: print("âœ… Validating data"),
    )

    transform = PythonOperator(
        task_id='transform_data',
        python_callable=lambda: print("ğŸ”„ Transforming data"),
    )

    # Internal dependencies within group
    validate >> transform

# Final task
complete = BashOperator(
    task_id='complete',
    bash_command='echo "Pipeline completed!"',
    dag=dag,
)

# Main flow: start â†’ ingestion â†’ processing â†’ complete
start >> ingestion >> processing >> complete</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 8 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 8</span>
                        <span class="ex-title">Sensors - ×”××ª× ×” ×œ×ª× ××™×</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×¦×•×¨ DAG ×©××©×ª××© ×‘-Sensors ×œ×”××ª× ×” ×œ××™×¨×•×¢×™×.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>FileSensor: ×—×›×” ×œ×§×•×‘×¥ <code>/data/input.csv</code></li>
                        <li>PythonSensor: ×—×›×” ×¢×“ ×©×”×©×¢×” ××—×¨×™ 09:00</li>
                        <li>×›××©×¨ ×©× ×™ ×”×ª× ××™× ××ª×§×™×™××™× - ×¢×‘×“ ××ª ×”×§×•×‘×¥</li>
                        <li>×”×’×“×¨ timeout ×•-poke_interval</li>
                    </ul>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.sensors.filesystem import FileSensor
from airflow.sensors.python import PythonSensor
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'sensors_practice_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
)

# Sensor 1: Wait for file
wait_for_file = FileSensor(
    task_id='wait_for_file',
    filepath='/data/input.csv',
    poke_interval=30,  # Check every 30 seconds
    timeout=600,  # Max 10 minutes
    dag=dag,
)

# Sensor 2: Wait for time
def check_time():
    """Check if after 9 AM"""
    from datetime import datetime
    now = datetime.now()
    return now.hour >= 9

wait_for_time = PythonSensor(
    task_id='wait_for_time',
    python_callable=check_time,
    poke_interval=60,  # Check every minute
    timeout=3600,  # Max 1 hour
    mode='reschedule',  # Free up worker while waiting
    dag=dag,
)

# Processing task
def process_file():
    """Process the file"""
    import pandas as pd
    df = pd.read_csv('/data/input.csv')
    print(f"Processing {len(df)} records")
    # Your processing logic here

process = PythonOperator(
    task_id='process_file',
    python_callable=process_file,
    dag=dag,
)

# Both sensors must complete
[wait_for_file, wait_for_time] >> process</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 9 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 9</span>
                        <span class="ex-title">Jinja Templates - Templates ××ª×§×“××™×</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×”×©×ª××© ×‘-Jinja templates ×œ×¢×‘×•×“×” ×“×™× ××™×ª ×¢× ×ª××¨×™×›×™×.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>×¦×•×¨ task ×©××¢×‘×“ ×§×‘×¦×™× ×œ×¤×™ ×˜×•×•×— ×ª××¨×™×›×™×</li>
                        <li>×”×©×ª××© ×‘-<code>{{ ds }}</code>, <code>{{ prev_ds }}</code></li>
                        <li>×¦×•×¨ path ×“×™× ××™: <code>/data/{{ ds_nodash }}/</code></li>
                        <li>×”×¢×‘×¨ parameters ×¢× <code>macros.ds_add()</code></li>
                    </ul>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.operators.bash import BashOperator
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta

default_args = {
    'owner': 'airflow',
    'start_date': datetime(2024, 1, 1),
}

dag = DAG(
    'jinja_templates_dag',
    default_args=default_args,
    schedule_interval='@daily',
    catchup=False,
)

# Task 1: Process with template paths
process_daily_file = BashOperator(
    task_id='process_daily',
    bash_command="""
        echo "Processing date: {{ ds }}"
        echo "Input: /data/input/{{ ds_nodash }}.csv"
        echo "Output: /data/output/{{ ds_nodash }}/"
        echo "Previous date: {{ prev_ds }}"
        echo "Next date: {{ next_ds }}"
    """,
    dag=dag,
)

# Task 2: Process range of dates
process_week = BashOperator(
    task_id='process_week',
    bash_command="""
        echo "Week start: {{ ds }}"
        echo "Week end: {{ macros.ds_add(ds, 7) }}"
        echo "Last month: {{ macros.ds_add(ds, -30) }}"
    """,
    dag=dag,
)

# Task 3: Use templates in Python
def process_with_templates(ds, prev_ds, **context):
    """Access template variables in Python"""
    print(f"Current date: {ds}")
    print(f"Previous date: {prev_ds}")

    execution_date = context['execution_date']
    print(f"Full datetime: {execution_date}")

    # Access macros
    ti = context['ti']
    print(f"Task ID: {ti.task_id}")
    print(f"DAG ID: {ti.dag_id}")

python_templates = PythonOperator(
    task_id='python_with_templates',
    python_callable=process_with_templates,
    provide_context=True,
    dag=dag,
)

process_daily_file >> process_week >> python_templates</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 10 -->
            <div class="exercise-card">
                <div class="ex-header">
                    <div style="display: flex; align-items: center; gap: 15px; flex: 1;">
                        <span class="ex-number">×ª×¨×’×™×œ 10</span>
                        <span class="ex-title">×¤×¨×•×™×§×˜ ××¡×›×: ETL Pipeline ××œ×</span>
                    </div>
                </div>
                <div class="ex-content">
                    <h3>××˜×¨×”:</h3>
                    <p>×¦×•×¨ ETL pipeline ××œ× ×”××©×œ×‘ ××ª ×›×œ ××” ×©×œ××“×ª.</p>

                    <h3>×“×¨×™×©×•×ª:</h3>
                    <ul>
                        <li>×—×›×” ×œ×§×•×‘×¥ CSV (FileSensor)</li>
                        <li>×§×¨× ××ª ×”×§×•×‘×¥ ×•-validate ××ª ×”× ×ª×•× ×™×</li>
                        <li>×”×¢×‘×¨ ××ª ×”× ×ª×•× ×™× (uppercase, ×”×•×¡×£ timestamps)</li>
                        <li>×˜×¢×Ÿ ×œ-PostgreSQL</li>
                        <li>×©×œ×— ××™××™×™×œ ×¢×œ ×”×¦×œ×—×”/×›×©×œ×•×Ÿ</li>
                        <li>×”×©×ª××© ×‘-XCom, Templates, Error Handling</li>
                    </ul>

                    <button class="solution-toggle" onclick="toggleSolution(this)">ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ</button>
                    <div class="solution-content">
                        <div class="code-block">from airflow import DAG
from airflow.sensors.filesystem import FileSensor
from airflow.operators.python import PythonOperator
from airflow.providers.postgres.hooks.postgres import PostgresHook
from airflow.operators.email import EmailOperator
from airflow.utils.trigger_rule import TriggerRule
from datetime import datetime, timedelta
import pandas as pd

default_args = {
    'owner': 'data_team',
    'start_date': datetime(2024, 1, 1),
    'retries': 2,
    'retry_delay': timedelta(minutes=5),
    'email': ['team@example.com'],
    'email_on_failure': True,
}

dag = DAG(
    'complete_etl_pipeline',
    default_args=default_args,
    description='Complete ETL pipeline with all features',
    schedule_interval='@daily',
    catchup=False,
    tags=['etl', 'production', 'complete'],
)

# 1. Wait for file
wait_for_data = FileSensor(
    task_id='wait_for_input_file',
    filepath='/data/input/sales_{{ ds }}.csv',
    poke_interval=60,
    timeout=1800,
    dag=dag,
)

# 2. Extract & Validate
def extract_and_validate(**context):
    """Extract data and validate"""
    filepath = '/data/input/sales_{{ ds }}.csv'
    df = pd.read_csv(filepath)

    # Validation
    required_columns = ['product', 'quantity', 'price', 'date']
    missing = set(required_columns) - set(df.columns)

    if missing:
        raise ValueError(f"Missing columns: {missing}")

    # Check for nulls
    null_counts = df[required_columns].isnull().sum()
    if null_counts.any():
        raise ValueError(f"Found null values: {null_counts[null_counts > 0]}")

    print(f"âœ… Validated {len(df)} records")
    context['ti'].xcom_push(key='record_count', value=len(df))

    return filepath

extract_task = PythonOperator(
    task_id='extract_validate',
    python_callable=extract_and_validate,
    provide_context=True,
    dag=dag,
)

# 3. Transform
def transform_data(**context):
    """Transform the data"""
    ti = context['ti']
    filepath = ti.xcom_pull(task_ids='extract_validate')

    df = pd.read_csv(filepath)

    # Transformations
    df['product'] = df['product'].str.upper()
    df['total'] = df['quantity'] * df['price']
    df['processed_at'] = datetime.now()
    df['execution_date'] = context['ds']

    # Save transformed data
    output_path = '/tmp/transformed_{{ ds }}.csv'
    df.to_csv(output_path, index=False)

    print(f"âœ… Transformed {len(df)} records")
    ti.xcom_push(key='transformed_path', value=output_path)

transform_task = PythonOperator(
    task_id='transform_data',
    python_callable=transform_data,
    provide_context=True,
    dag=dag,
)

# 4. Load to Database
def load_to_database(**context):
    """Load data to PostgreSQL"""
    ti = context['ti']
    filepath = ti.xcom_pull(task_ids='transform_data', key='transformed_path')

    df = pd.read_csv(filepath)

    hook = PostgresHook(postgres_conn_id='postgres_default')

    # Insert data
    hook.insert_rows(
        table='sales',
        rows=df.values.tolist(),
        target_fields=df.columns.tolist()
    )

    print(f"âœ… Loaded {len(df)} records to database")
    ti.xcom_push(key='loaded_count', value=len(df))

load_task = PythonOperator(
    task_id='load_to_database',
    python_callable=load_to_database,
    provide_context=True,
    dag=dag,
)

# 5. Success Email
def generate_success_report(**context):
    """Generate success email content"""
    ti = context['ti']
    count = ti.xcom_pull(task_ids='load_to_database', key='loaded_count')

    return f"""
    <html>
    <body>
        <h2 style="color: green;">âœ… ETL Pipeline Completed</h2>
        <p><strong>Date:</strong> {context['ds']}</p>
        <p><strong>Records Processed:</strong> {count:,}</p>
        <p><strong>DAG:</strong> {context['dag'].dag_id}</p>
        <p><strong>Status:</strong> Success</p>
    </body>
    </html>
    """

success_email = EmailOperator(
    task_id='send_success_email',
    to='team@example.com',
    subject='âœ… Daily ETL Completed - {{ ds }}',
    html_content="{{ ti.xcom_pull(task_ids='generate_report') }}",
    trigger_rule=TriggerRule.ALL_SUCCESS,
    dag=dag,
)

# 6. Failure Email
failure_email = EmailOperator(
    task_id='send_failure_email',
    to='alerts@example.com',
    subject='âŒ Daily ETL Failed - {{ ds }}',
    html_content="""
    <h3 style="color: red;">ETL Pipeline Failed!</h3>
    <p><b>Date:</b> {{ ds }}</p>
    <p><b>DAG:</b> {{ dag.dag_id }}</p>
    <p>Please check the logs immediately!</p>
    """,
    trigger_rule=TriggerRule.ONE_FAILED,
    dag=dag,
)

# Flow
wait_for_data >> extract_task >> transform_task >> load_task >> success_email
load_task >> failure_email</div>
                    </div>
                </div>
            </div>

            <div class="success-card" style="margin-top: 40px;">
                <h3 style="margin-top: 0;">ğŸ“ ×¡×™×™××ª ××ª ×›×œ ×”×ª×¨×’×™×œ×™×!</h3>
                <p>×¢×›×©×™×• ××ª×” ××•×›×Ÿ:</p>
                <ul>
                    <li>âœ… ×œ×™×¦×•×¨ DAGs ××•×¨×›×‘×™×</li>
                    <li>âœ… ×œ×”×©×ª××© ×‘-XCom ×œ×ª×§×©×•×¨×ª ×‘×™×Ÿ tasks</li>
                    <li>âœ… ×œ×™×™×©× branching logic</li>
                    <li>âœ… ×œ×¢×‘×•×“ ×¢× Databases</li>
                    <li>âœ… ×œ×™×¦×•×¨ tasks ×‘××•×¤×Ÿ ×“×™× ××™</li>
                    <li>âœ… ×œ×˜×¤×œ ×‘×©×’×™××•×ª × ×›×•×Ÿ</li>
                    <li>âœ… ×œ××¨×’×Ÿ ×§×•×“ ×¢× TaskGroups</li>
                    <li>âœ… ×œ×”×©×ª××© ×‘-Sensors</li>
                    <li>âœ… ×œ×¢×‘×•×“ ×¢× Templates</li>
                    <li>âœ… ×œ×‘× ×•×ª ETL pipeline ××œ×!</li>
                </ul>
                <p style="margin-top: 20px; font-weight: 600;">ğŸ’ª ×”××©×š ×œ-Best Practices ×•-Production Tips!</p>
            </div>

        </div>
    </div>

    <!-- === CLI VIEW === -->
    <div id="view-cli" class="view-section">
        <div style="padding: 60px; max-width: 1400px; margin: 0 auto;">
            <h1 style="font-size: 2.5rem; margin-bottom: 20px; text-align: center;">âŒ¨ï¸ Airflow CLI - ××“×¨×™×š ××¢×©×™</h1>
            <p style="text-align: center; font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 50px;">
                ×¤×§×•×“×•×ª ×—×™×•× ×™×•×ª ×œ× ×™×”×•×œ ×•-debugging ×©×œ Airflow
            </p>

            <!-- DAG Commands -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0;">ğŸ“‹ ×¤×§×•×“×•×ª DAG</h2>

                <table class="reference-table">
                    <thead>
                        <tr>
                            <th style="text-align: left; direction: ltr;">×¤×§×•×“×”</th>
                            <th>×ª×™××•×¨</th>
                            <th>×“×•×’××”</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow dags list</code></td>
                            <td>×¨×©×™××ª ×›×œ ×”-DAGs</td>
                            <td><code>airflow dags list</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow dags trigger</code></td>
                            <td>×”×¤×¢×œ×” ×™×“× ×™×ª ×©×œ DAG</td>
                            <td><code>airflow dags trigger my_dag</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow dags pause</code></td>
                            <td>×”×©×”×™×™×ª DAG</td>
                            <td><code>airflow dags pause my_dag</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow dags unpause</code></td>
                            <td>×”×¤×¢×œ×” ××—×“×© ×©×œ DAG</td>
                            <td><code>airflow dags unpause my_dag</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow dags test</code></td>
                            <td>×‘×“×™×§×ª DAG ×œ×œ× ×©××™×¨×” ×‘-DB</td>
                            <td><code>airflow dags test my_dag 2024-01-01</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow dags backfill</code></td>
                            <td>×”×¨×¦×” ×œ××—×•×¨ ×¢×œ ×˜×•×•×— ×ª××¨×™×›×™×</td>
                            <td><code>airflow dags backfill -s 2024-01-01 -e 2024-01-10 my_dag</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow dags delete</code></td>
                            <td>××—×™×§×ª DAG + metadata</td>
                            <td><code>airflow dags delete my_dag</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Task Commands -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0;">âš™ï¸ ×¤×§×•×“×•×ª Task</h2>

                <table class="reference-table">
                    <thead>
                        <tr>
                            <th style="text-align: left; direction: ltr;">×¤×§×•×“×”</th>
                            <th>×ª×™××•×¨</th>
                            <th>×“×•×’××”</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow tasks list</code></td>
                            <td>×¨×©×™××ª tasks ×‘-DAG</td>
                            <td><code>airflow tasks list my_dag</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow tasks test</code></td>
                            <td>×”×¨×¦×ª task ×™×—×™×“ ×œ×‘×“×™×§×”</td>
                            <td><code>airflow tasks test my_dag task1 2024-01-01</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow tasks run</code></td>
                            <td>×”×¨×¦×ª task ×¢× ×©××™×¨×” ×‘-DB</td>
                            <td><code>airflow tasks run my_dag task1 2024-01-01</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow tasks clear</code></td>
                            <td>× ×™×§×•×™ ×¡×˜×˜×•×¡ task (×œ×”×¨×¦×” ××—×“×©)</td>
                            <td><code>airflow tasks clear my_dag -t task1</code></td>
                        </tr>
                        <tr>
                            <td style="direction: ltr; text-align: left;"><code>airflow tasks states-for-dag-run</code></td>
                            <td>×¡×˜×˜×•×¡ ×›×œ ×”-tasks ×‘×”×¨×¦×” ×¡×¤×¦×™×¤×™×ª</td>
                            <td><code>airflow tasks states-for-dag-run my_dag 2024-01-01</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Database Commands -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0;">ğŸ—„ï¸ ×¤×§×•×“×•×ª Database</h2>
                <div class="code-block"># Initialize database (first time only)
airflow db init

# Upgrade database to latest version
airflow db upgrade

# Reset database (âš ï¸ deletes all data!)
airflow db reset

# Check database connection
airflow db check</div>
            </div>

            <!-- User Commands -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0;">ğŸ‘¤ × ×™×”×•×œ ××©×ª××©×™×</h2>
                <div class="code-block"># Create admin user
airflow users create \
    --username admin \
    --firstname Admin \
    --lastname User \
    --role Admin \
    --email admin@example.com \
    --password admin

# List all users
airflow users list

# Delete user
airflow users delete --username user1</div>
            </div>

            <!-- Connections & Variables -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0;">ğŸ”Œ Connections & Variables</h2>
                <div class="code-block"># List connections
airflow connections list

# Add connection
airflow connections add 'my_postgres' \
    --conn-type 'postgres' \
    --conn-host 'localhost' \
    --conn-schema 'mydb' \
    --conn-login 'user' \
    --conn-password 'pass' \
    --conn-port 5432

# Export connections to file
airflow connections export connections.json

# Import connections from file
airflow connections import connections.json

# ===== Variables =====

# List variables
airflow variables list

# Set variable
airflow variables set my_key my_value

# Get variable
airflow variables get my_key

# Delete variable
airflow variables delete my_key

# Import from JSON
airflow variables import variables.json</div>
            </div>

            <!-- Debugging Commands -->
            <div class="comparison-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0;">ğŸ” Debugging & Logs</h2>
                <div class="code-block"># View task logs
airflow tasks logs my_dag task1 2024-01-01

# Test DAG syntax
python /path/to/dag_file.py

# Render template
airflow tasks render my_dag task1 2024-01-01

# Check DAG dependencies
airflow dags show my_dag

# List DAG runs
airflow dags list-runs -d my_dag

# List task instances
airflow tasks list-instances -d my_dag -s 2024-01-01</div>
            </div>

            <!-- Useful Workflows -->
            <div class="success-card" style="margin-top: 40px;">
                <h3 style="margin-top: 0;">ğŸ’¡ Workflows × ×¤×•×¦×™×</h3>

                <h4>ğŸ› Debug DAG ×©×œ× ×¢×•×‘×“:</h4>
                <div class="code-block"># 1. Check syntax
python /path/to/your_dag.py

# 2. Test specific task
airflow tasks test my_dag task_name 2024-01-01

# 3. Check logs
airflow tasks logs my_dag task_name 2024-01-01

# 4. Check rendered template
airflow tasks render my_dag task_name 2024-01-01</div>

                <h4 style="margin-top: 25px;">ğŸ”„ Re-run failed task:</h4>
                <div class="code-block"># 1. Clear the failed task
airflow tasks clear my_dag -t failed_task -s 2024-01-01 -e 2024-01-01

# 2. Or clear entire DAG run
airflow dags clear my_dag -s 2024-01-01 -e 2024-01-01</div>

                <h4 style="margin-top: 25px;">ğŸ“Š Monitor DAG status:</h4>
                <div class="code-block"># List recent runs
airflow dags list-runs -d my_dag --state failed

# Check current running tasks
airflow tasks list-instances -d my_dag --state running</div>
            </div>
        </div>
    </div>

    <!-- === TROUBLESHOOTING VIEW === -->
    <div id="view-troubleshooting" class="view-section">
        <div style="padding: 60px; max-width: 1400px; margin: 0 auto;">
            <h1 style="font-size: 2.5rem; margin-bottom: 20px; text-align: center;">ğŸ”§ ××“×¨×™×š ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª</h1>
            <p style="text-align: center; font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 50px;">
                ×¤×ª×¨×•× ×•×ª ×œ×‘×¢×™×•×ª ×”× ×¤×•×¦×•×ª ×‘×™×•×ª×¨ ×‘-Airflow
            </p>

            <!-- Issue 1: DAG not appearing -->
            <div class="warning-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-dark);">â“ DAG ×œ× ××•×¤×™×¢ ×‘-UI</h2>

                <h3>×¡×™××¤×˜×•××™×:</h3>
                <ul>
                    <li>×©××ª ×§×•×‘×¥ DAG ×‘×ª×™×§×™×™×” <code>dags/</code></li>
                    <li>×”×§×•×‘×¥ ×œ× ××•×¤×™×¢ ×‘-UI</li>
                    <li>××™×Ÿ ×©×’×™××•×ª ×‘-logs</li>
                </ul>

                <h3 style="margin-top: 25px;">âœ… ×¤×ª×¨×•× ×•×ª:</h3>

                <h4>1. ×‘×“×•×§ ×©×”×§×•×‘×¥ ×‘-Path ×”× ×›×•×Ÿ</h4>
                <div class="code-block"># ×‘×“×•×§ ××ª dags_folder ×‘-airflow.cfg
grep dags_folder ~/airflow/airflow.cfg

# ××•
airflow config get-value core dags_folder

# ×•×“× ×©×”×§×•×‘×¥ ×©×:
ls -la ~/airflow/dags/</div>

                <h4>2. ×‘×“×•×§ ×©××™×Ÿ ×©×’×™××•×ª ×‘×§×•×“</h4>
                <div class="code-block"># ×”×¨×¥ ××ª ×”×§×•×‘×¥ ×™×©×™×¨×•×ª
python ~/airflow/dags/my_dag.py

# ×× ×™×© ×©×’×™××”, ×”×™× ×ª×•×¤×™×¢ ×›××Ÿ!</div>

                <h4>3. ×‘×“×•×§ ××ª ×”-DAG_PROCESSING logs</h4>
                <div class="code-block"># Logs ×©×œ Scheduler
tail -f ~/airflow/logs/scheduler/latest/dag_processing_manager.log

# ×—×¤×© ×©×’×™××•×ª
grep -i error ~/airflow/logs/scheduler/latest/*.log</div>

                <h4>4. Refresh ×™×“× ×™</h4>
                <div class="code-block"># Restart scheduler
docker compose restart airflow-scheduler

# ××• ×× Local installation:
pkill -f "airflow scheduler"
airflow scheduler -D</div>

                <h4>5. ×‘×“×•×§ ×©×™×© ××©×ª× ×” DAG ×‘×§×•×‘×¥</h4>
                <div class="code-block"># ×”×§×•×‘×¥ ×—×™×™×‘ ×œ×”×›×™×œ ××©×ª× ×” ×‘×©× 'dag' ××• ×œ×”×©×ª××© ×‘-@dag decorator
dag = DAG('my_dag_id', ...)

# ××•
from airflow.decorators import dag

@dag(schedule_interval='@daily', start_date=...)
def my_dag():
    ...</div>
            </div>

            <!-- Issue 2: Task Failed -->
            <div class="warning-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-dark);">âŒ Task × ×›×©×œ</h2>

                <h3>××™×š ×œ× ×¤×•×ª ×‘××’×™×:</h3>

                <h4>1. ×‘×“×•×§ Logs</h4>
                <div class="code-block"># ×“×¨×š UI: ×œ×—×¥ ×¢×œ Task â†’ View Log

# ×“×¨×š CLI:
airflow tasks logs my_dag my_task 2024-01-01

# Logs ×××•×§××™× ×‘:
~/airflow/logs/my_dag/my_task/2024-01-01/1.log</div>

                <h4>2. ×”×¨×¥ Task ×‘××¦×‘ Test</h4>
                <div class="code-block"># Test mode - ×œ× ×©×•××¨ ×‘-DB, ××“×¤×™×¡ output ×™×©×™×¨×•×ª
airflow tasks test my_dag my_task 2024-01-01

# ×¢× output ×‘-stderr
airflow tasks test my_dag my_task 2024-01-01 2>&1 | less</div>

                <h4>3. ×‘×“×•×§ Template Rendering</h4>
                <div class="code-block"># ×‘×“×•×§ ××™×š Jinja templates ××ª×•×¨×’××™×
airflow tasks render my_dag my_task 2024-01-01

# ×™×¦×™×’ ××ª ×”×¢×¨×›×™× ×”×××™×ª×™×™× ×©×œ {{ ds }}, {{ ti }}, etc.</div>

                <h4>4. ×‘×“×•×§ XCom Values</h4>
                <div class="code-block"># List XComs for specific task
airflow tasks xcom-list my_dag my_task 2024-01-01

# Pull XCom value
airflow tasks xcom-pull my_dag my_task 2024-01-01 --key my_key</div>

                <h4>5. Debug Python Code</h4>
                <div class="code-block"># ×”×•×¡×£ breakpoint ×‘×§×•×“ ×©×œ×š
def my_function(**context):
    import pdb; pdb.set_trace()  # Python debugger
    # your code...

# ×”×¨×¥ ×¢× test
airflow tasks test my_dag my_task 2024-01-01</div>
            </div>

            <!-- Issue 3: Scheduler Issues -->
            <div class="warning-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-dark);">ğŸ”„ Scheduler ×œ× ××¨×™×¥ DAGs</h2>

                <h3>âœ… ×¤×ª×¨×•× ×•×ª:</h3>

                <h4>1. ×‘×“×•×§ ×©-Scheduler ×¨×¥</h4>
                <div class="code-block"># ×‘×“×•×§ processes
ps aux | grep "airflow scheduler"

# ××• ×¢× Docker:
docker ps | grep scheduler

# Logs ×©×œ scheduler
tail -f ~/airflow/logs/scheduler/latest/*.log</div>

                <h4>2. ×‘×“×•×§ ×©×”-DAG ×œ× paused</h4>
                <div class="code-block"># Unpause DAG
airflow dags unpause my_dag

# ××• ×‘-UI: ×œ×—×¥ ×¢×œ ×”××ª×’ ×œ×™×“ ×©× ×”-DAG</div>

                <h4>3. ×‘×“×•×§ ××ª start_date</h4>
                <div class="code-block"># start_date ×—×™×™×‘ ×œ×”×™×•×ª ×‘×¢×‘×¨!
# âŒ ×œ× ×¢×•×‘×“:
'start_date': datetime.now()

# âœ… ×¢×•×‘×“:
'start_date': datetime(2024, 1, 1)

# ××•
'start_date': datetime.now() - timedelta(days=1)</div>

                <h4>4. ×‘×“×•×§ catchup setting</h4>
                <div class="code-block"># ×× catchup=True (default), Airflow ×™× ×¡×” ×œ×”×¨×™×¥ ×›×œ ×”×”×¨×¦×•×ª ×”×—×¡×¨×•×ª
dag = DAG(
    'my_dag',
    catchup=False,  # ×¨×§ ×”×¨×¦×•×ª ×¢×ª×™×“×™×•×ª
    ...
)</div>
            </div>

            <!-- Issue 4: Connection Errors -->
            <div class="warning-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-dark);">ğŸ”Œ ×©×’×™××•×ª Connection</h2>

                <h3>âœ… ×¤×ª×¨×•× ×•×ª:</h3>

                <h4>1. ×‘×“×•×§ ×©×”-Connection ×§×™×™×</h4>
                <div class="code-block"># List connections
airflow connections list

# ××• ×‘-UI: Admin â†’ Connections</div>

                <h4>2. Test Connection</h4>
                <div class="code-block"># ×‘×“×™×§×ª connection ×‘-Python
from airflow.providers.postgres.hooks.postgres import PostgresHook

hook = PostgresHook(postgres_conn_id='my_postgres')
try:
    conn = hook.get_conn()
    print("âœ… Connection successful!")
except Exception as e:
    print(f"âŒ Connection failed: {e}")</div>

                <h4>3. ×”×’×“×¨ Connection ×-CLI</h4>
                <div class="code-block"># PostgreSQL
airflow connections add 'postgres_default' \
    --conn-type 'postgres' \
    --conn-host 'localhost' \
    --conn-schema 'airflow' \
    --conn-login 'airflow' \
    --conn-password 'airflow' \
    --conn-port 5432

# MySQL
airflow connections add 'mysql_default' \
    --conn-type 'mysql' \
    --conn-host 'localhost' \
    --conn-schema 'mydb' \
    --conn-login 'root' \
    --conn-password 'password'

# HTTP/API
airflow connections add 'api_default' \
    --conn-type 'http' \
    --conn-host 'https://api.example.com'</div>
            </div>

            <!-- Issue 5: Performance -->
            <div class="info-card" style="margin-bottom: 30px;">
                <h2 style="margin-top: 0; color: var(--airflow-dark);">ğŸŒ Airflow ××™×˜×™</h2>

                <h3>âœ… ××•×¤×˜×™××™×–×¦×™×•×ª:</h3>

                <h4>1. ×”×’×“×œ Parallelism</h4>
                <div class="code-block"># airflow.cfg
[core]
parallelism = 32              # max tasks across all DAGs
dag_concurrency = 16          # max tasks per DAG
max_active_runs_per_dag = 16  # max active runs per DAG</div>

                <h4>2. ×”×©×ª××© ×‘-LocalExecutor ××• CeleryExecutor</h4>
                <div class="code-block"># airflow.cfg
[core]
executor = LocalExecutor   # ×‘××§×•× SequentialExecutor

[database]
sql_alchemy_conn = postgresql+psycopg2://user:pass@localhost/airflow</div>

                <h4>3. × ×§×” DAGs ×™×©× ×™×</h4>
                <div class="code-block"># Delete old DAG runs
airflow db clean --clean-before-timestamp "2023-01-01"</div>

                <h4>4. ××•×¤×˜×™××– ××ª ×”Scheduler</h4>
                <div class="code-block"># airflow.cfg
[scheduler]
min_file_process_interval = 30    # seconds between parsing
dag_dir_list_interval = 300       # seconds to refresh DAG directory
processor_poll_interval = 1       # seconds between DAG file parsing</div>
            </div>

            <!-- Quick Debug Checklist -->
            <div class="success-card">
                <h3 style="margin-top: 0;">âœ… Debug Checklist ××”×™×¨</h3>
                <ol style="font-size: 1.05rem; line-height: 2;">
                    <li>âœ… <strong>Syntax:</strong> <code>python my_dag.py</code></li>
                    <li>âœ… <strong>Test Task:</strong> <code>airflow tasks test my_dag task1 2024-01-01</code></li>
                    <li>âœ… <strong>Check Logs:</strong> UI â†’ Task â†’ View Log</li>
                    <li>âœ… <strong>Scheduler:</strong> <code>docker ps</code> ××• <code>ps aux | grep scheduler</code></li>
                    <li>âœ… <strong>Unpause DAG:</strong> <code>airflow dags unpause my_dag</code></li>
                    <li>âœ… <strong>Check start_date:</strong> ×—×™×™×‘ ×œ×”×™×•×ª ×‘×¢×‘×¨!</li>
                    <li>âœ… <strong>Connections:</strong> <code>airflow connections list</code></li>
                </ol>
            </div>
        </div>
    </div>

</div>

<!-- Copy Notification -->
<div class="copy-notification" id="copyNotification">
    âœ… ×”×•×¢×ª×§ ×œ×œ×•×—!
</div>

<script>
    function switchView(viewId, btn) {
        document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
        document.getElementById('view-' + viewId).classList.add('active');

        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        btn.classList.add('active');
    }

    function showSection(sectionId, btn) {
        document.querySelectorAll('.theory-section').forEach(el => el.classList.remove('active'));
        document.getElementById('section-' + sectionId).classList.add('active');

        document.querySelectorAll('.theory-nav-item').forEach(el => el.classList.remove('active'));
        btn.classList.add('active');
    }

    /* === SOLUTION TOGGLE === */
    function toggleSolution(button) {
        const content = button.nextElementSibling;
        content.classList.toggle('show');
        button.textContent = content.classList.contains('show') ? 'ğŸ”’ ×”×¡×ª×¨ ×¤×ª×¨×•×Ÿ' : 'ğŸ”“ ×”×¦×’ ×¤×ª×¨×•×Ÿ';
    }

    /* === DARK MODE === */
    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        const isDark = document.body.classList.contains('dark-mode');
        const btn = document.getElementById('darkModeToggle');
        btn.textContent = isDark ? 'â˜€ï¸ ××¦×‘ ×™×•×' : 'ğŸŒ™ ××¦×‘ ×œ×™×œ×”';
        localStorage.setItem('darkMode', isDark);
    }

    // Load dark mode preference
    if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
        document.getElementById('darkModeToggle').textContent = 'â˜€ï¸ ××¦×‘ ×™×•×';
    }

    /* === SEARCH === */
    function toggleSearch() {
        const searchBar = document.getElementById('searchBar');
        const isVisible = searchBar.style.display !== 'none';
        searchBar.style.display = isVisible ? 'none' : 'block';
        if (!isVisible) {
            document.getElementById('searchInput').focus();
        } else {
            document.getElementById('searchResults').innerHTML = '';
        }
    }

    // Search database for Airflow
    const searchDatabase = [
        { term: 'BashOperator', type: 'Operator', description: '×”×¨×¦×ª ×¤×§×•×“×•×ª bash', example: "BashOperator(task_id='t', bash_command='date')", section: 'tasks' },
        { term: 'PythonOperator', type: 'Operator', description: '×”×¨×¦×ª ×¤×•× ×§×¦×™×•×ª Python', example: "PythonOperator(task_id='t', python_callable=func)", section: 'tasks' },
        { term: 'PostgresOperator', type: 'Operator', description: '×”×¨×¦×ª SQL queries', example: "PostgresOperator(sql='SELECT...')", section: 'tasks' },
        { term: 'EmailOperator', type: 'Operator', description: '×©×œ×™×—×ª ××™××™×™×œ×™×', example: "EmailOperator(to='user@example.com')", section: 'tasks' },
        { term: 'BranchPythonOperator', type: 'Operator', description: 'branching logic', example: "BranchPythonOperator(python_callable=choose_branch)", section: 'tasks' },
        { term: 'FileSensor', type: 'Sensor', description: '×”××ª× ×” ×œ×§×•×‘×¥', example: "FileSensor(filepath='/data/file.csv')", section: 'tasks' },
        { term: 'HttpSensor', type: 'Sensor', description: '×”××ª× ×” ×œ-API', example: "HttpSensor(endpoint='health')", section: 'tasks' },

        { term: 'DAG', type: 'Core', description: 'Directed Acyclic Graph', example: "DAG('my_dag', schedule_interval='@daily')", section: 'dag' },
        { term: 'Task', type: 'Core', description: '×™×—×™×“×ª ×¢×‘×•×“×”', example: 'instance ×©×œ Operator', section: 'tasks' },
        { term: 'XCom', type: 'Core', description: '×ª×§×©×•×¨×ª ×‘×™×Ÿ tasks', example: "ti.xcom_push(key='x', value=42)", section: 'xcoms' },
        { term: 'Hook', type: 'Core', description: '×—×™×‘×•×¨ ×œ××¢×¨×›×•×ª ×—×™×¦×•× ×™×•×ª', example: "PostgresHook(postgres_conn_id='db')", section: 'hooks' },
        { term: 'Pool', type: 'Core', description: '×”×’×‘×œ×ª ××©××‘×™×', example: "pool='database_pool'", section: 'pools-queues' },
        { term: 'Queue', type: 'Core', description: '× ×™×”×•×œ ×¢×“×™×¤×•×™×•×ª (Celery)', example: "queue='heavy_queue'", section: 'pools-queues' },

        { term: 'trigger_rule', type: 'Concept', description: '×›×œ×œ×™ ×”×¤×¢×œ×ª task', example: "trigger_rule='one_failed'", section: 'quick-reference' },
        { term: 'schedule_interval', type: 'Concept', description: '×ª×“×™×¨×•×ª ×”×¨×¦×”', example: "schedule_interval='@daily'", section: 'quick-reference' },
        { term: 'depends_on_past', type: 'Concept', description: '×ª×œ×•×ª ×‘×”×¨×¦×” ×§×•×“××ª', example: "depends_on_past=True", section: 'dag' },
        { term: 'catchup', type: 'Concept', description: 'backfill ××•×˜×•××˜×™', example: "catchup=False", section: 'dag' },
        { term: 'retries', type: 'Concept', description: '× ×™×¡×™×•× ×•×ª ×—×•×–×¨×™×', example: "retries=3", section: 'dag' },

        { term: 'SequentialExecutor', type: 'Executor', description: 'task ××—×“ ×‘×›×œ ×¤×¢×', example: 'executor = SequentialExecutor', section: 'sequential' },
        { term: 'LocalExecutor', type: 'Executor', description: 'parallelism ×¢×œ ××›×•× ×” ××—×ª', example: 'executor = LocalExecutor', section: 'local' },
        { term: 'CeleryExecutor', type: 'Executor', description: 'cluster ××‘×•×–×¨', example: 'executor = CeleryExecutor', section: 'celery' },

        { term: 'ds', type: 'Template', description: 'Execution date', example: '{{ ds }}', section: 'examples' },
        { term: 'execution_date', type: 'Template', description: 'Execution datetime', example: '{{ execution_date }}', section: 'examples' },
        { term: 'ti', type: 'Template', description: 'TaskInstance object', example: '{{ ti.xcom_pull(...) }}', section: 'examples' },

        { term: 'dags list', type: 'CLI', description: '×¨×©×™××ª DAGs', example: 'airflow dags list', section: 'cli' },
        { term: 'dags trigger', type: 'CLI', description: '×”×¤×¢×œ×ª DAG', example: 'airflow dags trigger my_dag', section: 'cli' },
        { term: 'tasks test', type: 'CLI', description: '×‘×“×™×§×ª task', example: 'airflow tasks test my_dag task1 2024-01-01', section: 'cli' },
        { term: 'tasks logs', type: 'CLI', description: '×”×¦×’×ª logs', example: 'airflow tasks logs my_dag task1 2024-01-01', section: 'cli' },

        { term: 'DAG not appearing', type: 'Troubleshooting', description: 'DAG ×œ× ××•×¤×™×¢ ×‘-UI', example: 'python my_dag.py', section: 'troubleshooting' },
        { term: 'task failed', type: 'Troubleshooting', description: 'task × ×›×©×œ', example: 'airflow tasks logs...', section: 'troubleshooting' },
        { term: 'connection error', type: 'Troubleshooting', description: '×©×’×™××•×ª ×—×™×‘×•×¨', example: 'airflow connections list', section: 'troubleshooting' },

        { term: 'SimpleHttpOperator', type: 'Operator', description: '×§×¨×™××•×ª HTTP/API', example: "SimpleHttpOperator(endpoint='api/users')", section: 'tasks' },
        { term: 'DummyOperator', type: 'Operator', description: 'placeholder task', example: "DummyOperator(task_id='dummy')", section: 'tasks' },
        { term: 'SparkSubmitOperator', type: 'Operator', description: '×”×¨×¦×ª Spark jobs', example: "SparkSubmitOperator(application='app.py')", section: 'tasks' },

        { term: 'TaskGroup', type: 'Advanced', description: '×§×™×‘×•×¥ tasks (2.0+)', example: "with TaskGroup('group'):", section: 'examples' },
        { term: 'SubDAG', type: 'Advanced', description: 'DAG ××§×•× ×Ÿ', example: "SubDagOperator(subdag=...)", section: 'subdags' },

        { term: 'provide_context', type: 'Concept', description: '×”×¢×‘×¨×ª context ×œ×¤×•× ×§×¦×™×”', example: "provide_context=True", section: 'xcoms' },
        { term: 'execution_timeout', type: 'Concept', description: 'timeout ×œtask', example: "execution_timeout=timedelta(hours=1)", section: 'quick-reference' },
        { term: 'email_on_failure', type: 'Concept', description: '××™××™×™×œ ×¢×œ ×›×©×œ×•×Ÿ', example: "email_on_failure=True", section: 'examples' },

        { term: 'all_success', type: 'TriggerRule', description: '×›×œ ×”-upstream ×”×¦×œ×™×—×•', example: "trigger_rule='all_success'", section: 'quick-reference' },
        { term: 'one_failed', type: 'TriggerRule', description: '×œ×¤×—×•×ª ××—×“ × ×›×©×œ', example: "trigger_rule='one_failed'", section: 'quick-reference' },
        { term: 'none_failed_min_one_success', type: 'TriggerRule', description: '××£ ××—×“ ×œ× × ×›×©×œ', example: "trigger_rule='none_failed_min_one_success'", section: 'quick-reference' },

        { term: '@daily', type: 'Schedule', description: '×¨×™×¦×” ×™×•××™×ª', example: "schedule_interval='@daily'", section: 'quick-reference' },
        { term: '@hourly', type: 'Schedule', description: '×¨×™×¦×” ×›×œ ×©×¢×”', example: "schedule_interval='@hourly'", section: 'quick-reference' },
        { term: 'cron', type: 'Schedule', description: 'cron expression', example: "schedule_interval='0 8 * * *'", section: 'quick-reference' },

        { term: 'docker compose', type: 'Installation', description: '×”×ª×§× ×” ×¢× Docker', example: 'docker compose up -d', section: 'installation' },
        { term: 'connections add', type: 'CLI', description: '×”×•×¡×¤×ª connection', example: "airflow connections add 'my_db'", section: 'cli' },
        { term: 'variables set', type: 'CLI', description: '×”×’×“×¨×ª variable', example: 'airflow variables set key value', section: 'cli' },
        { term: 'users create', type: 'CLI', description: '×™×¦×™×¨×ª ××©×ª××©', example: 'airflow users create --role Admin', section: 'cli' },
    ];

    function performSearch(query) {
        const resultsDiv = document.getElementById('searchResults');

        if (!query || query.length < 2) {
            resultsDiv.innerHTML = '';
            return;
        }

        const results = searchDatabase.filter(item =>
            item.term.toLowerCase().includes(query.toLowerCase()) ||
            item.description.includes(query) ||
            item.example.toLowerCase().includes(query.toLowerCase())
        );

        if (results.length === 0) {
            resultsDiv.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-secondary);">×œ× × ××¦××• ×ª×•×¦××•×ª</div>';
            return;
        }

        resultsDiv.innerHTML = results.map(item => `
            <div class="search-result-item" onclick="navigateToView('${item.section}')">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <strong style="color: var(--airflow-primary); font-size: 1.1rem; font-family: 'JetBrains Mono', monospace;">${highlightText(item.term, query)}</strong>
                    <span style="background: var(--airflow-green); color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.75rem;">${item.type}</span>
                </div>
                <div style="color: var(--text-secondary); margin-bottom: 8px;">${item.description}</div>
                <code style="background: var(--code-bg); color: var(--code-text); padding: 8px 12px; border-radius: 4px; display: block; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; direction: ltr; text-align: left;">${item.example}</code>
            </div>
        `).join('');
    }

    function highlightText(text, query) {
        const regex = new RegExp(`(${query})`, 'gi');
        return text.replace(regex, '<span class="search-highlight">$1</span>');
    }

    function navigateToView(viewId) {
        toggleSearch(); // Close search

        // Map sections to views
        const sectionToView = {
            'tasks': 'theory',
            'dag': 'theory',
            'hooks': 'theory',
            'pools-queues': 'theory',
            'xcoms': 'theory',
            'subdags': 'theory',
            'sequential': 'theory',
            'local': 'theory',
            'celery': 'theory',
            'quick-reference': 'theory',
            'best-practices': 'theory',
            'examples': 'examples',
            'cli': 'cli',
            'troubleshooting': 'troubleshooting',
        };

        const targetView = sectionToView[viewId] || 'theory';

        // Switch to correct view
        const navItem = document.querySelector(`.nav-item[onclick*="${targetView}"]`);
        if (navItem) {
            navItem.click();
        }

        // If theory section, navigate to specific section
        if (targetView === 'theory') {
            setTimeout(() => {
                const sidebarItem = document.querySelector(`.theory-nav-item[onclick*="${viewId}"]`);
                if (sidebarItem) {
                    sidebarItem.click();
                }
            }, 100);
        }
    }

    /* === COPY CODE BLOCKS === */
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.code-block').forEach(code => {
            code.addEventListener('click', () => {
                const text = code.textContent.trim();
                navigator.clipboard.writeText(text).then(() => {
                    const notification = document.getElementById('copyNotification');
                    notification.classList.add('show');
                    setTimeout(() => notification.classList.remove('show'), 2000);
                }).catch(err => {
                    console.error('Failed to copy:', err);
                });
            });
        });
    });
</script>

</body>
</html>
